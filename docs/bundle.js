(function(){var f,aa="function"==typeof Object.create?Object.create:function(a){function b(){}b.prototype=a;return new b},ba;if("function"==typeof Object.setPrototypeOf)ba=Object.setPrototypeOf;else{var ca;a:{var da={Ia:!0},ea={};try{ea.__proto__=da;ca=ea.Ia;break a}catch(a){}ca=!1}ba=ca?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null}
var fa=ba,ha="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)},ia="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=global?global:this;function ja(a,b){if(b){var c=ia;a=a.split(".");for(var d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&ha(c,a,{configurable:!0,writable:!0,value:b})}}
ja("Number.isFinite",function(a){return a?a:function(a){return"number"!==typeof a?!1:!isNaN(a)&&Infinity!==a&&-Infinity!==a}});ja("Number.isInteger",function(a){return a?a:function(a){return Number.isFinite(a)?a===Math.floor(a):!1}});ja("Array.prototype.find",function(a){return a?a:function(a,c){a:{var b=this;b instanceof String&&(b=String(b));for(var e=b.length,k=0;k<e;k++){var m=b[k];if(a.call(c,m,k,b)){a=m;break a}}a=void 0}return a}});window.onload=function(){new g};function h(a){a=Error.call(this,"Assertion failed : "+a);this.message=a.message;"stack"in a&&(this.stack=a.stack);this.name="AssertionError"}var q=Error;h.prototype=aa(q.prototype);h.prototype.constructor=h;if(fa)fa(h,q);else for(var r in q)if("prototype"!=r)if(Object.defineProperties){var ka=Object.getOwnPropertyDescriptor(q,r);ka&&Object.defineProperty(h,r,ka)}else h[r]=q[r];h.a=q.prototype;function t(a){if(!a())throw new h(a.toString());};function u(a,b){this.ea=v("span",{});this.J=v("div",{"class":"mMapContainer"});this.J.addEventListener("click",this.Ma.bind(this));this.X=v("span",{"class":"printablePages"});this.s=new la(this.J);this.B=b||ma;this.U=0;this.ba=null;this.V=!1;this.restore(a)}f=u.prototype;
f.restore=function(a){var b=this;t(function(){return Number.isInteger(a.start)});t(function(){return Number.isInteger(a.end)});t(function(){return"string"===typeof a.name});this.start=a.start;this.o=a.end;this.name=a.name;this.H=new na(this);this.v=a.programmes.map(function(a,d){return new oa(a,d,b)});this.i=a.projects.map(function(a,d){return new w(a,d,b)});this.u=a.milestones.map(function(a,d){return new x(a,d,b)});this.b=a.reports.map(function(a,d){return new y(a,d,b)});t(function(){return Number.isInteger(a.currReport)});
t(function(){return b.b[a.currReport]});t(function(){return Number.isInteger(a.cmpReport)});t(function(){return b.b[a.cmpReport]});this.a=this.b[a.currReport];this.g=this.b[a.cmpReport];this.j=a.msAtReports.map(function(a,d){return new z(a,d,b)});this.C=a.dependencies.map(function(a,d){return new A(a,d,b)})};
function pa(a){return{name:a.name,end:a.o,start:a.start,currReport:a.a.index,cmpReport:a.g.index,reports:a.b.map(function(a){return{date:a.m,name:a.name}}),programmes:a.v.map(function(a){return{name:a.name,comment:a.w}}),projects:a.i.map(function(a){return qa(a)}),milestones:a.u.map(function(a){return{name:a.name,project:a.a.index}}),msAtReports:a.j.map(function(a){return ra(a)}),dependencies:a.C.map(function(a){return sa(a)})}}
function ta(a){var b=a.ea;b.innerHTML="";var c={"class":"reportSelector"},d=a.b.sort(function(a,b){return a.m-b.m}).map(function(a){return a.name+": "+B(a.m)});ua("Snapshot 1 (Current)",a.Ta.bind(a),d,c,b);ua("Snapshot 2 (Baseline)",a.Sa.bind(a),d,c,b)}
f.h=function(){this.J.innerHTML="";this.T=C("svg",{"class":"mMapFixed"},this.J);this.fa=v("div",{"class":"mMapScrollBox"},this.J);this.M=C("svg",{"class":"milestoneMap",height:5E3},this.fa);var a=C("g",{"class":"bg"},this.M);this.da=C("g",{"class":"dependencies"},this.M);var b=C("g",{"class":"fg"},this.M);this.width=this.M.getBoundingClientRect().width;this.O=new D(this,this.T,a);this.j.forEach(function(a){return a.h()});this.u.forEach(function(a){return a.h()});this.i.forEach(function(a){return a.h()});
this.T.appendChild(this.H.h());a.appendChild(this.H.g);this.v.forEach(function(a){return b.appendChild(a.h())});this.T.appendChild(this.a.D());b.appendChild(this.a.j);E(this)};f.N=5;
function va(a){a.X.innerHTML="";a.width=a.B.width*u.prototype.N;a.height=a.B.height*u.prototype.N;a.j.forEach(function(a){return a.h()});a.u.forEach(function(a){return a.h()});a.i.forEach(function(a){return a.h()});a.v.forEach(function(a){return a.h()});var b=a.H.h(),c=0,d=0,e=0,k=[];do{var m=C("svg",{"class":"milestoneMapPage",viewbox:"0 0 "+a.B.width*u.prototype.N+" "+a.B.height*u.prototype.N},a.X);a.O=new D(a,m);var l=a.O.o,n=b.cloneNode(!0);n.setAttribute("transform","translate(0, "+l+")");m.appendChild(n);
l+=a.H.height;n=a.B.height*u.prototype.N-l;if(0>=n)throw Error("Page size not large enough for Business Milestones.");if(c>=a.v.length){m.appendChild(a.a.D().cloneNode(!0));break}var p=C("g",{"class":"dependencies"},m);k.push(p);p=!0;do{var N=a.v[c];N.K=l;var F=wa(N,n,d,p,e);p=!1;m.appendChild(F.c);F.c.setAttribute("transform","translate(0, "+l+")");if(F.index===N.i.length)c++,d=0,l+=n-F.S,n=F.S;else{d=F.index;break}}while(c<a.v.length);l=a.a.D();m.appendChild(l.cloneNode(!0));e++}while(c<a.v.length);
a.C.forEach(function(a){if(a.A===a.g.a&&G(a.b)&&G(a.a)){var b=xa(a.a),c=xa(a.b);c.x-=7;var d=a.b.l.a.B,e=a.a.l.a.B;if(d===e){var l=C("g",{"class":"dependency"},k[d]);a.D(b,c,l)}else{var m=a.g.B.height*u.prototype.N;d>e?(l=c.y+m,m=b.y-m):(l=c.y-m,m=b.y+m);e=C("g",{"class":"dependency"},k[e]);d=C("g",{"class":"dependency"},k[d]);ya(a,b,{x:c.x,y:l},e);ya(a,{x:b.x,y:m},c,d)}}})}function za(a){a.C.forEach(function(b){b.h();a.da.appendChild(b.c)})}f.Ma=function(){this.V?this.V=!1:(this.U=0,this.ba=null)};
function E(a){var b=H(a.O.o,[a.H]);a.T.setAttribute("height",b);b=a.pa-b;a.fa.setAttribute("style","max-height:"+b+"px;");b-=4;var c=H(30,a.v);a.M.setAttribute("height",c<b?b:c);a.a.D();za(a)}function I(a){a=.2*a.width;return 350>a?a:350}function J(a,b){return(b.valueOf()-a.start)/(a.o-a.start)*(a.width-I(a))+I(a)}function Aa(){var a=new Date(Date.now());return Ba(a.valueOf()-6E4*a.getTimezoneOffset())}function Ca(a,b){return b>=a.start&&b<=a.o}
function K(a,b){b=new z(b,a.j.length,a);a.j.push(b);return b}f.R=function(a){a=new A(a,this.C.length,this);this.C.push(a);this.da.appendChild(a.c);return a};function Da(a,b){b=new x(b,a.u.length,a);a.u.push(b);return b}function Ea(a,b){b=new w(b,a.i.length,a);a.i.push(b);return b}function Fa(a,b){b=new oa(b,a.v.length,a);a.v.push(b);return b}
function Ga(a){var b=new y({name:"New Report",date:Aa()},a.b.length,a);a.b.push(b);a.j.filter(function(b){return b.A===a.a}).forEach(function(c){c=ra(c);c.report=b.index;K(a,c)});a.C.filter(function(b){return b.A===a.a}).forEach(function(c){c=sa(c);c.report=b.index;a.R(c)});a.g=a.a;a.a=b}
function Ha(a){for(var b=1;b<a.length;b++){var c=a[b];if(6!==c.length&&5!==c.length)throw Error("CSV row "+(b+1)+" does not contain the correct number of columns");var d=c[4];if("complete"!==d&&"on-track"!==d&&"at-risk"!==d&&"late"!==d&&"previous"!==d)throw Error("Milestone health on row "+(b+1)+" is invalid.Must be one of 'complete', 'on-track', 'at-risk', 'late', or 'previous'");if(isNaN((new Date(c[3]+"T00:00:00.000Z")).valueOf()+1))throw Error("Invalid date format on row "+(b+1)+". The Date must be formatted as YYYY-MM-DD");
}}function Ia(a,b){var c=b[0],d=b[1],e=b[2],k=b[3],m=b[4];b=b[5]||"";if("Business Milestones"!==c){var l=a.v.find(function(a){return a.name===c});l||(l=Fa(a,{name:c}));var n=l.i.find(function(a){return a.name===d});n||(n=Ea(a,{name:d,programme:l.index}))}else n=a.H;(l=n.u.find(function(a){return a.name===e}))||(l=Da(a,{name:e,project:n.index}));n=L(l);k={milestone:l.index,report:a.a.index,comment:b,status:Ja(m),date:(new Date(k+"T00:00:00.000Z")).valueOf()+1};n?n.restore(k):K(a,k)}
function Ka(a,b){Ha(b);a.j.filter(function(b){return b.A===a.a}).forEach(function(a){return M(a)});for(var c=1;c<b.length;c++)Ia(a,b[c])}f.Ya=function(){Fa(this,{name:"New Programme"});this.h()};var La="Programme Name;Project Name;Milestone Name;Date (YYYY-MM-DD);Health ('complete', 'on-track', 'at-risk', 'late', or 'previous);Comment".split(";").map(function(a){return JSON.stringify(a)}).join(",");
function Ma(a){a=a.u.filter(function(a){return L(a)}).map(function(a){return Na(a)}).join("\n");return La+"\n"+a}f=u.prototype;f.ra=function(a,b){this.name=b.text};f.Wa=function(a,b){b.m<=this.o&&(this.start=b.m);this.h()};f.Va=function(a,b){b.m>=this.start&&(this.o=b.m);this.h()};f.Ta=function(a){a=a.currentTarget.value;0<=a&&a<this.b.length&&(this.a=this.b[a]);this.h()};f.Sa=function(a){a=a.currentTarget.value;0<=a&&a<this.b.length&&(this.g=this.b[a]);this.h()};function D(a,b,c){this.c=C("g",{"class":"dateHeader"},b);this.g=C("g",{},this.c);this.j=C("g",{},this.c);this.H=C("g",{"class":"dateHeader"},c);this.a=a;this.h()}function Oa(a){a.setUTCHours(0,0,0,0);return a}function Pa(a){a.setUTCMonth(0,1);a.setUTCHours(0,0,0,0);return a}function Qa(a){a.setUTCDate(1);a.setUTCHours(0,0,0,0);return a}function Ra(a){a.setUTCDate(a.getUTCDate()-(a.getUTCDay()-1)%7);return a}function Sa(a){var b=a.getUTCFullYear();a.setUTCFullYear(b-b%10);Pa(a);return a}
function Ta(a){a.setUTCDate(a.getUTCDate()+1);return a}function Ua(a){a.setUTCDate(a.getUTCDate()+7);return a}function Va(a){a.setUTCMonth(a.getUTCMonth()+1);return a}function Wa(a){a.setUTCFullYear(a.getUTCFullYear()+1);return a}function Xa(a){a.setUTCFullYear(a.getUTCFullYear()+10);return a}function Ya(a){return a.getUTCDate()}
function Za(a){var b=3-(a.getUTCDay()-1)%7,c=new Date(a.valueOf());Oa(c);c.setUTCDate(a.getUTCDate()+b);return""+Math.ceil((c.valueOf()-(new Date(c.getUTCFullYear(),0,1)).valueOf())/6048E5)}function $a(a){return"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ")[a.getUTCMonth()]}function ab(a){return""+a.getUTCFullYear()}function bb(a){a=a.getUTCFullYear();return""+(a-a%10)+"'s"}
D.prototype.h=function(){this.g.innerHTML="";var a=C("g",{transform:"translate("+(O+60)+" 0)"},this.j);this.b=new cb(this.a.width-2*O-120,a);new P(this.a.name,{s:this.a.s,G:"Untitled",onchange:this.a.ra.bind(this.a)},{"class":"mMapTitle"},this.b.a);this.b.b();this.j.setAttribute("transform","translate(0 "+this.b.height+")");this.b.c.addEventListener("verticalResize",this.J.bind(this));this.j.setAttribute("transform","translate(0 "+this.b.height+")");this.g.setAttribute("transform","translate(0 "+
this.b.height+")");a=C("g",{},this.j);new Q({s:this.a.s,onchange:this.a.Wa.bind(this.a),parent:a,max:this.a.o-1728E5,Y:R,F:{transform:"translate(10 -5)","class":"mMapEdgeDate"}},this.a.start);a=C("g",{},this.j);new Q({s:this.a.s,onchange:this.a.Va.bind(this.a),parent:a,min:this.a.start+1728E5,Y:S,F:{transform:"translate("+(this.a.width-10)+" -5)","class":"mMapEdgeDate"}},this.a.o);db(this.a.a,{transform:"translate("+(this.a.width-O)+", -5)"},this.j);this.a.a!==this.a.g&&db(this.a.g,{transform:"translate("+
O+", -5)"},this.j);a=[];var b=this.a.o-this.a.start,c=b/this.a.width;189216E6<b&&a.push(eb);18144E6<b&&a.push(fb);1728E6<b&&8928E4>c&&a.push(gb);3024E4>c&&a.push(hb);432E4>c&&a.push(ib);b=20;for(c=0;c<a.length-2;c++)T(this,b,20,a[c],this.B.bind(this)),b+=20;1<a.length?(T(this,b,"100%",a[a.length-2],this.B.bind(this)),T(this,b,"100%",a[a.length-2],this.C.bind(this)),b+=20,T(this,b,20,a[a.length-1],this.M.bind(this))):(T(this,b,"100%",a[0],this.B.bind(this)),T(this,b,"100%",a[0],this.C.bind(this)));
this.O=this.o=b+20;this.o+=10+this.b.height;C("rect",{x:0,y:0,width:I(this.a),height:"100%","class":"whiteBackground"},this.g);C("rect",{x:0,y:0,width:I(this.a),height:"100%","class":"whiteBackground"},this.H)};D.prototype.C=function(a,b,c,d,e,k){C("rect",{"class":k,height:"100%",y:"0",x:a,width:b-a},this.H)};D.prototype.B=function(a,b,c,d,e,k){C("rect",{"class":k,height:d,y:c,x:a,width:b-a},this.g);C("text",{"class":"majorRowText",y:c+15,x:(a+b)/2,"text-anchor":"middle"},this.g).textContent=e};
D.prototype.M=function(a,b,c,d,e){C("line",{"class":"dateHeaderSeparator",x1:a,y1:c+3,x2:a,y2:c+d-3},this.g);C("text",{"class":"minorRowText",y:c+15,x:(a+b)/2,"text-anchor":"middle"},this.g).textContent=e};var ib=0,hb=1,gb=2,fb=3,eb=4;
function T(a,b,c,d,e){switch(d){case ib:var k=Oa,m=Ta,l=Ya;break;case hb:k=Ra;m=Ua;l=Za;break;case gb:k=Qa;m=Va;l=$a;break;case fb:k=Pa;m=Wa;l=ab;break;case eb:k=Sa,m=Xa,l=bb}d=k(new Date(a.a.start));for(k=0;d.valueOf()<=a.a.o;){var n=l(d),p=J(a.a,d),N=J(a.a,m(d));e(p,N,b,c,n,0===k%2?"even":"odd");k++}}D.prototype.J=function(){this.j.setAttribute("transform","translate(0 "+this.b.height+")");this.g.setAttribute("transform","translate(0 "+this.b.height+")");this.o=this.O+10+this.b.height;E(this.a)};
var O=250;function x(a,b,c){this.c=C("g",{"class":"milestone"});this.b=c;this.index=b;this.g=[];this.restore(a)}x.prototype.restore=function(a){var b=this;t(function(){return Number.isInteger(a.project)});t(function(){return b.b.i[a.project]||0>a.project});this.name=a.name;this.a&&this.a.W(this);0<=a.project?this.a=this.b.i[a.project]:this.a=this.b.H;this.a.ca(this)};
function Na(a){var b=L(a),c=b?B(b.m):null;return[-1===a.a.index?a.a.name:a.a.a.name,a.a.name,a.name,c,jb(b),b.w].map(function(a){return JSON.stringify(a)}).join(",")}
x.prototype.h=function(){this.c.innerHTML="";var a=L(this),b=this.j&&this.j.A===this.b.g?this.j:this.j=kb(this,this.b.g);if(a&&b&&this.b.a!==this.b.g){var c=b.x,d=a.x;var e=lb(-45,45,.1*(c-d));var k=4*e;C("path",{"class":"thick evenDashed brightPink noFill",d:"M"+c+" 0 C"+(c-k)+" "+(0+e)+" "+(d+k)+" "+(0+e)+" "+d+" 0"},this.c)}b&&this.c.appendChild(b.c);a&&this.c.appendChild(a.c)};function mb(a,b){t(function(){return b instanceof z});a.g.push(b)}
function nb(a,b){b.A===a.b.a&&(a.o=null);b.A===a.b.g&&(a.j=null);a.g=a.g.filter(function(a){return a!==b})}function ob(a){a.a.W(a);a.g.forEach(function(a){return M(a)});U(a.b.u,a)}function kb(a,b){return a.g.find(function(a){return a.A===b})}function L(a){return a.o&&a.o.A===a.b.a?a.o:a.o=kb(a,a.b.a)};function w(a,b,c){this.c=C("g",{"class":"project"},c.v[a.programme].c);this.b=c;this.height=0;this.u=[];this.index=b;this.o=this.B=this.K=0;this.restore(a)}f=w.prototype;f.restore=function(a){var b=this;t(function(){return"string"===typeof a.name});t(function(){return!a.comment||"string"===typeof a.comment});t(function(){return Number.isInteger(a.programme)});t(function(){return b.b.v[a.programme]});this.name=a.name;this.w=a.comment||"";this.a&&pb(this.a,this);this.a=this.b.v[a.programme];this.a.i.push(this)};
function qa(a){t(function(){return a.b.v[a.a.index]===a.a});return{name:a.name,programme:a.a.index,comment:a.w}}
f.h=function(){var a=this;this.c.innerHTML="";this.j=C("g",{},this.c);C("line",{x1:0,y1:0,x2:this.b.width,y2:0,"class":"projectLine"},this.j);var b=this.ga();this.u.forEach(function(b){return a.j.appendChild(b.c)});this.j.appendChild(b);b=C("g",{transform:"translate(20 0)"},this.j);this.g=new cb(I(this.b)-20,b);new P(this.name,{s:this.b.s,G:"Untitled",onchange:this.Fa.bind(this)},{"class":"projectHeader"},this.g.a);new P(this.w,{s:this.b.s,G:"...",onchange:this.Ea.bind(this)},{"class":"headingComment"},
this.g.a);this.g.b();this.g.c.addEventListener("verticalResize",this.Ca.bind(this));qb(this);this.j.setAttribute("transform","translate(0 "+(this.height-20)+")");this.C=rb(R,this.b.s,[{icon:"icons/move-down.svg",action:this.Ga.bind(this)},{icon:"icons/move-up.svg",action:this.Ha.bind(this)},{icon:"icons/delete.svg",action:this.Da.bind(this)},{icon:"icons/plus.svg",action:this.ha.bind(this)}],{transform:"translate(0 "+(-20-this.g.height)+")"},b);return this.c};
f.ga=function(){var a=[],b=[],c=this.u.map(function(a){return L(a)}).filter(function(a){return a&&G(a)});c.sort(function(a,b){return b.x-a.x});c.forEach(function(c){var d=c.x,e=sb("small sans-serif",c.l.name+"MMM 00: ")+15;e=d+e;var l=sb("small italic sans-serif",c.w);l=0===l?0:l+15;for(var n=d+l,p=0;p<a.length&&(a[p]&&!(n<=a[p])||a[p+1]&&!(e<=a[p+1]));p++);a[p+1]=d;0!==l&&(a[p]=d);b[p]||(b[p]=C("g",{transform:"translate(0, "+-p*tb/2+")"}));b[p].appendChild(c.Z);c.P.innerHTML="";d=20-tb/2*p-40-20;
C("line",{x1:"0",y1:d,x2:"0",y2:0},c.P);C("circle",{cx:"0",cy:d,r:"2"},c.P)});this.o=b.length*tb/2;c=C("g",{transform:"translate(0 -20)"});for(var d=b.length-1;0<=d;d--)b[d]&&c.appendChild(b[d]);this.o+=40;return c};f.Ca=function(){var a=this.height;qb(this);this.C&&this.C.setAttribute("transform","translate(0 "+(-20-this.g.height)+")");a!==this.height&&(this.j.setAttribute("transform","translate(0 "+(this.height-20)+")"),this.L())};function qb(a){var b=a.g.height+15,c=a.o;a.height=b>c?b:c}
f.L=function(){var a=this.a;a.height=H(45,a.i);E(this.b)};f.ca=function(a){this.u.push(a)};f.W=function(a){this.u=this.u.filter(function(b){return b!==a})};f.Fa=function(a,b){this.name=b.text};f.Ea=function(a,b){this.w=b.text};function ub(a){pb(a.a,a);a.u.forEach(function(a){return ob(a)});U(a.b.i,a)}
function vb(a){t(function(){return 0===a.a.i.indexOf(a)});t(function(){return V(a.a.i)});var b=a.a.index;0>=b||(a.a.i.shift(),U(a.b.i,a),b--,a.a=a.b.v[b],t(function(){return V(a.a.i)}),b=a.a.i[a.a.i.length-1],a.a.i.push(a),b?wb(a.b.i,a,b.index+1):xb(a.b.i,a),t(function(){return V(a.b.i)}))}
function yb(a){t(function(){return a.a.i.indexOf(a)===a.a.i.length-1});t(function(){return V(a.a.i)});var b=a.a.index;b>=a.b.v.length-1||(a.a.i.pop(),U(a.b.i,a),b++,a.a=a.b.v[b],t(function(){return V(a.a.i)}),b=a.a.i[0],a.a.i.unshift(a),b?wb(a.b.i,a,b.index):xb(a.b.i,a),t(function(){return V(a.b.i)}))}f.Da=function(){ub(this);this.L()};
f.ha=function(){var a=Da(this.b,{name:"New Milestone",project:this.index});K(this.b,{milestone:a.index,report:this.b.a.index,comment:"",status:zb,date:Aa()}).h();a.h();this.h();this.L()};f.Ha=function(){var a=this;t(function(){return 0<=a.a.i.indexOf(a)});var b=this.a.i.indexOf(this);0===b?(b=this.a,vb(this),b.h(),this.a.h(),E(this.b)):(b=this.a.i[b-1],Ab(this.b.i,b.index,this.index),Bb(this.a.i,this,b),this.L())};
f.Ga=function(){var a=this;t(function(){return 0<=a.a.i.indexOf(a)});var b=this.a.i.indexOf(this);b===this.a.i.length-1?(b=this.a,yb(this),b.h(),this.a.h(),E(this.b)):(b=this.a.i[b+1],Ab(this.b.i,b.index,this.index),Bb(this.a.i,this,b),this.L())};function oa(a,b,c){this.c=C("g",{"class":"programme"});this.a=c;this.index=b;this.height=45;this.i=[];this.K=0;this.restore(a)}f=oa.prototype;f.restore=function(a){t(function(){return"string"===typeof a.name});t(function(){return!a.comment||"string"===typeof a.comment});this.name=a.name;this.w=a.comment||""};
f.h=function(){var a=this;this.c.innerHTML="";var b=C("g",{transform:"translate(0 40)"},this.c);Cb(this,b);rb(S,this.a.s,[{icon:"icons/move-down.svg",action:this.Aa.bind(this)},{icon:"icons/move-up.svg",action:this.Ba.bind(this)},{icon:"icons/delete.svg",action:this.xa.bind(this)},{icon:"icons/plus.svg",action:this.Za.bind(this)}],{transform:"translate("+this.a.width+" -30)"},b);this.i.forEach(function(b){return a.c.appendChild(b.c)});this.height=H(45,this.i);return this.c};
function Cb(a,b){a.b=new cb(a.a.width-250,b);new P(a.name,{s:a.a.s,G:"Untitled",onchange:a.za.bind(a)},{"class":"programmeHeader"},a.b.a);new P(a.w,{s:a.a.s,G:"...",onchange:a.ya.bind(a)},{"class":"headingComment"},a.b.a);a.b.b()}
function wa(a,b,c,d,e){var k=c,m=C("g",{"class":"programme"}),l=C("g",{transform:"translate(0 40)"},m);Cb(a,l);l=45;for(var n=[];c<a.i.length&&l<b;c++){var p=a.i[c];p.B=e;p.c.setAttribute("transform","translate(0, "+l+")");p.K=l+a.K;n.push(p);l+=p.height}if(l<b)return n.forEach(function(a){return m.appendChild(a.c)}),{c:m,S:b-l,index:a.i.length};if(0===n.length&&d)throw Error("Not enough room on page for programme headers.");if(1===n.length&&d)throw Error("Project: '"+n[0].name+"' is larger than a single page, and cannot be printed");
if(1>=n.length)return{c:C("g",{}),S:0,index:k};n.pop();n.forEach(function(a){return m.appendChild(a.c)});return{c:m,S:0,index:c-1}}function pb(a,b){a.i=a.i.filter(function(a){return a!==b})}f.za=function(a,b){this.name=b.text};f.ya=function(a,b){this.w=b.text};function Db(a){a.i.forEach(function(a){return ub(a)});U(a.a.v,a)}f.Za=function(){Ea(this.a,{name:"New Project",programme:this.index}).h();this.h();E(this.a)};
f.Ba=function(){var a=this;t(function(){return 0<=a.a.v.indexOf(a)});var b=this.a.v.indexOf(this);0!==b&&(Ab(this.a.v,this.a.v[b-1].index,this.index),E(this.a))};f.Aa=function(){var a=this;t(function(){return 0<=a.a.v.indexOf(a)});var b=this.a.v.indexOf(this);b!==this.a.v.length-1&&(Ab(this.a.v,this.a.v[b+1].index,this.index),E(this.a))};f.xa=function(){Db(this);this.a.h()};function z(a,b,c){this.c=C("g",{"class":"msAtReport"});this.j=C("g",{"class":"businessMsLine"});this.$=C("g",{"class":"businessMsLine"});this.Z=C("g",{"class":"milestoneInfo"});this.P=C("g",{"class":"milestonePointer"});this.b=[];this.g=[];this.index=b;this.a=c;this.restore(a)}var zb=1;f=z.prototype;
f.restore=function(a){var b=this;t(function(){return Number.isInteger(a.milestone)});t(function(){return b.a.u[a.milestone]});t(function(){return Number.isInteger(a.report)});t(function(){return b.a.b[a.report]});t(function(){return"string"===typeof a.comment});t(function(){return Number.isInteger(a.date)});t(function(){return Number.isInteger(a.status)});t(function(){return 0<=a.status&&4>=a.status});this.l&&nb(this.l,this);this.l=this.a.u[a.milestone];mb(this.l,this);this.A=this.a.b[a.report];this.w=
a.comment;this.status=a.status;this.m=Ba(a.date)};function ra(a){t(function(){return a.a.b[a.A.index]===a.A});t(function(){return a.a.u[a.l.index]===a.l});return{milestone:a.l.index,report:a.A.index,comment:a.w,status:a.status,date:a.m}}
f.h=function(){this.c.innerHTML="";this.P.innerHTML="";this.x=J(this.a,this.m);this.c.setAttribute("transform","translate("+this.x+" 0)");if(G(this)){this.Z.innerHTML="";if(W(this)){var a=C("g",{transform:"translate("+this.x+" 0)"},this.Z);new Eb({s:this.a.s,aa:this.Ua.bind(this),parent:a,F:{"class":"milestoneData"}},this.l.name,this.m,this.w);rb(R,this.a.s,[{icon:"icons/health.svg",action:this.La.bind(this)},{icon:"icons/delete.svg",action:this.wa.bind(this)},{icon:"icons/arrow-right.svg",action:this.Ka.bind(this)}],
{transform:"translate(0, -75)"},a)}this.c.appendChild(this.P);W(this)&&-1===this.l.a.index&&G(this)&&this.c.appendChild(this.j);a=C("g",{},this.c);this.o=C("path",{"class":jb(this),d:"M -7 0L 0 7L 7 0L 0 -7 Z"},a);this.o.addEventListener("click",this.Oa.bind(this))}};f.D=function(){this.j.innerHTML="";this.$.innerHTML="";C("line",{x1:0,y1:0,x2:0,y2:"100%"},this.j);C("line",{x1:this.x,y1:0,x2:this.x,y2:"100%"},this.$);return this.j};
function jb(a){if(W(a))switch(a.status){case 0:return"complete";case zb:return"on-track";case 2:return"at-risk";case 3:return"late"}else if(a.A===a.a.g)return"previous";t(function(){return!1})}function Ja(a){switch(a){case "complete":return 0;case "on-track":return zb;case "at-risk":return 2;case "late":return 3;case "previous":return 4}t(function(){return!1})}function G(a){return(W(a)||a.A===a.a.g)&&Ca(a.a,a.m)}function W(a){return a.a.a===a.A}
function Fb(a){var b=a.l.a;return{x:a.x,y:b.a.K+b.K+b.height-20}}function xa(a){var b=a.l.a;return{x:a.x,y:b.K+b.height-20}}function Gb(a){a=a.l.a;a.h();a.L()}f.R=function(a){t(function(){return a instanceof A});this.b.push(a)};function Hb(a,b){a.b=a.b.filter(function(a){return a!==b})}function Ib(a,b){t(function(){return b instanceof A});a.g.push(b)}function Jb(a,b){a.g=a.g.filter(function(a){return a!==b})}
f.Oa=function(){1===this.a.U?-1!==this.l.a.index&&W(this)&&this.a.R({report:this.a.a.index,dependency:this.a.ba,dependent:this.l.index}).h():this.A!==this.a.g||L(this.l)||(K(this.a,{milestone:this.l.index,report:this.a.a.index,comment:this.w,status:this.status,date:this.m}).h(),this.l.h(),Gb(this))};function M(a){nb(a.l,a);a.b.forEach(function(a){return a.j()});a.g.forEach(function(a){return a.j()});U(a.a.j,a)}
f.Ua=function(a){var b=this.a;this.m=lb(b.start,b.o,a.m);this.w=a.w;this.l.name=a.title;this.h();this.D();this.l.h();Gb(this)};f.La=function(){this.status=3<=this.status?0:this.status+1;this.o.setAttribute("class",jb(this))};f.wa=function(){M(this);0===this.l.g.length?ob(this.l):this.l.h();Gb(this)};f.Ka=function(){-1!==this.l.a.index&&(this.a.U=1,this.a.ba=this.l.index,this.a.V=!0)};function y(a,b,c){this.b=C("g",{"class":"reportLine"});this.j=C("g",{"class":"reportLine"});this.index=b;this.a=c;this.restore(a)}y.prototype.restore=function(a){this.m=a.date;this.name=a.name};
function db(a,b,c){a.g=C("g",b,c);b=a===a.a.a?"Current:":"Baseline:";C("text",{"class":"reportHeader","text-anchor":"end"},a.g).textContent=b;b=C("g",{},a.g);new Q({s:a.a.s,onchange:a.o.bind(a),parent:b,Y:S,F:{transform:"translate(0, 20)","class":"reportDate"}},a.m);b=C("g",{},a.g);new Kb(a.name,a.a.s,a.B.bind(a),b)}
y.prototype.D=function(){this.b.innerHTML="";this.j.innerHTML="";if(!Ca(this.a,this.m))return this.b;var a=J(this.a,this.m);C("line",{x1:a,y1:this.a.O.b.height+20,x2:a,y2:"100%"},this.b);C("line",{x1:a,y1:0,x2:a,y2:"100%"},this.j);return this.b};function Lb(a){a.a.j.filter(function(b){return b.A===a}).forEach(function(a){return M(a)});U(a.a.b,a);a.a.a=a.a.g}y.prototype.o=function(a,b){this.m=b.m;ta(this.a);this.D()};y.prototype.B=function(a,b){this.name=b.text;ta(this.a)};function A(a,b,c){this.c=C("g",{"class":"dependency"});this.c.addEventListener("dblclick",this.j.bind(this));this.index=b;this.g=c;this.restore(a)}
A.prototype.restore=function(a){var b=this;t(function(){return Number.isInteger(a.report)});t(function(){return b.g.b[a.report]});t(function(){return Number.isInteger(a.dependent)});t(function(){return b.g.u[a.dependent]});t(function(){return Number.isInteger(a.dependency)});t(function(){return b.g.u[a.dependency]});this.A=this.g.b[a.report];this.b&&Hb(this.b,this);this.b=kb(this.g.u[a.dependent],this.A);t(function(){return b.b});this.b.R(this);this.a&&Jb(this.a,this);this.a=kb(this.g.u[a.dependency],
this.A);t(function(){return b.a});Ib(this.a,this)};function sa(a){t(function(){return a.g.j[a.a.index]===a.a});t(function(){return a.g.j[a.b.index]===a.b});t(function(){return a.g.u[a.a.l.index]===a.a.l});t(function(){return a.g.u[a.b.l.index]===a.b.l});return{dependent:a.b.l.index,dependency:a.a.l.index,report:a.A.index}}A.prototype.h=function(){this.c.innerHTML="";this.A===this.g.a&&G(this.b)&&G(this.a)&&this.D(Fb(this.a),Fb(this.b),this.c)};
A.prototype.D=function(a,b,c){if(this.a.m<=this.b.m)var d="dependencyLineOK",e="dependencyArrowOK";else d="dependencyLineLate",e="dependencyArrowLate";b.x-=7;Mb(a,b,d,c);Mb(a,b,"vthick transparentLine",c);C("path",{"class":e,d:"M -4 -4 L -4 4 L 0 0 Z",transform:"translate("+b.x+", "+b.y+")"},c)};var Nb=0;
function ya(a,b,c,d){a.D(b,c,d);c=Mb(b,c,"transparentLine",d);Nb++;b="dependency"+Nb;c.setAttribute("id",b);c=C("text",{"class":"dependencyText"},d);C("textPath",{"xlink:href":"#"+b},c).textContent="\u00a0\u00a0\u00a0\u00a0"+a.b.l.name;d=C("text",{"text-anchor":"end","class":"dependencyText"},d);C("textPath",{"xlink:href":"#"+b,startOffset:"100%"},d).textContent=a.a.l.name+"\u00a0\u00a0\u00a0\u00a0"}A.prototype.j=function(){Jb(this.a,this);Hb(this.b,this);U(this.g.C,this);this.c.parentNode.removeChild(this.c)};function na(a){this.u=[];this.index=-1;this.name="Business Milestones";this.c=C("g",{"class":"businessMs"});this.g=C("g",{"class":"businessMs"});this.b=a;this.height=40;this.o=0}f=na.prototype;
f.h=function(){var a=this;this.c.innerHTML="";this.g.innerHTML="";var b=this.ja();this.height=this.o;var c=C("g",{transform:"translate(0 "+(this.height-20)+")"},this.c);C("line",{x1:0,y1:0,x2:this.b.width,y2:0,"class":"projectLine"},c);this.u.filter(function(a){return L(a)}).forEach(function(b){var d=L(b);t(function(){return d});d.D();c.appendChild(b.c);a.g.appendChild(d.$)});c.appendChild(b);b=C("g",{"class":"businessMsHeader",transform:"translate(0, -10)"},c);C("text",{},b).textContent="Business Milestones";
rb(R,this.b.s,[{icon:"icons/plus.svg",action:this.ka.bind(this)}],{transform:"translate(180, -7)"},b);return this.c};f.ja=w.prototype.ga;f.L=function(){E(this.b)};f.ca=function(a){this.u.push(a)};f.W=function(a){this.u=this.u.filter(function(b){return b!==a})};f.ka=w.prototype.ha;function Eb(a,b,c,d){this.s=a.s;this.aa=a.aa||function(){};this.parent=a.parent;this.F=a.F||{};this.a=!1;this.restore(b,c,d);this.h()}var tb=35;f=Eb.prototype;f.restore=function(a,b,c){this.title=a;this.title=""===this.title?"Untitled":this.title;this.m=b;this.w=c;this.w=""===this.w?"":this.w};f.h=function(){this.c=Ob(this.va.bind(this),this.ua.bind(this),this.s,this.F,this.parent)};
f.ua=function(a){a.innerHTML="";a=C("foreignObject",{width:315,height:45,x:5,y:-55},a);var b=X("input",{"class":"svgDateBox",value:B(this.m),type:"date",required:""},a);b.addEventListener("change",this.ta.bind(this,b));b=X("input",{"class":"svgTextBox",value:this.title,type:"text",placeholder:"Milestone Name"},a);b.addEventListener("change",this.Xa.bind(this,b));a=X("input",{"class":"svgCommentBox",value:this.w,type:"text",placeholder:"Milestone Comment"},a);a.addEventListener("change",this.sa.bind(this,
a))};f.va=function(a){this.a&&(this.aa(this),this.a=!1);a.innerHTML="";var b=new Date(this.m);b=$a(b)+" "+Ya(b)+": ";C("text",{"text-anchor":"start",transform:"translate(5, -15)"},a).textContent=Pb(b+this.title,100);C("text",{"class":"msComment",transform:"translate(5, 0)"},a).textContent=Pb(this.w,100)};f.Xa=function(a){this.restore(a.value,this.m,this.w);this.a=!0};f.sa=function(a){this.restore(this.title,this.m,a.value);this.a=!0};f.ta=function(a){this.m=Qb(a);this.a=!0};function g(){var a=document.getElementById("app");this.c=X("div",{"class":"milestoneMapContainer"},a);this.parent=a;Rb(this.h.bind(this));this.ia()}g.prototype.a=function(){var a=JSON.stringify(pa(this.map),null,"\t");Sb(this.map.name+".json",a,"application/json",this.c)};g.prototype.restore=function(a){a=JSON.parse(a);this.map=new u(a)};
g.prototype.h=function(){this.c.innerHTML="";var a=X("div",{"class":"menubar"},this.c),b=Y("File",a);Z([{icon:"icons/new.svg",action:this.ia.bind(this)},{icon:"icons/open.svg",action:this.Ra.bind(this)},{icon:"icons/save.svg",action:this.a.bind(this)},{icon:"icons/exportCSV.svg",action:this.Pa.bind(this)},{icon:"icons/import.svg",action:this.Qa.bind(this)}],b.body);b=Y("Programme",a);Z([{icon:"icons/plus.svg",action:this.map.Ya.bind(this.map)}],b.body);b=Y("Comparison",a);Z([{icon:"icons/camera.svg",
action:this.$a.bind(this)},{icon:"icons/delete.svg",action:this.Na.bind(this)}],b.body);ta(this.map);b.body.appendChild(this.map.ea);b=Y("Print",a);Z([{icon:"icons/print.svg",action:this.qa.bind(this)}],b.body);Tb(this,b.body);b=Y("About",a);Z([{icon:"icons/info.svg",action:function(){return alert('Milestone Map, Version: 1.2.7\u03b2\n\nFor help and support, please visit:\n\nhttps://andymac-2.github.io/milestoneMap/instructions\n\n\n\nCopyright 2018 Andrew Pritchard\n\nLicensed under the Apache License, Version 2.0 (the "License");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an "AS IS" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n')}},
{icon:"icons/question.svg",action:function(){return window.open("https://andymac-2.github.io/milestoneMap/instructions")}}],b.body);this.map.pa=window.innerHeight-a.getBoundingClientRect().height-5;this.c.appendChild(this.map.J);this.map.h()};
var Ub=[{height:1682,width:2378},{height:1189,width:1682},{height:841,width:1189},{height:594,width:841},{height:420,width:594},{height:297,width:420},{height:210,width:297},{width:1682,height:2378},{width:1189,height:1682},{width:841,height:1189},{width:594,height:841},{width:420,height:594},{width:297,height:420},{width:210,height:297}].map(function(a){return a.width>a.height?{height:a.height-70,width:a.width-70}:a}),ma=Ub[5],Vb="4A0 Landscape;2A0 Landscape;A0 Landscape;A1 Landscape;A2 Landscape;A3 Landscape;A4 Landscape;4A0 Portrait;2A0 Portrait;A0 Portrait;A1 Portrait;A2 Portrait;A3 Portrait;A4 Portrait".split(";");
function Tb(a,b){ua("Page Size:",function(b){a.map.B=Ub[b.currentTarget.value]},Vb,{"class":"pageSizeSelector"},b)}f=g.prototype;f.$a=function(){Ga(this.map);this.h()};f.Na=function(){1>=this.map.b.length||(Lb(this.map.a),this.h())};
f.ia=function(){var a=Aa(),b=a-5184E6,c=new Date(b);c=c.setUTCFullYear(c.getUTCFullYear()+1).valueOf();this.map=new u({name:"New Map",start:b,end:c,programmes:[],projects:[],milestones:[],msAtReports:[],reports:[{name:"Baseline",date:a}],dependencies:[],currReport:0,cmpReport:0});this.h()};f.Ra=function(){var a=this;Wb(this.c,function(b){try{a.restore(b),a.h()}catch(c){throw alert("Error: Invalid file."),c;}},".json")};
f.Qa=function(){var a=this;Wb(this.c,function(b){try{var c=[],d=!1,e,k,m;for(m=k=e=0;e<b.length;e++){var l=b[e],n=b[e+1];c[m]=c[m]||[];c[m][k]=c[m][k]||"";'"'==l&&d&&'"'==n?(c[m][k]+=l,++e):'"'==l?d=!d:","!=l||d?"\r"!=l||"\n"!=n||d?"\n"!=l||d?"\r"!=l||d?c[m][k]+=l:(++m,k=0):(++m,k=0):(++m,k=0,++e):++k}0===c[c.length-1].length&&c.pop();Ka(a.map,c);a.h()}catch(p){throw alert(p.name+": "+p.message),p;}},".csv")};f.Pa=function(){var a=Ma(this.map);Sb(this.map.name+".csv",a,"text/csv",this.c)};
f.qa=function(){var a=new u(pa(this.map),this.map.B);try{va(a),this.parent.innerHTML=a.X.innerHTML,window.print(),this.parent.innerHTML="",this.parent.appendChild(this.c)}catch(b){throw alert(b.name+": "+b.message),b;}};var R=1,S=2;function Mb(a,b,c,d){return C("path",{"class":c,d:"M"+a.x+" "+a.y+" C"+(a.x+150)+" "+a.y+" "+(b.x-150)+" "+b.y+" "+b.x+" "+b.y},d)};function H(a,b){b.forEach(function(b){b.c.setAttribute("transform","translate(0, "+a+")");b.K=a;a+=b.height});return a}function Xb(a){a=a.getCTM();return{x:a.e,y:a.f}}var Yb=void 0;function Ob(a,b,c,d,e){d=C("g",d,e);return Zb(d,a,b,c,e)}function Zb(a,b,c,d,e){function k(){b(a);e.contains(a)&&e.addEventListener("click",m)}function m(){c(a);e.removeEventListener("click",m);e.contains(a)&&d.I.push({c:e,event:k})}k();return a}function sb(a,b){$b.font=a;return $b.measureText(b).width}var $b=document.createElement("canvas").getContext("2d");function ac(a,b,c){c=C("g",{"class":"menu"},c);switch(a){case 0:var d=45*(b.length+1)/-2;break;case R:d=-22.5;break;case S:d=-(45*(b.length+1))}for(a=0;a<b.length;a++){d+=45;var e=C("g",{transform:"translate("+d+", 0)","class":"menuEntry"},c);e.addEventListener("click",b[a].action);C("circle",{"class":"iconCircle",r:"14"},e);C("image",{x:"-8",y:"-8",height:"16",width:"16"},e).setAttributeNS("http://www.w3.org/1999/xlink","href",b[a].icon)}return c}
function rb(a,b,c,d,e){return Ob(function(a){return a.innerHTML=""},function(b){b.innerHTML="";ac(a,c,b)},b,d,e)}function Y(a,b){b=v("span",{"class":"menuBarSegment"},b);v("div",{"class":"menuBarHeader"},b).textContent=a;a=v("div",{"class":"menuBarContent"},b);return{c:b,body:a}}function Z(a,b){b=v("span",{},b);b=C("svg",{width:45*a.length,height:40},b);ac(R,a,b).setAttribute("transform","translate (0, 20)")}
function ua(a,b,c,d,e){d=v("span",d,e);v("div",{"class":"dropdownSegmentHeading"},d).textContent=a;a=v("select",{"class":"dropdownSegmentDropdown"},d);a.addEventListener("change",b);v("option",{selected:"",disabled:"",hidden:""},a).textContent="Please choose:";for(b=0;b<c.length;b++)v("option",{value:b},a).textContent=c[b]};function cb(a,b){this.width=a;this.height=0;this.c=C("g",{},b);this.g=C("foreignObject",{width:this.width},this.c);this.a=v("div",{style:"width:"+this.width+"px;max-width:"+this.width+"px;"},this.g);this.a.addEventListener("input",this.b.bind(this))}
cb.prototype.b=function(){var a=this.a;document.contains(a)?a=a.offsetHeight:(Yb||(Yb=v("div",{style:"position:absolute;visibility:hidden;"},document.body)),a=a.cloneNode(!0),Yb.appendChild(a),a=a.offsetHeight,Yb.innerHTML="");a+=8;this.height!==a&&(this.height=a,this.g.setAttribute("height",this.height),this.g.setAttribute("y",-this.height),a=new CustomEvent("verticalResize",{detail:this}),this.c.dispatchEvent(a))};
function P(a,b,c,d){var e=this;this.s=b.s;this.G=b.G;this.parent=d;this.onchange=b.onchange||function(){};c.contenteditable="true";this.c=v("p",c,d);this.c.addEventListener("input",this.la.bind(this,this.c));this.c.addEventListener("input",function(a){return e.onchange(a,e)});this.c.addEventListener("focus",this.ab.bind(this));this.restore(a);this.h()}f=P.prototype;f.restore=function(a){this.text=a?a:this.G};f.h=function(){Zb(this.c,this.bb.bind(this),this.Ja.bind(this),this.s,this.parent)};
f.bb=function(){this.c.textContent=this.text||this.G;this.c.classList.remove("clickedActive");this.c.classList.add("notClickedActive")};f.Ja=function(){this.c.textContent=this.text;this.c.classList.add("clickedActive");this.c.classList.remove("notClickedActive")};f.ab=function(){var a=this.c,b=document.createRange();b.selectNodeContents(a);a=window.getSelection();a.removeAllRanges();a.addRange(b)};f.la=function(a){this.restore(a.textContent)};function v(a,b,c){a=document.createElement(a);if(b)for(var d in b)a.setAttribute(d,b[d]);c&&c.appendChild(a);return a}function bc(a,b,c,d){a=document.createElementNS(a,b);if(c)for(var e in c)a.setAttribute(e,c[e]);d&&d.appendChild(a);return a}var C=bc.bind(null,"http://www.w3.org/2000/svg"),X=bc.bind(null,"http://www.w3.org/1999/xhtml");function Kb(a,b,c,d){var e=R;this.G="Untitled";switch(e){case R:this.a="start";break;case 0:this.a="middle";break;default:t(function(){return!1})}this.s=b;this.onchange=c;this.parent=d;this.F={transform:"translate(5, 20)","class":"reportName"};this.restore(a);this.h()}f=Kb.prototype;f.restore=function(a){this.text=a;this.text=""===this.text?this.G:this.text};f.h=function(){this.c=Ob(this.oa.bind(this),this.na.bind(this),this.s,this.F,this.parent)};
f.na=function(a){var b=this,c=a.getBoundingClientRect().height;a.innerHTML="";var d=10*c,e="middle"===this.a?d/-2:0,k=Xb(a),m=-k.x;k=-k.y;a=C("foreignObject",{width:d,height:1.4*c,transform:"translate("+m+", "+k+")",x:e-m,y:0-c-k},a);a=v("input",{"class":"svgTextBox",type:"text",value:this.text},a);a.focus();a.select();a.addEventListener("change",this.ma.bind(this,a));a.addEventListener("change",function(a){return b.onchange(a,b)})};
f.oa=function(a){a.innerHTML="";C("text",{"text-anchor":this.a},a).textContent=Pb(this.text,40)};f.ma=function(a){this.restore(a.value)};function Q(a,b){switch(a.Y){case R:this.a="start";break;case S:this.a="end";break;default:t(function(){return!1})}this.s=a.s;this.onchange=a.onchange||function(){};this.parent=a.parent;this.F=a.F||{};this.min=a.min||null;this.max=a.max||null;this.restore(b);this.h()}Q.prototype.restore=function(a){this.m=a};Q.prototype.h=function(){this.c=Ob(this.g.bind(this),this.b.bind(this),this.s,this.F,this.parent)};
Q.prototype.b=function(a){var b=this,c=a.getBoundingClientRect().height;a.innerHTML="";var d=10*c;a=C("foreignObject",{width:d,height:1.5*c,x:"start"===this.a?0:-d,y:0-c},a);c={"class":"svgDateBox",value:B(this.m),type:"date",required:""};this.min&&(c.min=B(this.min));this.max&&(c.max=B(this.max));var e=X("input",c,a);e.focus();e.select();e.addEventListener("blur",function(a){""!==e.value&&(b.m=Qb(e));b.onchange(a,b)})};
Q.prototype.g=function(a){a.innerHTML="";C("text",{"text-anchor":this.a},a).textContent=B(this.m)};function la(a){this.c=a;this.I=[];this.a=[];a.addEventListener("click",this.click.bind(this),!0)}la.prototype.click=function(a){for(var b=0;b<this.I.length;b++)for(;this.I[b]&&(!this.c.contains(this.I[b].c)||!this.I[b].c.parentNode.contains(a.target));)this.I[b].event(),this.I[b]=this.I[this.I.length-1],this.I.pop();for(b=0;b<this.a.length;b++)this.a[b].c.parentNode.contains(a.target)||this.a[b].event()};function lb(a,b,c){c=c>b?b:c;return c<a?a:c}function cc(a,b){for(var c=0;c<a.length-1;c++)if(0<=b(a[c],a[c+1]))return!1;return!0}function V(a){return cc(a,function(a,c){return a.index-c.index})}function wb(a,b,c){t(function(){return c<=a.length});t(function(){return 0<=c});for(var d=a.length;d>c;d--)a[d]=a[d-1],a[d].index=d;a[c]=b;b.index=c}function xb(a,b){b.index=a.length;a.push(b)}
function U(a,b){t(function(){return a[b.index]===b});for(var c=b.index;c<a.length-1;c++)a[c]=a[c+1],a[c].index=c;a.pop()}function Bb(a,b,c){t(function(){return 0<=a.indexOf(b)});t(function(){return 0<=a.indexOf(c)});var d=a.indexOf(b),e=a.indexOf(c),k=a[d];a[d]=a[e];a[e]=k}function Ab(a,b,c){t(function(){return a[b].index===b});t(function(){return a[c].index===c});var d=a[b];a[b]=a[c];a[c]=d;a[b].index=b;a[c].index=c}function B(a){return(new Date(a)).toISOString().slice(0,10)}
function Qb(a){return(new Date(a.value+"T00:00:00.000Z")).valueOf()+1}function Ba(a){return a-a%864E5+1}function Sb(a,b,c,d){var e=v("a",{style:"display:none;"},d);e.href="download"in e?URL.createObjectURL(new Blob([b],{type:c})):"data:application/octet-stream,"+encodeURIComponent(b);e.download=a;e.click();d.removeChild(e)}
function Wb(a,b,c){var d={type:"file",style:"display:none;"};c&&(d.accept=c);var e=v("input",d,a),k=new FileReader;k.onload=function(){b(k.result);a.contains(e)&&a.removeChild(e)};e.addEventListener("change",function(){k.readAsText(e.files[0])});e.click()}function Pb(a,b){return a.length>b-3?a.slice(0,b-3)+"...":a}function Rb(a){var b=window,c=100;c=c||100;var d;b.addEventListener("resize",function(){d&&window.clearTimeout(d);d=setTimeout(a,c)})};}).call(this);
