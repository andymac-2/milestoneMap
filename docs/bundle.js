(function(){var f,aa="function"==typeof Object.create?Object.create:function(a){function b(){}b.prototype=a;return new b},ba;if("function"==typeof Object.setPrototypeOf)ba=Object.setPrototypeOf;else{var ca;a:{var da={Ia:!0},ea={};try{ea.__proto__=da;ca=ea.Ia;break a}catch(a){}ca=!1}ba=ca?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null}
var fa=ba,ha="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)},g="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=global?global:this;function ia(){ia=function(){};g.Symbol||(g.Symbol=ja)}var ja=function(){var a=0;return function(b){return"jscomp_symbol_"+(b||"")+a++}}();
function ka(){ia();var a=g.Symbol.iterator;a||(a=g.Symbol.iterator=g.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&ha(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return la(this)}});ka=function(){}}function la(a){var b=0;return ma(function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}})}function ma(a){ka();a={next:a};a[g.Symbol.iterator]=function(){return this};return a}function na(a){ka();var b=a[Symbol.iterator];return b?b.call(a):la(a)}
function oa(a){for(var b,c=[];!(b=a.next()).done;)c.push(b.value);return c}function pa(a,b){if(b){var c=g;a=a.split(".");for(var d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&ha(c,a,{configurable:!0,writable:!0,value:b})}}pa("Number.isFinite",function(a){return a?a:function(a){return"number"!==typeof a?!1:!isNaN(a)&&Infinity!==a&&-Infinity!==a}});
pa("Number.isInteger",function(a){return a?a:function(a){return Number.isFinite(a)?a===Math.floor(a):!1}});pa("Array.prototype.find",function(a){return a?a:function(a,c){a:{var b=this;b instanceof String&&(b=String(b));for(var e=b.length,k=0;k<e;k++){var m=b[k];if(a.call(c,m,k,b)){a=m;break a}}a=void 0}return a}});window.onload=function(){new h};function q(a){a=Error.call(this,"Assertion failed : "+a);this.message=a.message;"stack"in a&&(this.stack=a.stack);this.name="AssertionError"}var r=Error;q.prototype=aa(r.prototype);q.prototype.constructor=q;if(fa)fa(q,r);else for(var t in r)if("prototype"!=t)if(Object.defineProperties){var qa=Object.getOwnPropertyDescriptor(r,t);qa&&Object.defineProperty(q,t,qa)}else q[t]=r[t];q.a=r.prototype;function u(a){if(!a())throw new q(a.toString());};function v(a,b){var c=this;this.ea=w("span",{});this.J=w("div",{"class":"mMapContainer"});this.J.addEventListener("click",this.Ma.bind(this));this.X=w("span",{"class":"printablePages"});this.m=new ra(this.J);this.B=b||sa;this.U=0;this.ba=null;this.V=!1;ta(function(){var a=document.activeElement;"input"===a.tagName||"true"===a.getAttribute("contenteditable")?ua(c.m,a,function(){return c.h()}):c.h()});this.restore(a)}f=v.prototype;
f.restore=function(a){var b=this;u(function(){return Number.isInteger(a.start)});u(function(){return Number.isInteger(a.end)});u(function(){return"string"===typeof a.name});this.start=a.start;this.s=a.end;this.name=a.name;this.I=new va(this);this.v=a.programmes.map(function(a,d){return new wa(a,d,b)});this.i=a.projects.map(function(a,d){return new x(a,d,b)});this.u=a.milestones.map(function(a,d){return new y(a,d,b)});this.b=a.reports.map(function(a,d){return new z(a,d,b)});u(function(){return Number.isInteger(a.currReport)});
u(function(){return b.b[a.currReport]});u(function(){return Number.isInteger(a.cmpReport)});u(function(){return b.b[a.cmpReport]});this.a=this.b[a.currReport];this.g=this.b[a.cmpReport];this.j=a.msAtReports.map(function(a,d){return new A(a,d,b)});this.D=a.dependencies.map(function(a,d){return new B(a,d,b)})};
function xa(a){return{name:a.name,end:a.s,start:a.start,currReport:a.a.index,cmpReport:a.g.index,reports:a.b.map(function(a){return{date:a.o,name:a.name}}),programmes:a.v.map(function(a){return{name:a.name,comment:a.w}}),projects:a.i.map(function(a){return ya(a)}),milestones:a.u.map(function(a){return{name:a.name,project:a.a.index}}),msAtReports:a.j.map(function(a){return za(a)}),dependencies:a.D.map(function(a){return Aa(a)})}}
function Ba(a){var b=a.ea;b.innerHTML="";var c={"class":"reportSelector"},d=a.b.sort(function(a,b){return a.o-b.o}).map(function(a){return a.name+": "+C(a.o)});Ca("Snapshot 1 (Current)",a.Ta.bind(a),d,c,b);Ca("Snapshot 2 (Baseline)",a.Sa.bind(a),d,c,b)}
f.h=function(){this.J.innerHTML="";this.pa=window.innerHeight-60-18;this.T=D("svg",{"class":"mMapFixed"},this.J);this.fa=w("div",{"class":"mMapScrollBox"},this.J);this.M=D("svg",{"class":"milestoneMap",height:5E3},this.fa);var a=D("g",{"class":"bg"},this.M);this.da=D("g",{"class":"dependencies"},this.M);var b=D("g",{"class":"fg"},this.M);this.width=Math.max(1023,this.M.getBoundingClientRect().width);this.O=new E(this,this.T,a);this.j.forEach(function(a){return a.h()});this.u.forEach(function(a){return a.h()});
this.i.forEach(function(a){return a.h()});this.T.appendChild(this.I.h());a.appendChild(this.I.g);this.v.forEach(function(a){return b.appendChild(a.h())});this.T.appendChild(this.a.F());b.appendChild(this.a.j);F(this)};f.N=5;
function Da(a){a.X.innerHTML="";a.width=a.B.width*v.prototype.N;a.height=a.B.height*v.prototype.N;a.j.forEach(function(a){return a.h()});a.u.forEach(function(a){return a.h()});a.i.forEach(function(a){return a.h()});a.v.forEach(function(a){return a.h()});var b=a.I.h(),c=0,d=0,e=0,k=[];do{var m=D("svg",{"class":"milestoneMapPage",viewbox:"0 0 "+a.B.width*v.prototype.N+" "+a.B.height*v.prototype.N},a.X);a.O=new E(a,m);var l=a.O.s,n=b.cloneNode(!0);n.setAttribute("transform","translate(0, "+l+")");m.appendChild(n);
l+=a.I.height;n=a.B.height*v.prototype.N-l;if(0>=n)throw Error("Page size not large enough for Business Milestones.");if(c>=a.v.length){m.appendChild(a.a.F().cloneNode(!0));break}var p=D("g",{"class":"dependencies"},m);k.push(p);p=!0;do{var P=a.v[c];P.K=l;var J=Ea(P,n,d,p,e);p=!1;m.appendChild(J.c);J.c.setAttribute("transform","translate(0, "+l+")");if(J.index===P.i.length)c++,d=0,l+=n-J.S,n=J.S;else{d=J.index;break}}while(c<a.v.length);l=a.a.F();m.appendChild(l.cloneNode(!0));e++}while(c<a.v.length);
a.D.forEach(function(a){if(a.A===a.g.a&&G(a.b)&&G(a.a)){var b=Fa(a.a),c=Fa(a.b);c.x-=7;var d=a.b.l.a.B,e=a.a.l.a.B;if(d===e){var l=D("g",{"class":"dependency"},k[d]);a.F(b,c,l)}else{var m=a.g.B.height*v.prototype.N;d>e?(l=c.y+m,m=b.y-m):(l=c.y-m,m=b.y+m);e=D("g",{"class":"dependency"},k[e]);d=D("g",{"class":"dependency"},k[d]);Ga(a,b,{x:c.x,y:l},e);Ga(a,{x:b.x,y:m},c,d)}}})}function Ha(a){a.D.forEach(function(b){b.h();a.da.appendChild(b.c)})}f.Ma=function(){this.V?this.V=!1:(this.U=0,this.ba=null)};
function F(a){var b=H(a.O.s,[a.I]);a.T.setAttribute("height",b);b=a.pa-b;250<b&&a.fa.setAttribute("style","max-height:"+b+"px;");var c=H(30,a.v);c=Math.max(c,b);a.M.setAttribute("height",c);a.a.F();Ha(a)}function I(a){a=.2*a.width;return 350>a?a:350}function K(a,b){return(b.valueOf()-a.start)/(a.s-a.start)*(a.width-I(a))+I(a)}function Ia(){var a=new Date(Date.now());return Ja(a.valueOf()-6E4*a.getTimezoneOffset())}function Ka(a,b){return b>=a.start&&b<=a.s}
function L(a,b){b=new A(b,a.j.length,a);a.j.push(b);return b}f.R=function(a){a=new B(a,this.D.length,this);this.D.push(a);this.da.appendChild(a.c);return a};function La(a,b){b=new y(b,a.u.length,a);a.u.push(b);return b}function Ma(a,b){b=new x(b,a.i.length,a);a.i.push(b);return b}function Na(a,b){b=new wa(b,a.v.length,a);a.v.push(b);return b}
function Oa(a){var b=new z({name:"New Report",date:Ia()},a.b.length,a);a.b.push(b);a.j.filter(function(b){return b.A===a.a}).forEach(function(c){c=za(c);c.report=b.index;L(a,c)});a.D.filter(function(b){return b.A===a.a}).forEach(function(c){c=Aa(c);c.report=b.index;a.R(c)});a.g=a.a;a.a=b}
function Pa(a){for(var b=1;b<a.length;b++){var c=a[b];if(6!==c.length&&5!==c.length)throw Error("CSV row "+(b+1)+" does not contain the correct number of columns");var d=c[4];if("complete"!==d&&"on-track"!==d&&"at-risk"!==d&&"late"!==d&&"previous"!==d)throw Error("Milestone health on row "+(b+1)+" is invalid.Must be one of 'complete', 'on-track', 'at-risk', 'late', or 'previous'");if(isNaN((new Date(c[3]+"T00:00:00.000Z")).valueOf()+1))throw Error("Invalid date format on row "+(b+1)+". The Date must be formatted as YYYY-MM-DD");
}}function Qa(a,b){var c=b[0],d=b[1],e=b[2],k=b[3],m=b[4];b=b[5]||"";if("Business Milestones"!==c){var l=a.v.find(function(a){return a.name===c});l||(l=Na(a,{name:c}));var n=l.i.find(function(a){return a.name===d});n||(n=Ma(a,{name:d,programme:l.index}))}else n=a.I;(l=n.u.find(function(a){return a.name===e}))||(l=La(a,{name:e,project:n.index}));n=M(l);k={milestone:l.index,report:a.a.index,comment:b,status:Ra(m),date:(new Date(k+"T00:00:00.000Z")).valueOf()+1};n?n.restore(k):L(a,k)}
function Sa(a,b){Pa(b);a.j.filter(function(b){return b.A===a.a}).forEach(function(a){return Ta(a)});for(var c=1;c<b.length;c++)Qa(a,b[c])}f.Ya=function(){Na(this,{name:"New Programme"});this.h()};var Ua="Programme Name;Project Name;Milestone Name;Date (YYYY-MM-DD);Health ('complete', 'on-track', 'at-risk', 'late', or 'previous);Comment".split(";").map(function(a){return JSON.stringify(a)}).join(",");
function Va(a){a=a.u.filter(function(a){return M(a)}).map(function(a){return Wa(a)}).join("\n");return Ua+"\n"+a}f=v.prototype;f.ra=function(a,b){this.name=b.text};f.Wa=function(a,b){b.o<=this.s&&(this.start=b.o);this.h()};f.Va=function(a,b){b.o>=this.start&&(this.s=b.o);this.h()};f.Ta=function(a){a=a.currentTarget.value;0<=a&&a<this.b.length&&(this.a=this.b[a]);this.h()};f.Sa=function(a){a=a.currentTarget.value;0<=a&&a<this.b.length&&(this.g=this.b[a]);this.h()};function E(a,b,c){this.c=D("g",{"class":"dateHeader"},b);this.g=D("g",{},this.c);this.j=D("g",{},this.c);this.I=D("g",{"class":"dateHeader"},c);this.a=a;this.h()}function Xa(a){a.setUTCHours(0,0,0,0);return a}function Ya(a){a.setUTCMonth(0,1);a.setUTCHours(0,0,0,0);return a}function Za(a){a.setUTCDate(1);a.setUTCHours(0,0,0,0);return a}function $a(a){a.setUTCDate(a.getUTCDate()-(a.getUTCDay()-1)%7);return a}function ab(a){var b=a.getUTCFullYear();a.setUTCFullYear(b-b%10);Ya(a);return a}
function bb(a){a.setUTCDate(a.getUTCDate()+1);return a}function cb(a){a.setUTCDate(a.getUTCDate()+7);return a}function db(a){a.setUTCMonth(a.getUTCMonth()+1);return a}function eb(a){a.setUTCFullYear(a.getUTCFullYear()+1);return a}function fb(a){a.setUTCFullYear(a.getUTCFullYear()+10);return a}function gb(a){return a.getUTCDate()}
function hb(a){var b=3-(a.getUTCDay()-1)%7,c=new Date(a.valueOf());Xa(c);c.setUTCDate(a.getUTCDate()+b);return""+Math.ceil((c.valueOf()-(new Date(c.getUTCFullYear(),0,1)).valueOf())/6048E5)}function ib(a){return"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ")[a.getUTCMonth()]}function jb(a){return""+a.getUTCFullYear()}function kb(a){a=a.getUTCFullYear();return""+(a-a%10)+"'s"}
E.prototype.h=function(){this.g.innerHTML="";var a=D("g",{transform:"translate("+(lb+60)+" 0)"},this.j);this.b=new mb(this.a.width-2*lb-120,a);new N(this.a.name,{m:this.a.m,H:"Untitled",onchange:this.a.ra.bind(this.a)},{"class":"mMapTitle"},this.b.a);this.b.b();this.j.setAttribute("transform","translate(0 "+this.b.height+")");this.b.c.addEventListener("verticalResize",this.J.bind(this));this.j.setAttribute("transform","translate(0 "+this.b.height+")");this.g.setAttribute("transform","translate(0 "+
this.b.height+")");a=D("g",{},this.j);new O({m:this.a.m,onchange:this.a.Wa.bind(this.a),parent:a,max:this.a.s-1728E5,Y:Q,G:{transform:"translate(10 -5)","class":"mMapEdgeDate"}},this.a.start);a=D("g",{},this.j);new O({m:this.a.m,onchange:this.a.Va.bind(this.a),parent:a,min:this.a.start+1728E5,Y:R,G:{transform:"translate("+(this.a.width-10)+" -5)","class":"mMapEdgeDate"}},this.a.s);nb(this.a.a,{transform:"translate("+(this.a.width-lb)+", -5)"},this.j);this.a.a!==this.a.g&&nb(this.a.g,{transform:"translate("+
lb+", -5)"},this.j);a=[];var b=this.a.s-this.a.start,c=b/this.a.width;189216E6<b&&a.push(ob);18144E6<b&&a.push(pb);1728E6<b&&8928E4>c&&a.push(qb);3024E4>c&&a.push(rb);432E4>c&&a.push(sb);b=20;for(c=0;c<a.length-2;c++)S(this,b,20,a[c],this.B.bind(this)),b+=20;1<a.length?(S(this,b,"100%",a[a.length-2],this.B.bind(this)),S(this,b,"100%",a[a.length-2],this.D.bind(this)),b+=20,S(this,b,20,a[a.length-1],this.M.bind(this))):(S(this,b,"100%",a[0],this.B.bind(this)),S(this,b,"100%",a[0],this.D.bind(this)));
this.O=this.s=b+20;this.s+=10+this.b.height;D("rect",{x:0,y:0,width:I(this.a),height:"100%","class":"whiteBackground"},this.g);D("rect",{x:0,y:0,width:I(this.a),height:"100%","class":"whiteBackground"},this.I)};E.prototype.D=function(a,b,c,d,e,k){D("rect",{"class":k,height:"100%",y:"0",x:a,width:b-a},this.I)};E.prototype.B=function(a,b,c,d,e,k){D("rect",{"class":k,height:d,y:c,x:a,width:b-a},this.g);D("text",{"class":"majorRowText",y:c+15,x:(a+b)/2,"text-anchor":"middle"},this.g).textContent=e};
E.prototype.M=function(a,b,c,d,e){D("line",{"class":"dateHeaderSeparator",x1:a,y1:c+3,x2:a,y2:c+d-3},this.g);D("text",{"class":"minorRowText",y:c+15,x:(a+b)/2,"text-anchor":"middle"},this.g).textContent=e};var sb=0,rb=1,qb=2,pb=3,ob=4;
function S(a,b,c,d,e){switch(d){case sb:var k=Xa,m=bb,l=gb;break;case rb:k=$a;m=cb;l=hb;break;case qb:k=Za;m=db;l=ib;break;case pb:k=Ya;m=eb;l=jb;break;case ob:k=ab,m=fb,l=kb}d=k(new Date(a.a.start));for(k=0;d.valueOf()<=a.a.s;){var n=l(d),p=K(a.a,d),P=K(a.a,m(d));e(p,P,b,c,n,0===k%2?"even":"odd");k++}}E.prototype.J=function(){this.j.setAttribute("transform","translate(0 "+this.b.height+")");this.g.setAttribute("transform","translate(0 "+this.b.height+")");this.s=this.O+10+this.b.height;F(this.a)};
var lb=250;function y(a,b,c){this.c=D("g",{"class":"milestone"});this.b=c;this.index=b;this.g=[];this.restore(a)}y.prototype.restore=function(a){var b=this;u(function(){return Number.isInteger(a.project)});u(function(){return b.b.i[a.project]||0>a.project});this.name=a.name;this.a&&this.a.W(this);0<=a.project?this.a=this.b.i[a.project]:this.a=this.b.I;this.a.ca(this)};
function Wa(a){var b=M(a),c=b?C(b.o):null;return[-1===a.a.index?a.a.name:a.a.a.name,a.a.name,a.name,c,tb(b),b.w].map(function(a){return JSON.stringify(a)}).join(",")}
y.prototype.h=function(){this.c.innerHTML="";var a=M(this),b=this.j&&this.j.A===this.b.g?this.j:this.j=ub(this,this.b.g);if(a&&b&&this.b.a!==this.b.g){var c=b.x,d=a.x;var e=vb(-45,45,.1*(c-d));var k=4*e;D("path",{"class":"thick evenDashed brightPink noFill",d:"M"+c+" 0 C"+(c-k)+" "+(0+e)+" "+(d+k)+" "+(0+e)+" "+d+" 0"},this.c)}b&&this.c.appendChild(b.c);a&&this.c.appendChild(a.c)};function wb(a,b){u(function(){return b instanceof A});a.g.push(b)}
function xb(a,b){b.A===a.b.a&&(a.s=null);b.A===a.b.g&&(a.j=null);a.g=a.g.filter(function(a){return a!==b})}function yb(a){a.a.W(a);a.g.forEach(function(a){return Ta(a)});T(a.b.u,a)}function ub(a,b){return a.g.find(function(a){return a.A===b})}function M(a){return a.s&&a.s.A===a.b.a?a.s:a.s=ub(a,a.b.a)};function x(a,b,c){this.c=D("g",{"class":"project"},c.v[a.programme].c);this.b=c;this.height=0;this.u=[];this.index=b;this.s=this.B=this.K=0;this.restore(a)}f=x.prototype;f.restore=function(a){var b=this;u(function(){return"string"===typeof a.name});u(function(){return!a.comment||"string"===typeof a.comment});u(function(){return Number.isInteger(a.programme)});u(function(){return b.b.v[a.programme]});this.name=a.name;this.w=a.comment||"";this.a&&zb(this.a,this);this.a=this.b.v[a.programme];this.a.i.push(this)};
function ya(a){u(function(){return a.b.v[a.a.index]===a.a});return{name:a.name,programme:a.a.index,comment:a.w}}
f.h=function(){var a=this;this.c.innerHTML="";this.j=D("g",{},this.c);D("line",{x1:0,y1:0,x2:this.b.width,y2:0,"class":"projectLine"},this.j);var b=this.ga();this.u.forEach(function(b){return a.j.appendChild(b.c)});this.j.appendChild(b);b=D("g",{transform:"translate(20 0)"},this.j);this.g=new mb(I(this.b)-20,b);new N(this.name,{m:this.b.m,H:"Untitled",onchange:this.Fa.bind(this)},{"class":"projectHeader"},this.g.a);new N(this.w,{m:this.b.m,H:"...",onchange:this.Ea.bind(this)},{"class":"headingComment"},
this.g.a);this.g.b();this.g.c.addEventListener("verticalResize",this.Ca.bind(this));Ab(this);this.j.setAttribute("transform","translate(0 "+(this.height-20)+")");this.D=Bb(Q,this.b.m,[{icon:"icons/move-down.svg",action:this.Ga.bind(this)},{icon:"icons/move-up.svg",action:this.Ha.bind(this)},{icon:"icons/delete.svg",action:this.Da.bind(this)},{icon:"icons/plus.svg",action:this.ha.bind(this)}],{transform:"translate(0 "+(-20-this.g.height)+")"},b);return this.c};
f.ga=function(){var a=[],b=[],c=this.u.map(function(a){return M(a)}).filter(function(a){return a&&G(a)});c.sort(function(a,b){return b.x-a.x});c.forEach(function(c){var d=c.x,e=Cb("small sans-serif",c.l.name+"MMM 00: ")+15;e=d+e;var l=Cb("small italic sans-serif",c.w);l=0===l?0:l+15;for(var n=d+l,p=0;p<a.length&&(a[p]&&!(n<=a[p])||a[p+1]&&!(e<=a[p+1]));p++);a[p+1]=d;0!==l&&(a[p]=d);b[p]||(b[p]=D("g",{transform:"translate(0, "+-p*Db/2+")"}));b[p].appendChild(c.Z);c.P.innerHTML="";d=20-Db/2*p-40-20;
D("line",{x1:"0",y1:d,x2:"0",y2:0},c.P);D("circle",{cx:"0",cy:d,r:"2"},c.P)});this.s=b.length*Db/2;c=D("g",{transform:"translate(0 -20)"});for(var d=b.length-1;0<=d;d--)b[d]&&c.appendChild(b[d]);this.s+=40;return c};f.Ca=function(){var a=this.height;Ab(this);this.D&&this.D.setAttribute("transform","translate(0 "+(-20-this.g.height)+")");a!==this.height&&(this.j.setAttribute("transform","translate(0 "+(this.height-20)+")"),this.L())};function Ab(a){var b=a.g.height+15,c=a.s;a.height=b>c?b:c}
f.L=function(){var a=this.a;a.height=H(45,a.i);F(this.b)};f.ca=function(a){this.u.push(a)};f.W=function(a){this.u=this.u.filter(function(b){return b!==a})};f.Fa=function(a,b){this.name=b.text};f.Ea=function(a,b){this.w=b.text};function Eb(a){zb(a.a,a);a.u.forEach(function(a){return yb(a)});T(a.b.i,a)}
function Fb(a){u(function(){return 0===a.a.i.indexOf(a)});u(function(){return U(a.a.i)});var b=a.a.index;0>=b||(a.a.i.shift(),T(a.b.i,a),b--,a.a=a.b.v[b],u(function(){return U(a.a.i)}),b=a.a.i[a.a.i.length-1],a.a.i.push(a),b?Gb(a.b.i,a,b.index+1):Hb(a.b.i,a),u(function(){return U(a.b.i)}))}
function Ib(a){u(function(){return a.a.i.indexOf(a)===a.a.i.length-1});u(function(){return U(a.a.i)});var b=a.a.index;b>=a.b.v.length-1||(a.a.i.pop(),T(a.b.i,a),b++,a.a=a.b.v[b],u(function(){return U(a.a.i)}),b=a.a.i[0],a.a.i.unshift(a),b?Gb(a.b.i,a,b.index):Hb(a.b.i,a),u(function(){return U(a.b.i)}))}f.Da=function(){Eb(this);this.L()};
f.ha=function(){var a=La(this.b,{name:"New Milestone",project:this.index});L(this.b,{milestone:a.index,report:this.b.a.index,comment:"",status:Jb,date:Ia()}).h();a.h();this.h();this.L()};f.Ha=function(){var a=this;u(function(){return 0<=a.a.i.indexOf(a)});var b=this.a.i.indexOf(this);0===b?(b=this.a,Fb(this),b.h(),this.a.h(),F(this.b)):(b=this.a.i[b-1],Kb(this.b.i,b.index,this.index),Lb(this.a.i,this,b),this.L())};
f.Ga=function(){var a=this;u(function(){return 0<=a.a.i.indexOf(a)});var b=this.a.i.indexOf(this);b===this.a.i.length-1?(b=this.a,Ib(this),b.h(),this.a.h(),F(this.b)):(b=this.a.i[b+1],Kb(this.b.i,b.index,this.index),Lb(this.a.i,this,b),this.L())};function wa(a,b,c){this.c=D("g",{"class":"programme"});this.a=c;this.index=b;this.height=45;this.i=[];this.K=0;this.restore(a)}f=wa.prototype;f.restore=function(a){u(function(){return"string"===typeof a.name});u(function(){return!a.comment||"string"===typeof a.comment});this.name=a.name;this.w=a.comment||""};
f.h=function(){var a=this;this.c.innerHTML="";var b=D("g",{transform:"translate(0 40)"},this.c);Mb(this,b);Bb(R,this.a.m,[{icon:"icons/move-down.svg",action:this.Aa.bind(this)},{icon:"icons/move-up.svg",action:this.Ba.bind(this)},{icon:"icons/delete.svg",action:this.xa.bind(this)},{icon:"icons/plus.svg",action:this.Za.bind(this)}],{transform:"translate("+this.a.width+" -30)"},b);this.i.forEach(function(b){return a.c.appendChild(b.c)});this.height=H(45,this.i);return this.c};
function Mb(a,b){a.b=new mb(a.a.width-250,b);new N(a.name,{m:a.a.m,H:"Untitled",onchange:a.za.bind(a)},{"class":"programmeHeader"},a.b.a);new N(a.w,{m:a.a.m,H:"...",onchange:a.ya.bind(a)},{"class":"headingComment"},a.b.a);a.b.b()}
function Ea(a,b,c,d,e){var k=c,m=D("g",{"class":"programme"}),l=D("g",{transform:"translate(0 40)"},m);Mb(a,l);l=45;for(var n=[];c<a.i.length&&l<b;c++){var p=a.i[c];p.B=e;p.c.setAttribute("transform","translate(0, "+l+")");p.K=l+a.K;n.push(p);l+=p.height}if(l<b)return n.forEach(function(a){return m.appendChild(a.c)}),{c:m,S:b-l,index:a.i.length};if(0===n.length&&d)throw Error("Not enough room on page for programme headers.");if(1===n.length&&d)throw Error("Project: '"+n[0].name+"' is larger than a single page, and cannot be printed");
if(1>=n.length)return{c:D("g",{}),S:0,index:k};n.pop();n.forEach(function(a){return m.appendChild(a.c)});return{c:m,S:0,index:c-1}}function zb(a,b){a.i=a.i.filter(function(a){return a!==b})}f.za=function(a,b){this.name=b.text};f.ya=function(a,b){this.w=b.text};function Nb(a){a.i.forEach(function(a){return Eb(a)});T(a.a.v,a)}f.Za=function(){Ma(this.a,{name:"New Project",programme:this.index}).h();this.h();F(this.a)};
f.Ba=function(){var a=this;u(function(){return 0<=a.a.v.indexOf(a)});var b=this.a.v.indexOf(this);0!==b&&(Kb(this.a.v,this.a.v[b-1].index,this.index),F(this.a))};f.Aa=function(){var a=this;u(function(){return 0<=a.a.v.indexOf(a)});var b=this.a.v.indexOf(this);b!==this.a.v.length-1&&(Kb(this.a.v,this.a.v[b+1].index,this.index),F(this.a))};f.xa=function(){Nb(this);this.a.h()};function A(a,b,c){this.c=D("g",{"class":"msAtReport"});this.j=D("g",{"class":"businessMsLine"});this.$=D("g",{"class":"businessMsLine"});this.Z=D("g",{"class":"milestoneInfo"});this.P=D("g",{"class":"milestonePointer"});this.b=[];this.g=[];this.index=b;this.a=c;this.restore(a)}var Jb=1;f=A.prototype;
f.restore=function(a){var b=this;u(function(){return Number.isInteger(a.milestone)});u(function(){return b.a.u[a.milestone]});u(function(){return Number.isInteger(a.report)});u(function(){return b.a.b[a.report]});u(function(){return"string"===typeof a.comment});u(function(){return Number.isInteger(a.date)});u(function(){return Number.isInteger(a.status)});u(function(){return 0<=a.status&&4>=a.status});this.l&&xb(this.l,this);this.l=this.a.u[a.milestone];wb(this.l,this);this.A=this.a.b[a.report];this.w=
a.comment;this.status=a.status;this.o=Ja(a.date)};function za(a){u(function(){return a.a.b[a.A.index]===a.A});u(function(){return a.a.u[a.l.index]===a.l});return{milestone:a.l.index,report:a.A.index,comment:a.w,status:a.status,date:a.o}}
f.h=function(){this.c.innerHTML="";this.P.innerHTML="";this.x=K(this.a,this.o);this.c.setAttribute("transform","translate("+this.x+" 0)");if(G(this)){this.Z.innerHTML="";if(V(this)){var a=D("g",{transform:"translate("+this.x+" 0)"},this.Z);new Ob({m:this.a.m,aa:this.Ua.bind(this),parent:a,G:{"class":"milestoneData"}},this.l.name,this.o,this.w);Bb(Q,this.a.m,[{icon:"icons/health.svg",action:this.La.bind(this)},{icon:"icons/delete.svg",action:this.wa.bind(this)},{icon:"icons/arrow-right.svg",action:this.Ka.bind(this)}],
{transform:"translate(0, -75)"},a)}this.c.appendChild(this.P);V(this)&&-1===this.l.a.index&&G(this)&&this.c.appendChild(this.j);a=D("g",{},this.c);this.s=D("path",{"class":tb(this),d:"M -7 0L 0 7L 7 0L 0 -7 Z"},a);this.s.addEventListener("click",this.Oa.bind(this))}};f.F=function(){this.j.innerHTML="";this.$.innerHTML="";D("line",{x1:0,y1:0,x2:0,y2:"100%"},this.j);D("line",{x1:this.x,y1:0,x2:this.x,y2:"100%"},this.$);return this.j};
function tb(a){if(V(a))switch(a.status){case 0:return"complete";case Jb:return"on-track";case 2:return"at-risk";case 3:return"late"}else if(a.A===a.a.g)return"previous";u(function(){return!1})}function Ra(a){switch(a){case "complete":return 0;case "on-track":return Jb;case "at-risk":return 2;case "late":return 3;case "previous":return 4}u(function(){return!1})}function G(a){return(V(a)||a.A===a.a.g)&&Ka(a.a,a.o)}function V(a){return a.a.a===a.A}
function Pb(a){var b=a.l.a;return{x:a.x,y:b.a.K+b.K+b.height-20}}function Fa(a){var b=a.l.a;return{x:a.x,y:b.K+b.height-20}}function Qb(a){a=a.l.a;a.h();a.L()}f.R=function(a){u(function(){return a instanceof B});this.b.push(a)};function Rb(a,b){a.b=a.b.filter(function(a){return a!==b})}function Sb(a,b){u(function(){return b instanceof B});a.g.push(b)}function Tb(a,b){a.g=a.g.filter(function(a){return a!==b})}
f.Oa=function(){1===this.a.U?-1!==this.l.a.index&&V(this)&&this.a.R({report:this.a.a.index,dependency:this.a.ba,dependent:this.l.index}).h():this.A!==this.a.g||M(this.l)||(L(this.a,{milestone:this.l.index,report:this.a.a.index,comment:this.w,status:this.status,date:this.o}).h(),this.l.h(),Qb(this))};function Ta(a){xb(a.l,a);a.b.forEach(function(a){return a.j()});a.g.forEach(function(a){return a.j()});T(a.a.j,a)}
f.Ua=function(a){var b=this.a;this.o=vb(b.start,b.s,a.o);this.w=a.w;this.l.name=a.title;this.h();this.F();this.l.h();Qb(this)};f.La=function(){this.status=3<=this.status?0:this.status+1;this.s.setAttribute("class",tb(this))};f.wa=function(){Ta(this);0===this.l.g.length?yb(this.l):this.l.h();Qb(this)};f.Ka=function(){-1!==this.l.a.index&&(this.a.U=1,this.a.ba=this.l.index,this.a.V=!0)};function z(a,b,c){this.b=D("g",{"class":"reportLine"});this.j=D("g",{"class":"reportLine"});this.index=b;this.a=c;this.restore(a)}z.prototype.restore=function(a){this.o=a.date;this.name=a.name};
function nb(a,b,c){a.g=D("g",b,c);b=a===a.a.a?"Current:":"Baseline:";D("text",{"class":"reportHeader","text-anchor":"end"},a.g).textContent=b;b=D("g",{},a.g);new O({m:a.a.m,onchange:a.s.bind(a),parent:b,Y:R,G:{transform:"translate(0, 20)","class":"reportDate"}},a.o);b=D("g",{},a.g);new Ub(a.name,a.a.m,a.B.bind(a),b)}
z.prototype.F=function(){this.b.innerHTML="";this.j.innerHTML="";if(!Ka(this.a,this.o))return this.b;var a=K(this.a,this.o);D("line",{x1:a,y1:this.a.O.b.height+20,x2:a,y2:"100%"},this.b);D("line",{x1:a,y1:0,x2:a,y2:"100%"},this.j);return this.b};function Vb(a){a.a.j.filter(function(b){return b.A===a}).forEach(function(a){return Ta(a)});T(a.a.b,a);a.a.a=a.a.g}z.prototype.s=function(a,b){this.o=b.o;Ba(this.a);this.F()};z.prototype.B=function(a,b){this.name=b.text;Ba(this.a)};function B(a,b,c){this.c=D("g",{"class":"dependency"});this.c.addEventListener("dblclick",this.j.bind(this));this.index=b;this.g=c;this.restore(a)}
B.prototype.restore=function(a){var b=this;u(function(){return Number.isInteger(a.report)});u(function(){return b.g.b[a.report]});u(function(){return Number.isInteger(a.dependent)});u(function(){return b.g.u[a.dependent]});u(function(){return Number.isInteger(a.dependency)});u(function(){return b.g.u[a.dependency]});this.A=this.g.b[a.report];this.b&&Rb(this.b,this);this.b=ub(this.g.u[a.dependent],this.A);u(function(){return b.b});this.b.R(this);this.a&&Tb(this.a,this);this.a=ub(this.g.u[a.dependency],
this.A);u(function(){return b.a});Sb(this.a,this)};function Aa(a){u(function(){return a.g.j[a.a.index]===a.a});u(function(){return a.g.j[a.b.index]===a.b});u(function(){return a.g.u[a.a.l.index]===a.a.l});u(function(){return a.g.u[a.b.l.index]===a.b.l});return{dependent:a.b.l.index,dependency:a.a.l.index,report:a.A.index}}B.prototype.h=function(){this.c.innerHTML="";this.A===this.g.a&&G(this.b)&&G(this.a)&&this.F(Pb(this.a),Pb(this.b),this.c)};
B.prototype.F=function(a,b,c){if(this.a.o<=this.b.o)var d="dependencyLineOK",e="dependencyArrowOK";else d="dependencyLineLate",e="dependencyArrowLate";b.x-=7;Wb(a,b,d,c);Wb(a,b,"vthick transparentLine",c);D("path",{"class":e,d:"M -4 -4 L -4 4 L 0 0 Z",transform:"translate("+b.x+", "+b.y+")"},c)};var Xb=0;
function Ga(a,b,c,d){a.F(b,c,d);c=Wb(b,c,"transparentLine",d);Xb++;b="dependency"+Xb;c.setAttribute("id",b);c=D("text",{"class":"dependencyText"},d);D("textPath",{"xlink:href":"#"+b},c).textContent="\u00a0\u00a0\u00a0\u00a0"+a.b.l.name;d=D("text",{"text-anchor":"end","class":"dependencyText"},d);D("textPath",{"xlink:href":"#"+b,startOffset:"100%"},d).textContent=a.a.l.name+"\u00a0\u00a0\u00a0\u00a0"}B.prototype.j=function(){Tb(this.a,this);Rb(this.b,this);T(this.g.D,this);this.c.parentNode.removeChild(this.c)};function va(a){this.u=[];this.index=-1;this.name="Business Milestones";this.c=D("g",{"class":"businessMs"});this.g=D("g",{"class":"businessMs"});this.b=a;this.height=40;this.s=0}f=va.prototype;
f.h=function(){var a=this;this.c.innerHTML="";this.g.innerHTML="";var b=this.ja();this.height=this.s;var c=D("g",{transform:"translate(0 "+(this.height-20)+")"},this.c);D("line",{x1:0,y1:0,x2:this.b.width,y2:0,"class":"projectLine"},c);this.u.filter(function(a){return M(a)}).forEach(function(b){var d=M(b);u(function(){return d});d.F();c.appendChild(b.c);a.g.appendChild(d.$)});c.appendChild(b);b=D("g",{"class":"businessMsHeader",transform:"translate(0, -10)"},c);D("text",{},b).textContent="Business Milestones";
Bb(Q,this.b.m,[{icon:"icons/plus.svg",action:this.ka.bind(this)}],{transform:"translate(180, -7)"},b);return this.c};f.ja=x.prototype.ga;f.L=function(){F(this.b)};f.ca=function(a){this.u.push(a)};f.W=function(a){this.u=this.u.filter(function(b){return b!==a})};f.ka=x.prototype.ha;function Ob(a,b,c,d){this.m=a.m;this.aa=a.aa||function(){};this.parent=a.parent;this.G=a.G||{};this.a=!1;this.restore(b,c,d);this.h()}var Db=35;f=Ob.prototype;f.restore=function(a,b,c){this.title=a;this.title=""===this.title?"Untitled":this.title;this.o=b;this.w=c;this.w=""===this.w?"":this.w};f.h=function(){this.c=Yb(this.va.bind(this),this.ua.bind(this),this.m,this.G,this.parent)};
f.ua=function(a){a.innerHTML="";a=D("foreignObject",{width:315,height:45,x:5,y:-55},a);var b=W("input",{"class":"svgDateBox",value:C(this.o),type:"date",required:""},a);b.addEventListener("change",this.ta.bind(this,b));b=W("input",{"class":"svgTextBox",value:this.title,type:"text",placeholder:"Milestone Name"},a);b.addEventListener("change",this.Xa.bind(this,b));a=W("input",{"class":"svgCommentBox",value:this.w,type:"text",placeholder:"Milestone Comment"},a);a.addEventListener("change",this.sa.bind(this,
a))};f.va=function(a){this.a&&(this.aa(this),this.a=!1);a.innerHTML="";var b=new Date(this.o);b=ib(b)+" "+gb(b)+": ";D("text",{"text-anchor":"start",transform:"translate(5, -15)"},a).textContent=Zb(b+this.title,100);D("text",{"class":"msComment",transform:"translate(5, 0)"},a).textContent=Zb(this.w,100)};f.Xa=function(a){this.restore(a.value,this.o,this.w);this.a=!0};f.sa=function(a){this.restore(this.title,this.o,a.value);this.a=!0};f.ta=function(a){this.o=$b(a);this.a=!0};function h(){var a=document.getElementById("app");a.innerHTML="";this.c=W("div",{"class":"milestoneMapContainer"},a);this.parent=a;this.b=new ac;this.ia()}h.prototype.g=function(){var a=this,b=JSON.stringify(xa(this.map),null,"\t");this.a.textContent="Saving...";bc(this.b,function(b){b?a.a.textContent="Saved as: "+b.name:a.a.textContent="Error saving file"},this.map.name,b)};
h.prototype.download=function(){var a=JSON.stringify(xa(this.map),null,"\t");cc(this.map.name+".json",a,"application/json",this.c)};h.prototype.restore=function(a){this.map=new v(a)};
h.prototype.h=function(){var a=this;this.c.innerHTML="";this.a=W("div",{"class":"console"},this.c);var b=W("div",{"class":"menubar"},this.c),c=X("File",b);Y([{icon:"icons/new.svg",action:this.ia.bind(this),C:function(){return a.a.textContent="New file"}},{icon:"icons/open.svg",action:this.Ra.bind(this),C:function(){return a.a.textContent="Open file from Google Drive"}},{icon:"icons/save.svg",action:this.g.bind(this),C:function(){return a.a.textContent="Save file to google drive"}},{icon:"icons/download.svg",
action:this.download.bind(this),C:function(){return a.a.textContent="Download file"}},{icon:"icons/upload.svg",action:this.cb.bind(this),C:function(){return a.a.textContent="Upload file"}},{icon:"icons/exportCSV.svg",action:this.Pa.bind(this),C:function(){return a.a.textContent="Download snapshot as CSV"}},{icon:"icons/import.svg",action:this.Qa.bind(this),C:function(){return a.a.textContent="Import CSV snapshot"}}],c.body);c=X("Programme",b);Y([{icon:"icons/plus.svg",action:this.map.Ya.bind(this.map),
C:function(){return a.a.textContent="New programme"}}],c.body);c=X("Comparison",b);Y([{icon:"icons/camera.svg",action:this.$a.bind(this),C:function(){return a.a.textContent="New snapshot"}},{icon:"icons/delete.svg",action:this.Na.bind(this),C:function(){return a.a.textContent="Delete snapshot"}}],c.body);Ba(this.map);c.body.appendChild(this.map.ea);c=X("Print",b);Y([{icon:"icons/print.svg",action:this.qa.bind(this),C:function(){return a.a.textContent="Print"}}],c.body);dc(this,c.body);b=X("About",
b);Y([{icon:"icons/info.svg",action:function(){return alert('Milestone Map, Version: 1.3.2\u03b2\n\nFor help and support, please visit:\n\nhttps://andymac-2.github.io/milestoneMap/instructions\n\nCopyright 2018 Andrew Pritchard\n\nLicensed under the Apache License, Version 2.0 (the "License");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an "AS IS" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n')},
C:function(){return a.a.textContent="About"}},{icon:"icons/question.svg",action:function(){return window.open("https://andymac-2.github.io/milestoneMap/instructions")},C:function(){return a.a.textContent="Help"}}],b.body);w("div",{"class":"menuBarPlaceholder"},this.c);this.c.appendChild(this.map.J);this.map.h()};
var ec=[{height:1682,width:2378},{height:1189,width:1682},{height:841,width:1189},{height:594,width:841},{height:420,width:594},{height:297,width:420},{height:210,width:297},{width:1682,height:2378},{width:1189,height:1682},{width:841,height:1189},{width:594,height:841},{width:420,height:594},{width:297,height:420},{width:210,height:297}].map(function(a){return a.width>a.height?{height:a.height-70,width:a.width-70}:a}),sa=ec[5],fc="4A0 Landscape;2A0 Landscape;A0 Landscape;A1 Landscape;A2 Landscape;A3 Landscape;A4 Landscape;4A0 Portrait;2A0 Portrait;A0 Portrait;A1 Portrait;A2 Portrait;A3 Portrait;A4 Portrait".split(";");
function dc(a,b){Ca("Page Size:",function(b){a.map.B=ec[b.currentTarget.value]},fc,{"class":"pageSizeSelector"},b)}f=h.prototype;f.$a=function(){Oa(this.map);this.h()};f.Na=function(){1>=this.map.b.length||(Vb(this.map.a),this.h())};
f.ia=function(){this.b.b=null;var a=Ia(),b=a-5184E6,c=new Date(b);c=c.setUTCFullYear(c.getUTCFullYear()+1).valueOf();this.map=new v({name:"New Map",start:b,end:c,programmes:[],projects:[],milestones:[],msAtReports:[],reports:[{name:"Baseline",date:a}],dependencies:[],currReport:0,cmpReport:0});this.h()};f.Ra=function(){var a=this;gc(this.b,function(b){try{a.restore(b),a.h()}catch(c){throw alert("Error: Invalid file."),c;}})};
f.cb=function(){var a=this;hc(this.c,function(b){try{a.restore(JSON.parse(b)),a.h()}catch(c){throw alert("Error: Invalid file."),c;}},".json")};
f.Qa=function(){var a=this;hc(this.c,function(b){try{var c=[],d=!1,e,k,m;for(m=k=e=0;e<b.length;e++){var l=b[e],n=b[e+1];c[m]=c[m]||[];c[m][k]=c[m][k]||"";'"'==l&&d&&'"'==n?(c[m][k]+=l,++e):'"'==l?d=!d:","!=l||d?"\r"!=l||"\n"!=n||d?"\n"!=l||d?"\r"!=l||d?c[m][k]+=l:(++m,k=0):(++m,k=0):(++m,k=0,++e):++k}0===c[c.length-1].length&&c.pop();Sa(a.map,c);a.h()}catch(p){throw alert(p.name+": "+p.message),p;}},".csv")};f.Pa=function(){var a=Va(this.map);cc(this.map.name+".csv",a,"text/csv",this.c)};
f.qa=function(){var a=new v(xa(this.map),this.map.B);try{Da(a),this.parent.innerHTML=a.X.innerHTML,window.print(),this.parent.innerHTML="",this.parent.appendChild(this.c)}catch(b){throw alert(b.name+": "+b.message),b;}};var Q=1,R=2;function Wb(a,b,c,d){return D("path",{"class":c,d:"M"+a.x+" "+a.y+" C"+(a.x+150)+" "+a.y+" "+(b.x-150)+" "+b.y+" "+b.x+" "+b.y},d)};function H(a,b){b.forEach(function(b){b.c.setAttribute("transform","translate(0, "+a+")");b.K=a;a+=b.height});return a}function ic(a){a=a.getCTM();return{x:a.e,y:a.f}}var jc=void 0;function Yb(a,b,c,d,e){d=D("g",d,e);return kc(d,a,b,c,e)}function kc(a,b,c,d,e){function k(){b(a);e.contains(a)&&e.addEventListener("click",m)}function m(){c(a);e.removeEventListener("click",m);e.contains(a)&&ua(d,e,k)}k();return a}function Cb(a,b){lc.font=a;return lc.measureText(b).width}var lc=document.createElement("canvas").getContext("2d");function mc(a,b,c){c=D("g",{"class":"menu"},c);switch(a){case 0:var d=45*(b.length+1)/-2;break;case Q:d=-22.5;break;case R:d=-(45*(b.length+1))}for(a=0;a<b.length;a++){d+=45;var e=D("g",{transform:"translate("+d+", 0)","class":"menuEntry"},c);e.addEventListener("click",b[a].action);b[a].C&&e.addEventListener("mouseover",b[a].C);D("circle",{"class":"iconCircle",r:"14"},e);D("image",{x:"-8",y:"-8",height:"16",width:"16"},e).setAttributeNS("http://www.w3.org/1999/xlink","href",b[a].icon)}return c}
function Bb(a,b,c,d,e){return Yb(function(a){return a.innerHTML=""},function(b){b.innerHTML="";mc(a,c,b)},b,d,e)}function X(a,b){b=w("span",{"class":"menuBarSegment"},b);w("div",{"class":"menuBarHeader"},b).textContent=a;a=w("div",{"class":"menuBarContent"},b);return{c:b,body:a}}function Y(a,b){b=w("span",{},b);b=D("svg",{width:45*a.length,height:40},b);mc(Q,a,b).setAttribute("transform","translate (0, 20)")}
function Ca(a,b,c,d,e){d=w("span",d,e);w("div",{"class":"dropdownSegmentHeading"},d).textContent=a;a=w("select",{"class":"dropdownSegmentDropdown"},d);a.addEventListener("change",b);w("option",{selected:"",disabled:"",hidden:""},a).textContent="Please choose:";for(b=0;b<c.length;b++)w("option",{value:b},a).textContent=c[b]};function mb(a,b){this.width=a;this.height=0;this.c=D("g",{},b);this.g=D("foreignObject",{width:this.width},this.c);this.a=w("div",{style:"width:"+this.width+"px;max-width:"+this.width+"px;"},this.g);this.a.addEventListener("input",this.b.bind(this))}
mb.prototype.b=function(){var a=this.a;document.contains(a)?a=a.offsetHeight:(jc||(jc=w("div",{style:"position:absolute;visibility:hidden;"},document.body)),a=a.cloneNode(!0),jc.appendChild(a),a=a.offsetHeight,jc.innerHTML="");a+=8;this.height!==a&&(this.height=a,this.g.setAttribute("height",this.height),this.g.setAttribute("y",-this.height),a=new CustomEvent("verticalResize",{detail:this}),this.c.dispatchEvent(a))};
function N(a,b,c,d){var e=this;this.m=b.m;this.H=b.H;this.parent=d;this.onchange=b.onchange||function(){};c.contenteditable="true";this.c=w("p",c,d);this.c.addEventListener("input",this.la.bind(this,this.c));this.c.addEventListener("input",function(a){return e.onchange(a,e)});this.c.addEventListener("focus",this.ab.bind(this));this.restore(a);this.h()}f=N.prototype;f.restore=function(a){this.text=a?a:this.H};f.h=function(){kc(this.c,this.bb.bind(this),this.Ja.bind(this),this.m,this.parent)};
f.bb=function(){this.c.textContent=this.text||this.H;this.c.classList.remove("clickedActive");this.c.classList.add("notClickedActive")};f.Ja=function(){this.c.textContent=this.text;this.c.classList.add("clickedActive");this.c.classList.remove("notClickedActive")};f.ab=function(){var a=this.c,b=document.createRange();b.selectNodeContents(a);a=window.getSelection();a.removeAllRanges();a.addRange(b)};f.la=function(a){this.restore(a.textContent)};function w(a,b,c){a=document.createElement(a);if(b)for(var d in b)a.setAttribute(d,b[d]);c&&c.appendChild(a);return a}function nc(a,b,c,d){a=document.createElementNS(a,b);if(c)for(var e in c)a.setAttribute(e,c[e]);d&&d.appendChild(a);return a}var D=nc.bind(null,"http://www.w3.org/2000/svg"),W=nc.bind(null,"http://www.w3.org/1999/xhtml");function Ub(a,b,c,d){var e=Q;this.H="Untitled";switch(e){case Q:this.a="start";break;case 0:this.a="middle";break;default:u(function(){return!1})}this.m=b;this.onchange=c;this.parent=d;this.G={transform:"translate(5, 20)","class":"reportName"};this.restore(a);this.h()}f=Ub.prototype;f.restore=function(a){this.text=a;this.text=""===this.text?this.H:this.text};f.h=function(){this.c=Yb(this.oa.bind(this),this.na.bind(this),this.m,this.G,this.parent)};
f.na=function(a){var b=this,c=a.getBoundingClientRect().height;a.innerHTML="";var d=10*c,e="middle"===this.a?d/-2:0,k=ic(a),m=-k.x;k=-k.y;a=D("foreignObject",{width:d,height:1.4*c,transform:"translate("+m+", "+k+")",x:e-m,y:0-c-k},a);a=w("input",{"class":"svgTextBox",type:"text",value:this.text},a);a.focus();a.select();a.addEventListener("change",this.ma.bind(this,a));a.addEventListener("change",function(a){return b.onchange(a,b)})};
f.oa=function(a){a.innerHTML="";D("text",{"text-anchor":this.a},a).textContent=Zb(this.text,40)};f.ma=function(a){this.restore(a.value)};function O(a,b){switch(a.Y){case Q:this.a="start";break;case R:this.a="end";break;default:u(function(){return!1})}this.m=a.m;this.onchange=a.onchange||function(){};this.parent=a.parent;this.G=a.G||{};this.min=a.min||null;this.max=a.max||null;this.restore(b);this.h()}O.prototype.restore=function(a){this.o=a};O.prototype.h=function(){this.c=Yb(this.g.bind(this),this.b.bind(this),this.m,this.G,this.parent)};
O.prototype.b=function(a){var b=this,c=a.getBoundingClientRect().height;a.innerHTML="";var d=10*c;a=D("foreignObject",{width:d,height:1.5*c,x:"start"===this.a?0:-d,y:0-c},a);c={"class":"svgDateBox",value:C(this.o),type:"date",required:""};this.min&&(c.min=C(this.min));this.max&&(c.max=C(this.max));var e=W("input",c,a);e.focus();e.select();e.addEventListener("blur",function(a){""!==e.value&&(b.o=$b(e));b.onchange(a,b)})};
O.prototype.g=function(a){a.innerHTML="";D("text",{"text-anchor":this.a},a).textContent=C(this.o)};function ra(a){this.c=a;this.a=[];this.b=[];a.addEventListener("click",this.click.bind(this),!0)}function ua(a,b,c){a.a.push({c:b,event:c})}ra.prototype.click=function(a){for(var b=0;b<this.a.length;b++)for(;this.a[b]&&(!this.c.contains(this.a[b].c)||!this.a[b].c.parentNode.contains(a.target));)this.a[b].event(),this.a[b]=this.a[this.a.length-1],this.a.pop();for(b=0;b<this.b.length;b++)this.b[b].c.parentNode.contains(a.target)||this.b[b].event()};function vb(a,b,c){c=c>b?b:c;return c<a?a:c}function oc(a,b){for(var c=0;c<a.length-1;c++)if(0<=b(a[c],a[c+1]))return!1;return!0}function U(a){return oc(a,function(a,c){return a.index-c.index})}function Gb(a,b,c){u(function(){return c<=a.length});u(function(){return 0<=c});for(var d=a.length;d>c;d--)a[d]=a[d-1],a[d].index=d;a[c]=b;b.index=c}function Hb(a,b){b.index=a.length;a.push(b)}
function T(a,b){u(function(){return a[b.index]===b});for(var c=b.index;c<a.length-1;c++)a[c]=a[c+1],a[c].index=c;a.pop()}function Lb(a,b,c){u(function(){return 0<=a.indexOf(b)});u(function(){return 0<=a.indexOf(c)});var d=a.indexOf(b),e=a.indexOf(c),k=a[d];a[d]=a[e];a[e]=k}function Kb(a,b,c){u(function(){return a[b].index===b});u(function(){return a[c].index===c});var d=a[b];a[b]=a[c];a[c]=d;a[b].index=b;a[c].index=c}function C(a){return(new Date(a)).toISOString().slice(0,10)}
function $b(a){return(new Date(a.value+"T00:00:00.000Z")).valueOf()+1}function Ja(a){return a-a%864E5+1}function cc(a,b,c,d){var e=w("a",{style:"display:none;"},d);e.href="download"in e?URL.createObjectURL(new Blob([b],{type:c})):"data:application/octet-stream,"+encodeURIComponent(b);e.download=a;e.click();d.removeChild(e)}
function hc(a,b,c){var d={type:"file",style:"display:none;"};c&&(d.accept=c);var e=w("input",d,a),k=new FileReader;k.onload=function(){b(k.result);a.contains(e)&&a.removeChild(e)};e.addEventListener("change",function(){k.readAsText(e.files[0])});e.click()}function Zb(a,b){return a.length>b-3?a.slice(0,b-3)+"...":a}function ta(a){var b=window,c=200;c=c||100;var d;b.addEventListener("resize",function(){d&&window.clearTimeout(d);d=setTimeout(a,c)})};function pc(a){for(var b=[],c=0;c<arguments.length;++c)b[c]=arguments[c];return b.reduce(qc)}function qc(a,b){return function(c,d){for(var e=[],k=1;k<arguments.length;++k)e[k-1]=arguments[k];a.apply(null,[function(a){for(var d=[],e=0;e<arguments.length;++e)d[e]=arguments[e];return b.apply(null,[c].concat(d instanceof Array?d:oa(na(d))))}].concat(e instanceof Array?e:oa(na(e))))}}
function ac(){var a=this;this.g=["https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"];this.a=!1;this.b=null;window.gapi.load("client:auth2:picker",function(){return rc(a)})}function rc(a){window.gapi.client.init({apiKey:"AIzaSyCYeIi5ThOCg1tPdy52ALudL_W-E_aipzo",clientId:"899992407737-pdogm033l5v7tb2j8n2g5n4hpo3r4ftd.apps.googleusercontent.com",discoveryDocs:a.g,scope:"https://www.googleapis.com/auth/drive.file"}).then(function(){a.a=!0})}
function Z(){return window.gapi.auth2.getAuthInstance().isSignedIn.get()}function sc(a,b,c,d){a.a&&(Z()?tc(a,b,c,d):pc(function(b){return uc(a,b)},function(b){return tc(a,b,c,d)})(b))}function bc(a,b,c,d){a.a&&(null===a.b?sc(a,b,c,d):Z()?vc(a,b,d):pc(function(b){return uc(a,b)},function(b){return vc(a,b,d)})(b))}function gc(a,b){if(a.a){var c=pc(function(b){return wc(a,b)},function(b,c){return xc(a,b,c)});Z()?c(b):pc(function(b){return uc(a,b)},function(a){return c(a)})(b)}}
function wc(a,b){u(function(){return!0===a.a});u(function(){return Z()});var c=window.google.picker.ViewId.DOCS;(new window.google.picker.PickerBuilder).addView(c).setOAuthToken(window.gapi.auth2.getAuthInstance().currentUser.get().getAuthResponse().access_token).setDeveloperKey("AIzaSyCYeIi5ThOCg1tPdy52ALudL_W-E_aipzo").setCallback(b).build().setVisible(!0)}
function uc(a,b){u(function(){return!0===a.a});b=b||function(){};window.gapi.auth2.getAuthInstance().signIn({scope:"https://www.googleapis.com/auth/drive.file"}).then(function(a){(a=a.getAuthResponse())&&!a.error&&b()}).catch(function(a){console.error(a)})}
function xc(a,b,c){u(function(){return!0===a.a});u(function(){return Z()});var d=window.google.picker.Response.DOCUMENTS,e=window.google.picker.Document.ID;if(c[window.google.picker.Response.ACTION]==window.google.picker.Action.PICKED){var k=c[d][0][e];window.gapi.client.drive.files.get({fileId:k,alt:"media"}).execute(function(c){a.b=k;b(c)})}}
function tc(a,b,c,d){u(function(){return!0===a.a});u(function(){return Z()});c="\r\n---------10897387501935781034\r\nContent-Type: application/json\r\n\r\n"+JSON.stringify({name:c+".json",mimeType:"application/json"})+"\r\n---------10897387501935781034\r\nContent-Type: application/json\r\n\r\n"+d+"\r\n---------10897387501935781034--";window.gapi.client.request({path:"/upload/drive/v3/files",method:"POST",params:{uploadType:"multipart"},headers:{"Content-Type":'multipart/related; boundary="-------10897387501935781034"'},
body:c}).execute(b)}function vc(a,b,c){u(function(){return!0===a.a});u(function(){return null!==a.b});u(function(){return Z()});console.log(a.b);window.gapi.client.request({path:"/upload/drive/v3/files/"+a.b,method:"PATCH",params:{uploadType:"media"},body:c}).execute(b)};}).call(this);
