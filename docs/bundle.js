(function(){var f,aa="function"==typeof Object.create?Object.create:function(a){function b(){}b.prototype=a;return new b},ba;if("function"==typeof Object.setPrototypeOf)ba=Object.setPrototypeOf;else{var ca;a:{var da={Ja:!0},ea={};try{ea.__proto__=da;ca=ea.Ja;break a}catch(a){}ca=!1}ba=ca?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null}
var fa=ba,ha="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)},g="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=global?global:this;function ia(){ia=function(){};g.Symbol||(g.Symbol=ja)}var ja=function(){var a=0;return function(b){return"jscomp_symbol_"+(b||"")+a++}}();
function ka(){ia();var a=g.Symbol.iterator;a||(a=g.Symbol.iterator=g.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&ha(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return la(this)}});ka=function(){}}function la(a){var b=0;return ma(function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}})}function ma(a){ka();a={next:a};a[g.Symbol.iterator]=function(){return this};return a}function na(a){ka();var b=a[Symbol.iterator];return b?b.call(a):la(a)}
function oa(a){for(var b,c=[];!(b=a.next()).done;)c.push(b.value);return c}function pa(a,b){if(b){var c=g;a=a.split(".");for(var d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&ha(c,a,{configurable:!0,writable:!0,value:b})}}pa("Number.isFinite",function(a){return a?a:function(a){return"number"!==typeof a?!1:!isNaN(a)&&Infinity!==a&&-Infinity!==a}});
pa("Number.isInteger",function(a){return a?a:function(a){return Number.isFinite(a)?a===Math.floor(a):!1}});pa("Array.prototype.find",function(a){return a?a:function(a,c){a:{var b=this;b instanceof String&&(b=String(b));for(var e=b.length,k=0;k<e;k++){var m=b[k];if(a.call(c,m,k,b)){a=m;break a}}a=void 0}return a}});window.onload=function(){new h};function q(a){a=Error.call(this,"Assertion failed : "+a);this.message=a.message;"stack"in a&&(this.stack=a.stack);this.name="AssertionError"}var r=Error;q.prototype=aa(r.prototype);q.prototype.constructor=q;if(fa)fa(q,r);else for(var t in r)if("prototype"!=t)if(Object.defineProperties){var qa=Object.getOwnPropertyDescriptor(r,t);qa&&Object.defineProperty(q,t,qa)}else q[t]=r[t];q.a=r.prototype;function u(a){if(!a())throw new q(a.toString());};function v(a,b){this.fa=w("span",{});this.K=w("div",{"class":"mMapContainer"});this.K.addEventListener("click",this.Na.bind(this));this.Y=w("span",{"class":"printablePages"});this.s=new ra(this.K);this.B=b||sa;this.V=0;this.ca=null;this.W=!1;this.restore(a)}f=v.prototype;
f.restore=function(a){var b=this;u(function(){return Number.isInteger(a.start)});u(function(){return Number.isInteger(a.end)});u(function(){return"string"===typeof a.name});this.start=a.start;this.o=a.end;this.name=a.name;this.I=new ta(this);this.v=a.programmes.map(function(a,d){return new ua(a,d,b)});this.i=a.projects.map(function(a,d){return new x(a,d,b)});this.u=a.milestones.map(function(a,d){return new y(a,d,b)});this.b=a.reports.map(function(a,d){return new z(a,d,b)});u(function(){return Number.isInteger(a.currReport)});
u(function(){return b.b[a.currReport]});u(function(){return Number.isInteger(a.cmpReport)});u(function(){return b.b[a.cmpReport]});this.a=this.b[a.currReport];this.g=this.b[a.cmpReport];this.j=a.msAtReports.map(function(a,d){return new A(a,d,b)});this.D=a.dependencies.map(function(a,d){return new B(a,d,b)})};
function va(a){return{name:a.name,end:a.o,start:a.start,currReport:a.a.index,cmpReport:a.g.index,reports:a.b.map(function(a){return{date:a.m,name:a.name}}),programmes:a.v.map(function(a){return{name:a.name,comment:a.w}}),projects:a.i.map(function(a){return wa(a)}),milestones:a.u.map(function(a){return{name:a.name,project:a.a.index}}),msAtReports:a.j.map(function(a){return xa(a)}),dependencies:a.D.map(function(a){return ya(a)})}}
function za(a){var b=a.fa;b.innerHTML="";var c={"class":"reportSelector"},d=a.b.sort(function(a,b){return a.m-b.m}).map(function(a){return a.name+": "+C(a.m)});Aa("Snapshot 1 (Current)",a.Ua.bind(a),d,c,b);Aa("Snapshot 2 (Baseline)",a.Ta.bind(a),d,c,b)}
f.h=function(){this.K.innerHTML="";this.U=D("svg",{"class":"mMapFixed"},this.K);this.ga=w("div",{"class":"mMapScrollBox"},this.K);this.N=D("svg",{"class":"milestoneMap",height:5E3},this.ga);var a=D("g",{"class":"bg"},this.N);this.ea=D("g",{"class":"dependencies"},this.N);var b=D("g",{"class":"fg"},this.N);this.width=this.N.getBoundingClientRect().width;this.P=new E(this,this.U,a);this.j.forEach(function(a){return a.h()});this.u.forEach(function(a){return a.h()});this.i.forEach(function(a){return a.h()});
this.U.appendChild(this.I.h());a.appendChild(this.I.g);this.v.forEach(function(a){return b.appendChild(a.h())});this.U.appendChild(this.a.F());b.appendChild(this.a.j);F(this)};f.O=5;
function Ba(a){a.Y.innerHTML="";a.width=a.B.width*v.prototype.O;a.height=a.B.height*v.prototype.O;a.j.forEach(function(a){return a.h()});a.u.forEach(function(a){return a.h()});a.i.forEach(function(a){return a.h()});a.v.forEach(function(a){return a.h()});var b=a.I.h(),c=0,d=0,e=0,k=[];do{var m=D("svg",{"class":"milestoneMapPage",viewbox:"0 0 "+a.B.width*v.prototype.O+" "+a.B.height*v.prototype.O},a.Y);a.P=new E(a,m);var l=a.P.o,n=b.cloneNode(!0);n.setAttribute("transform","translate(0, "+l+")");m.appendChild(n);
l+=a.I.height;n=a.B.height*v.prototype.O-l;if(0>=n)throw Error("Page size not large enough for Business Milestones.");if(c>=a.v.length){m.appendChild(a.a.F().cloneNode(!0));break}var p=D("g",{"class":"dependencies"},m);k.push(p);p=!0;do{var P=a.v[c];P.L=l;var J=Ca(P,n,d,p,e);p=!1;m.appendChild(J.c);J.c.setAttribute("transform","translate(0, "+l+")");if(J.index===P.i.length)c++,d=0,l+=n-J.T,n=J.T;else{d=J.index;break}}while(c<a.v.length);l=a.a.F();m.appendChild(l.cloneNode(!0));e++}while(c<a.v.length);
a.D.forEach(function(a){if(a.A===a.g.a&&G(a.b)&&G(a.a)){var b=Da(a.a),c=Da(a.b);c.x-=7;var d=a.b.l.a.B,e=a.a.l.a.B;if(d===e){var l=D("g",{"class":"dependency"},k[d]);a.F(b,c,l)}else{var m=a.g.B.height*v.prototype.O;d>e?(l=c.y+m,m=b.y-m):(l=c.y-m,m=b.y+m);e=D("g",{"class":"dependency"},k[e]);d=D("g",{"class":"dependency"},k[d]);Ea(a,b,{x:c.x,y:l},e);Ea(a,{x:b.x,y:m},c,d)}}})}function Fa(a){a.D.forEach(function(b){b.h();a.ea.appendChild(b.c)})}f.Na=function(){this.W?this.W=!1:(this.V=0,this.ca=null)};
function F(a){var b=H(a.P.o,[a.I]);a.U.setAttribute("height",b);b=a.qa-b;250<b&&(a.ga.setAttribute("style","max-height:"+b+"px;"),b-=4);var c=H(30,a.v);c=Math.max(c,b);a.N.setAttribute("height",c);a.a.F();Fa(a)}function I(a){a=.2*a.width;return 350>a?a:350}function K(a,b){return(b.valueOf()-a.start)/(a.o-a.start)*(a.width-I(a))+I(a)}function Ga(){var a=new Date(Date.now());return Ha(a.valueOf()-6E4*a.getTimezoneOffset())}function Ia(a,b){return b>=a.start&&b<=a.o}
function L(a,b){b=new A(b,a.j.length,a);a.j.push(b);return b}f.S=function(a){a=new B(a,this.D.length,this);this.D.push(a);this.ea.appendChild(a.c);return a};function Ja(a,b){b=new y(b,a.u.length,a);a.u.push(b);return b}function Ka(a,b){b=new x(b,a.i.length,a);a.i.push(b);return b}function La(a,b){b=new ua(b,a.v.length,a);a.v.push(b);return b}
function Ma(a){var b=new z({name:"New Report",date:Ga()},a.b.length,a);a.b.push(b);a.j.filter(function(b){return b.A===a.a}).forEach(function(c){c=xa(c);c.report=b.index;L(a,c)});a.D.filter(function(b){return b.A===a.a}).forEach(function(c){c=ya(c);c.report=b.index;a.S(c)});a.g=a.a;a.a=b}
function Na(a){for(var b=1;b<a.length;b++){var c=a[b];if(6!==c.length&&5!==c.length)throw Error("CSV row "+(b+1)+" does not contain the correct number of columns");var d=c[4];if("complete"!==d&&"on-track"!==d&&"at-risk"!==d&&"late"!==d&&"previous"!==d)throw Error("Milestone health on row "+(b+1)+" is invalid.Must be one of 'complete', 'on-track', 'at-risk', 'late', or 'previous'");if(isNaN((new Date(c[3]+"T00:00:00.000Z")).valueOf()+1))throw Error("Invalid date format on row "+(b+1)+". The Date must be formatted as YYYY-MM-DD");
}}function Oa(a,b){var c=b[0],d=b[1],e=b[2],k=b[3],m=b[4];b=b[5]||"";if("Business Milestones"!==c){var l=a.v.find(function(a){return a.name===c});l||(l=La(a,{name:c}));var n=l.i.find(function(a){return a.name===d});n||(n=Ka(a,{name:d,programme:l.index}))}else n=a.I;(l=n.u.find(function(a){return a.name===e}))||(l=Ja(a,{name:e,project:n.index}));n=M(l);k={milestone:l.index,report:a.a.index,comment:b,status:Pa(m),date:(new Date(k+"T00:00:00.000Z")).valueOf()+1};n?n.restore(k):L(a,k)}
function Qa(a,b){Na(b);a.j.filter(function(b){return b.A===a.a}).forEach(function(a){return Ra(a)});for(var c=1;c<b.length;c++)Oa(a,b[c])}f.Za=function(){La(this,{name:"New Programme"});this.h()};var Sa="Programme Name;Project Name;Milestone Name;Date (YYYY-MM-DD);Health ('complete', 'on-track', 'at-risk', 'late', or 'previous);Comment".split(";").map(function(a){return JSON.stringify(a)}).join(",");
function Ta(a){a=a.u.filter(function(a){return M(a)}).map(function(a){return Ua(a)}).join("\n");return Sa+"\n"+a}f=v.prototype;f.sa=function(a,b){this.name=b.text};f.Xa=function(a,b){b.m<=this.o&&(this.start=b.m);this.h()};f.Wa=function(a,b){b.m>=this.start&&(this.o=b.m);this.h()};f.Ua=function(a){a=a.currentTarget.value;0<=a&&a<this.b.length&&(this.a=this.b[a]);this.h()};f.Ta=function(a){a=a.currentTarget.value;0<=a&&a<this.b.length&&(this.g=this.b[a]);this.h()};function E(a,b,c){this.c=D("g",{"class":"dateHeader"},b);this.g=D("g",{},this.c);this.j=D("g",{},this.c);this.I=D("g",{"class":"dateHeader"},c);this.a=a;this.h()}function Va(a){a.setUTCHours(0,0,0,0);return a}function Wa(a){a.setUTCMonth(0,1);a.setUTCHours(0,0,0,0);return a}function Xa(a){a.setUTCDate(1);a.setUTCHours(0,0,0,0);return a}function Ya(a){a.setUTCDate(a.getUTCDate()-(a.getUTCDay()-1)%7);return a}function Za(a){var b=a.getUTCFullYear();a.setUTCFullYear(b-b%10);Wa(a);return a}
function $a(a){a.setUTCDate(a.getUTCDate()+1);return a}function ab(a){a.setUTCDate(a.getUTCDate()+7);return a}function bb(a){a.setUTCMonth(a.getUTCMonth()+1);return a}function cb(a){a.setUTCFullYear(a.getUTCFullYear()+1);return a}function db(a){a.setUTCFullYear(a.getUTCFullYear()+10);return a}function eb(a){return a.getUTCDate()}
function fb(a){var b=3-(a.getUTCDay()-1)%7,c=new Date(a.valueOf());Va(c);c.setUTCDate(a.getUTCDate()+b);return""+Math.ceil((c.valueOf()-(new Date(c.getUTCFullYear(),0,1)).valueOf())/6048E5)}function gb(a){return"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ")[a.getUTCMonth()]}function hb(a){return""+a.getUTCFullYear()}function ib(a){a=a.getUTCFullYear();return""+(a-a%10)+"'s"}
E.prototype.h=function(){this.g.innerHTML="";var a=D("g",{transform:"translate("+(jb+60)+" 0)"},this.j);this.b=new kb(this.a.width-2*jb-120,a);new N(this.a.name,{s:this.a.s,H:"Untitled",onchange:this.a.sa.bind(this.a)},{"class":"mMapTitle"},this.b.a);this.b.b();this.j.setAttribute("transform","translate(0 "+this.b.height+")");this.b.c.addEventListener("verticalResize",this.K.bind(this));this.j.setAttribute("transform","translate(0 "+this.b.height+")");this.g.setAttribute("transform","translate(0 "+
this.b.height+")");a=D("g",{},this.j);new O({s:this.a.s,onchange:this.a.Xa.bind(this.a),parent:a,max:this.a.o-1728E5,Z:Q,G:{transform:"translate(10 -5)","class":"mMapEdgeDate"}},this.a.start);a=D("g",{},this.j);new O({s:this.a.s,onchange:this.a.Wa.bind(this.a),parent:a,min:this.a.start+1728E5,Z:R,G:{transform:"translate("+(this.a.width-10)+" -5)","class":"mMapEdgeDate"}},this.a.o);lb(this.a.a,{transform:"translate("+(this.a.width-jb)+", -5)"},this.j);this.a.a!==this.a.g&&lb(this.a.g,{transform:"translate("+
jb+", -5)"},this.j);a=[];var b=this.a.o-this.a.start,c=b/this.a.width;189216E6<b&&a.push(mb);18144E6<b&&a.push(nb);1728E6<b&&8928E4>c&&a.push(ob);3024E4>c&&a.push(pb);432E4>c&&a.push(qb);b=20;for(c=0;c<a.length-2;c++)S(this,b,20,a[c],this.B.bind(this)),b+=20;1<a.length?(S(this,b,"100%",a[a.length-2],this.B.bind(this)),S(this,b,"100%",a[a.length-2],this.D.bind(this)),b+=20,S(this,b,20,a[a.length-1],this.N.bind(this))):(S(this,b,"100%",a[0],this.B.bind(this)),S(this,b,"100%",a[0],this.D.bind(this)));
this.P=this.o=b+20;this.o+=10+this.b.height;D("rect",{x:0,y:0,width:I(this.a),height:"100%","class":"whiteBackground"},this.g);D("rect",{x:0,y:0,width:I(this.a),height:"100%","class":"whiteBackground"},this.I)};E.prototype.D=function(a,b,c,d,e,k){D("rect",{"class":k,height:"100%",y:"0",x:a,width:b-a},this.I)};E.prototype.B=function(a,b,c,d,e,k){D("rect",{"class":k,height:d,y:c,x:a,width:b-a},this.g);D("text",{"class":"majorRowText",y:c+15,x:(a+b)/2,"text-anchor":"middle"},this.g).textContent=e};
E.prototype.N=function(a,b,c,d,e){D("line",{"class":"dateHeaderSeparator",x1:a,y1:c+3,x2:a,y2:c+d-3},this.g);D("text",{"class":"minorRowText",y:c+15,x:(a+b)/2,"text-anchor":"middle"},this.g).textContent=e};var qb=0,pb=1,ob=2,nb=3,mb=4;
function S(a,b,c,d,e){switch(d){case qb:var k=Va,m=$a,l=eb;break;case pb:k=Ya;m=ab;l=fb;break;case ob:k=Xa;m=bb;l=gb;break;case nb:k=Wa;m=cb;l=hb;break;case mb:k=Za,m=db,l=ib}d=k(new Date(a.a.start));for(k=0;d.valueOf()<=a.a.o;){var n=l(d),p=K(a.a,d),P=K(a.a,m(d));e(p,P,b,c,n,0===k%2?"even":"odd");k++}}E.prototype.K=function(){this.j.setAttribute("transform","translate(0 "+this.b.height+")");this.g.setAttribute("transform","translate(0 "+this.b.height+")");this.o=this.P+10+this.b.height;F(this.a)};
var jb=250;function y(a,b,c){this.c=D("g",{"class":"milestone"});this.b=c;this.index=b;this.g=[];this.restore(a)}y.prototype.restore=function(a){var b=this;u(function(){return Number.isInteger(a.project)});u(function(){return b.b.i[a.project]||0>a.project});this.name=a.name;this.a&&this.a.X(this);0<=a.project?this.a=this.b.i[a.project]:this.a=this.b.I;this.a.da(this)};
function Ua(a){var b=M(a),c=b?C(b.m):null;return[-1===a.a.index?a.a.name:a.a.a.name,a.a.name,a.name,c,rb(b),b.w].map(function(a){return JSON.stringify(a)}).join(",")}
y.prototype.h=function(){this.c.innerHTML="";var a=M(this),b=this.j&&this.j.A===this.b.g?this.j:this.j=sb(this,this.b.g);if(a&&b&&this.b.a!==this.b.g){var c=b.x,d=a.x;var e=tb(-45,45,.1*(c-d));var k=4*e;D("path",{"class":"thick evenDashed brightPink noFill",d:"M"+c+" 0 C"+(c-k)+" "+(0+e)+" "+(d+k)+" "+(0+e)+" "+d+" 0"},this.c)}b&&this.c.appendChild(b.c);a&&this.c.appendChild(a.c)};function ub(a,b){u(function(){return b instanceof A});a.g.push(b)}
function vb(a,b){b.A===a.b.a&&(a.o=null);b.A===a.b.g&&(a.j=null);a.g=a.g.filter(function(a){return a!==b})}function wb(a){a.a.X(a);a.g.forEach(function(a){return Ra(a)});T(a.b.u,a)}function sb(a,b){return a.g.find(function(a){return a.A===b})}function M(a){return a.o&&a.o.A===a.b.a?a.o:a.o=sb(a,a.b.a)};function x(a,b,c){this.c=D("g",{"class":"project"},c.v[a.programme].c);this.b=c;this.height=0;this.u=[];this.index=b;this.o=this.B=this.L=0;this.restore(a)}f=x.prototype;f.restore=function(a){var b=this;u(function(){return"string"===typeof a.name});u(function(){return!a.comment||"string"===typeof a.comment});u(function(){return Number.isInteger(a.programme)});u(function(){return b.b.v[a.programme]});this.name=a.name;this.w=a.comment||"";this.a&&xb(this.a,this);this.a=this.b.v[a.programme];this.a.i.push(this)};
function wa(a){u(function(){return a.b.v[a.a.index]===a.a});return{name:a.name,programme:a.a.index,comment:a.w}}
f.h=function(){var a=this;this.c.innerHTML="";this.j=D("g",{},this.c);D("line",{x1:0,y1:0,x2:this.b.width,y2:0,"class":"projectLine"},this.j);var b=this.ha();this.u.forEach(function(b){return a.j.appendChild(b.c)});this.j.appendChild(b);b=D("g",{transform:"translate(20 0)"},this.j);this.g=new kb(I(this.b)-20,b);new N(this.name,{s:this.b.s,H:"Untitled",onchange:this.Ga.bind(this)},{"class":"projectHeader"},this.g.a);new N(this.w,{s:this.b.s,H:"...",onchange:this.Fa.bind(this)},{"class":"headingComment"},
this.g.a);this.g.b();this.g.c.addEventListener("verticalResize",this.Da.bind(this));yb(this);this.j.setAttribute("transform","translate(0 "+(this.height-20)+")");this.D=zb(Q,this.b.s,[{icon:"icons/move-down.svg",action:this.Ha.bind(this)},{icon:"icons/move-up.svg",action:this.Ia.bind(this)},{icon:"icons/delete.svg",action:this.Ea.bind(this)},{icon:"icons/plus.svg",action:this.ia.bind(this)}],{transform:"translate(0 "+(-20-this.g.height)+")"},b);return this.c};
f.ha=function(){var a=[],b=[],c=this.u.map(function(a){return M(a)}).filter(function(a){return a&&G(a)});c.sort(function(a,b){return b.x-a.x});c.forEach(function(c){var d=c.x,e=Ab("small sans-serif",c.l.name+"MMM 00: ")+15;e=d+e;var l=Ab("small italic sans-serif",c.w);l=0===l?0:l+15;for(var n=d+l,p=0;p<a.length&&(a[p]&&!(n<=a[p])||a[p+1]&&!(e<=a[p+1]));p++);a[p+1]=d;0!==l&&(a[p]=d);b[p]||(b[p]=D("g",{transform:"translate(0, "+-p*Bb/2+")"}));b[p].appendChild(c.$);c.R.innerHTML="";d=20-Bb/2*p-40-20;
D("line",{x1:"0",y1:d,x2:"0",y2:0},c.R);D("circle",{cx:"0",cy:d,r:"2"},c.R)});this.o=b.length*Bb/2;c=D("g",{transform:"translate(0 -20)"});for(var d=b.length-1;0<=d;d--)b[d]&&c.appendChild(b[d]);this.o+=40;return c};f.Da=function(){var a=this.height;yb(this);this.D&&this.D.setAttribute("transform","translate(0 "+(-20-this.g.height)+")");a!==this.height&&(this.j.setAttribute("transform","translate(0 "+(this.height-20)+")"),this.M())};function yb(a){var b=a.g.height+15,c=a.o;a.height=b>c?b:c}
f.M=function(){var a=this.a;a.height=H(45,a.i);F(this.b)};f.da=function(a){this.u.push(a)};f.X=function(a){this.u=this.u.filter(function(b){return b!==a})};f.Ga=function(a,b){this.name=b.text};f.Fa=function(a,b){this.w=b.text};function Cb(a){xb(a.a,a);a.u.forEach(function(a){return wb(a)});T(a.b.i,a)}
function Db(a){u(function(){return 0===a.a.i.indexOf(a)});u(function(){return U(a.a.i)});var b=a.a.index;0>=b||(a.a.i.shift(),T(a.b.i,a),b--,a.a=a.b.v[b],u(function(){return U(a.a.i)}),b=a.a.i[a.a.i.length-1],a.a.i.push(a),b?Eb(a.b.i,a,b.index+1):Fb(a.b.i,a),u(function(){return U(a.b.i)}))}
function Gb(a){u(function(){return a.a.i.indexOf(a)===a.a.i.length-1});u(function(){return U(a.a.i)});var b=a.a.index;b>=a.b.v.length-1||(a.a.i.pop(),T(a.b.i,a),b++,a.a=a.b.v[b],u(function(){return U(a.a.i)}),b=a.a.i[0],a.a.i.unshift(a),b?Eb(a.b.i,a,b.index):Fb(a.b.i,a),u(function(){return U(a.b.i)}))}f.Ea=function(){Cb(this);this.M()};
f.ia=function(){var a=Ja(this.b,{name:"New Milestone",project:this.index});L(this.b,{milestone:a.index,report:this.b.a.index,comment:"",status:Hb,date:Ga()}).h();a.h();this.h();this.M()};f.Ia=function(){var a=this;u(function(){return 0<=a.a.i.indexOf(a)});var b=this.a.i.indexOf(this);0===b?(b=this.a,Db(this),b.h(),this.a.h(),F(this.b)):(b=this.a.i[b-1],Ib(this.b.i,b.index,this.index),Jb(this.a.i,this,b),this.M())};
f.Ha=function(){var a=this;u(function(){return 0<=a.a.i.indexOf(a)});var b=this.a.i.indexOf(this);b===this.a.i.length-1?(b=this.a,Gb(this),b.h(),this.a.h(),F(this.b)):(b=this.a.i[b+1],Ib(this.b.i,b.index,this.index),Jb(this.a.i,this,b),this.M())};function ua(a,b,c){this.c=D("g",{"class":"programme"});this.a=c;this.index=b;this.height=45;this.i=[];this.L=0;this.restore(a)}f=ua.prototype;f.restore=function(a){u(function(){return"string"===typeof a.name});u(function(){return!a.comment||"string"===typeof a.comment});this.name=a.name;this.w=a.comment||""};
f.h=function(){var a=this;this.c.innerHTML="";var b=D("g",{transform:"translate(0 40)"},this.c);Kb(this,b);zb(R,this.a.s,[{icon:"icons/move-down.svg",action:this.Ba.bind(this)},{icon:"icons/move-up.svg",action:this.Ca.bind(this)},{icon:"icons/delete.svg",action:this.ya.bind(this)},{icon:"icons/plus.svg",action:this.$a.bind(this)}],{transform:"translate("+this.a.width+" -30)"},b);this.i.forEach(function(b){return a.c.appendChild(b.c)});this.height=H(45,this.i);return this.c};
function Kb(a,b){a.b=new kb(a.a.width-250,b);new N(a.name,{s:a.a.s,H:"Untitled",onchange:a.Aa.bind(a)},{"class":"programmeHeader"},a.b.a);new N(a.w,{s:a.a.s,H:"...",onchange:a.za.bind(a)},{"class":"headingComment"},a.b.a);a.b.b()}
function Ca(a,b,c,d,e){var k=c,m=D("g",{"class":"programme"}),l=D("g",{transform:"translate(0 40)"},m);Kb(a,l);l=45;for(var n=[];c<a.i.length&&l<b;c++){var p=a.i[c];p.B=e;p.c.setAttribute("transform","translate(0, "+l+")");p.L=l+a.L;n.push(p);l+=p.height}if(l<b)return n.forEach(function(a){return m.appendChild(a.c)}),{c:m,T:b-l,index:a.i.length};if(0===n.length&&d)throw Error("Not enough room on page for programme headers.");if(1===n.length&&d)throw Error("Project: '"+n[0].name+"' is larger than a single page, and cannot be printed");
if(1>=n.length)return{c:D("g",{}),T:0,index:k};n.pop();n.forEach(function(a){return m.appendChild(a.c)});return{c:m,T:0,index:c-1}}function xb(a,b){a.i=a.i.filter(function(a){return a!==b})}f.Aa=function(a,b){this.name=b.text};f.za=function(a,b){this.w=b.text};function Lb(a){a.i.forEach(function(a){return Cb(a)});T(a.a.v,a)}f.$a=function(){Ka(this.a,{name:"New Project",programme:this.index}).h();this.h();F(this.a)};
f.Ca=function(){var a=this;u(function(){return 0<=a.a.v.indexOf(a)});var b=this.a.v.indexOf(this);0!==b&&(Ib(this.a.v,this.a.v[b-1].index,this.index),F(this.a))};f.Ba=function(){var a=this;u(function(){return 0<=a.a.v.indexOf(a)});var b=this.a.v.indexOf(this);b!==this.a.v.length-1&&(Ib(this.a.v,this.a.v[b+1].index,this.index),F(this.a))};f.ya=function(){Lb(this);this.a.h()};function A(a,b,c){this.c=D("g",{"class":"msAtReport"});this.j=D("g",{"class":"businessMsLine"});this.aa=D("g",{"class":"businessMsLine"});this.$=D("g",{"class":"milestoneInfo"});this.R=D("g",{"class":"milestonePointer"});this.b=[];this.g=[];this.index=b;this.a=c;this.restore(a)}var Hb=1;f=A.prototype;
f.restore=function(a){var b=this;u(function(){return Number.isInteger(a.milestone)});u(function(){return b.a.u[a.milestone]});u(function(){return Number.isInteger(a.report)});u(function(){return b.a.b[a.report]});u(function(){return"string"===typeof a.comment});u(function(){return Number.isInteger(a.date)});u(function(){return Number.isInteger(a.status)});u(function(){return 0<=a.status&&4>=a.status});this.l&&vb(this.l,this);this.l=this.a.u[a.milestone];ub(this.l,this);this.A=this.a.b[a.report];this.w=
a.comment;this.status=a.status;this.m=Ha(a.date)};function xa(a){u(function(){return a.a.b[a.A.index]===a.A});u(function(){return a.a.u[a.l.index]===a.l});return{milestone:a.l.index,report:a.A.index,comment:a.w,status:a.status,date:a.m}}
f.h=function(){this.c.innerHTML="";this.R.innerHTML="";this.x=K(this.a,this.m);this.c.setAttribute("transform","translate("+this.x+" 0)");if(G(this)){this.$.innerHTML="";if(V(this)){var a=D("g",{transform:"translate("+this.x+" 0)"},this.$);new Mb({s:this.a.s,ba:this.Va.bind(this),parent:a,G:{"class":"milestoneData"}},this.l.name,this.m,this.w);zb(Q,this.a.s,[{icon:"icons/health.svg",action:this.Ma.bind(this)},{icon:"icons/delete.svg",action:this.xa.bind(this)},{icon:"icons/arrow-right.svg",action:this.La.bind(this)}],
{transform:"translate(0, -75)"},a)}this.c.appendChild(this.R);V(this)&&-1===this.l.a.index&&G(this)&&this.c.appendChild(this.j);a=D("g",{},this.c);this.o=D("path",{"class":rb(this),d:"M -7 0L 0 7L 7 0L 0 -7 Z"},a);this.o.addEventListener("click",this.Pa.bind(this))}};f.F=function(){this.j.innerHTML="";this.aa.innerHTML="";D("line",{x1:0,y1:0,x2:0,y2:"100%"},this.j);D("line",{x1:this.x,y1:0,x2:this.x,y2:"100%"},this.aa);return this.j};
function rb(a){if(V(a))switch(a.status){case 0:return"complete";case Hb:return"on-track";case 2:return"at-risk";case 3:return"late"}else if(a.A===a.a.g)return"previous";u(function(){return!1})}function Pa(a){switch(a){case "complete":return 0;case "on-track":return Hb;case "at-risk":return 2;case "late":return 3;case "previous":return 4}u(function(){return!1})}function G(a){return(V(a)||a.A===a.a.g)&&Ia(a.a,a.m)}function V(a){return a.a.a===a.A}
function Nb(a){var b=a.l.a;return{x:a.x,y:b.a.L+b.L+b.height-20}}function Da(a){var b=a.l.a;return{x:a.x,y:b.L+b.height-20}}function Ob(a){a=a.l.a;a.h();a.M()}f.S=function(a){u(function(){return a instanceof B});this.b.push(a)};function Pb(a,b){a.b=a.b.filter(function(a){return a!==b})}function Qb(a,b){u(function(){return b instanceof B});a.g.push(b)}function Rb(a,b){a.g=a.g.filter(function(a){return a!==b})}
f.Pa=function(){1===this.a.V?-1!==this.l.a.index&&V(this)&&this.a.S({report:this.a.a.index,dependency:this.a.ca,dependent:this.l.index}).h():this.A!==this.a.g||M(this.l)||(L(this.a,{milestone:this.l.index,report:this.a.a.index,comment:this.w,status:this.status,date:this.m}).h(),this.l.h(),Ob(this))};function Ra(a){vb(a.l,a);a.b.forEach(function(a){return a.j()});a.g.forEach(function(a){return a.j()});T(a.a.j,a)}
f.Va=function(a){var b=this.a;this.m=tb(b.start,b.o,a.m);this.w=a.w;this.l.name=a.title;this.h();this.F();this.l.h();Ob(this)};f.Ma=function(){this.status=3<=this.status?0:this.status+1;this.o.setAttribute("class",rb(this))};f.xa=function(){Ra(this);0===this.l.g.length?wb(this.l):this.l.h();Ob(this)};f.La=function(){-1!==this.l.a.index&&(this.a.V=1,this.a.ca=this.l.index,this.a.W=!0)};function z(a,b,c){this.b=D("g",{"class":"reportLine"});this.j=D("g",{"class":"reportLine"});this.index=b;this.a=c;this.restore(a)}z.prototype.restore=function(a){this.m=a.date;this.name=a.name};
function lb(a,b,c){a.g=D("g",b,c);b=a===a.a.a?"Current:":"Baseline:";D("text",{"class":"reportHeader","text-anchor":"end"},a.g).textContent=b;b=D("g",{},a.g);new O({s:a.a.s,onchange:a.o.bind(a),parent:b,Z:R,G:{transform:"translate(0, 20)","class":"reportDate"}},a.m);b=D("g",{},a.g);new Sb(a.name,a.a.s,a.B.bind(a),b)}
z.prototype.F=function(){this.b.innerHTML="";this.j.innerHTML="";if(!Ia(this.a,this.m))return this.b;var a=K(this.a,this.m);D("line",{x1:a,y1:this.a.P.b.height+20,x2:a,y2:"100%"},this.b);D("line",{x1:a,y1:0,x2:a,y2:"100%"},this.j);return this.b};function Tb(a){a.a.j.filter(function(b){return b.A===a}).forEach(function(a){return Ra(a)});T(a.a.b,a);a.a.a=a.a.g}z.prototype.o=function(a,b){this.m=b.m;za(this.a);this.F()};z.prototype.B=function(a,b){this.name=b.text;za(this.a)};function B(a,b,c){this.c=D("g",{"class":"dependency"});this.c.addEventListener("dblclick",this.j.bind(this));this.index=b;this.g=c;this.restore(a)}
B.prototype.restore=function(a){var b=this;u(function(){return Number.isInteger(a.report)});u(function(){return b.g.b[a.report]});u(function(){return Number.isInteger(a.dependent)});u(function(){return b.g.u[a.dependent]});u(function(){return Number.isInteger(a.dependency)});u(function(){return b.g.u[a.dependency]});this.A=this.g.b[a.report];this.b&&Pb(this.b,this);this.b=sb(this.g.u[a.dependent],this.A);u(function(){return b.b});this.b.S(this);this.a&&Rb(this.a,this);this.a=sb(this.g.u[a.dependency],
this.A);u(function(){return b.a});Qb(this.a,this)};function ya(a){u(function(){return a.g.j[a.a.index]===a.a});u(function(){return a.g.j[a.b.index]===a.b});u(function(){return a.g.u[a.a.l.index]===a.a.l});u(function(){return a.g.u[a.b.l.index]===a.b.l});return{dependent:a.b.l.index,dependency:a.a.l.index,report:a.A.index}}B.prototype.h=function(){this.c.innerHTML="";this.A===this.g.a&&G(this.b)&&G(this.a)&&this.F(Nb(this.a),Nb(this.b),this.c)};
B.prototype.F=function(a,b,c){if(this.a.m<=this.b.m)var d="dependencyLineOK",e="dependencyArrowOK";else d="dependencyLineLate",e="dependencyArrowLate";b.x-=7;Ub(a,b,d,c);Ub(a,b,"vthick transparentLine",c);D("path",{"class":e,d:"M -4 -4 L -4 4 L 0 0 Z",transform:"translate("+b.x+", "+b.y+")"},c)};var Vb=0;
function Ea(a,b,c,d){a.F(b,c,d);c=Ub(b,c,"transparentLine",d);Vb++;b="dependency"+Vb;c.setAttribute("id",b);c=D("text",{"class":"dependencyText"},d);D("textPath",{"xlink:href":"#"+b},c).textContent="\u00a0\u00a0\u00a0\u00a0"+a.b.l.name;d=D("text",{"text-anchor":"end","class":"dependencyText"},d);D("textPath",{"xlink:href":"#"+b,startOffset:"100%"},d).textContent=a.a.l.name+"\u00a0\u00a0\u00a0\u00a0"}B.prototype.j=function(){Rb(this.a,this);Pb(this.b,this);T(this.g.D,this);this.c.parentNode.removeChild(this.c)};function ta(a){this.u=[];this.index=-1;this.name="Business Milestones";this.c=D("g",{"class":"businessMs"});this.g=D("g",{"class":"businessMs"});this.b=a;this.height=40;this.o=0}f=ta.prototype;
f.h=function(){var a=this;this.c.innerHTML="";this.g.innerHTML="";var b=this.ka();this.height=this.o;var c=D("g",{transform:"translate(0 "+(this.height-20)+")"},this.c);D("line",{x1:0,y1:0,x2:this.b.width,y2:0,"class":"projectLine"},c);this.u.filter(function(a){return M(a)}).forEach(function(b){var d=M(b);u(function(){return d});d.F();c.appendChild(b.c);a.g.appendChild(d.aa)});c.appendChild(b);b=D("g",{"class":"businessMsHeader",transform:"translate(0, -10)"},c);D("text",{},b).textContent="Business Milestones";
zb(Q,this.b.s,[{icon:"icons/plus.svg",action:this.la.bind(this)}],{transform:"translate(180, -7)"},b);return this.c};f.ka=x.prototype.ha;f.M=function(){F(this.b)};f.da=function(a){this.u.push(a)};f.X=function(a){this.u=this.u.filter(function(b){return b!==a})};f.la=x.prototype.ia;function Mb(a,b,c,d){this.s=a.s;this.ba=a.ba||function(){};this.parent=a.parent;this.G=a.G||{};this.a=!1;this.restore(b,c,d);this.h()}var Bb=35;f=Mb.prototype;f.restore=function(a,b,c){this.title=a;this.title=""===this.title?"Untitled":this.title;this.m=b;this.w=c;this.w=""===this.w?"":this.w};f.h=function(){this.c=Wb(this.wa.bind(this),this.va.bind(this),this.s,this.G,this.parent)};
f.va=function(a){a.innerHTML="";a=D("foreignObject",{width:315,height:45,x:5,y:-55},a);var b=W("input",{"class":"svgDateBox",value:C(this.m),type:"date",required:""},a);b.addEventListener("change",this.ua.bind(this,b));b=W("input",{"class":"svgTextBox",value:this.title,type:"text",placeholder:"Milestone Name"},a);b.addEventListener("change",this.Ya.bind(this,b));a=W("input",{"class":"svgCommentBox",value:this.w,type:"text",placeholder:"Milestone Comment"},a);a.addEventListener("change",this.ta.bind(this,
a))};f.wa=function(a){this.a&&(this.ba(this),this.a=!1);a.innerHTML="";var b=new Date(this.m);b=gb(b)+" "+eb(b)+": ";D("text",{"text-anchor":"start",transform:"translate(5, -15)"},a).textContent=Xb(b+this.title,100);D("text",{"class":"msComment",transform:"translate(5, 0)"},a).textContent=Xb(this.w,100)};f.Ya=function(a){this.restore(a.value,this.m,this.w);this.a=!0};f.ta=function(a){this.restore(this.title,this.m,a.value);this.a=!0};f.ua=function(a){this.m=Yb(a);this.a=!0};function h(){var a=document.getElementById("app");a.innerHTML="";this.c=W("div",{"class":"milestoneMapContainer"},a);this.parent=a;this.b=new Zb;$b(this.h.bind(this));this.ja()}h.prototype.g=function(){var a=this,b=JSON.stringify(va(this.map),null,"\t");this.a.textContent="Saving...";ac(this.b,function(b){b?a.a.textContent="Saved as: "+b.name:a.a.textContent="Error saving file"},this.map.name,b)};
h.prototype.download=function(){var a=JSON.stringify(va(this.map),null,"\t");bc(this.map.name+".json",a,"application/json",this.c)};h.prototype.restore=function(a){this.map=new v(a)};
h.prototype.h=function(){var a=this;this.c.innerHTML="";this.a=W("div",{"class":"console"},this.c);var b=W("div",{"class":"menubar"},this.c),c=X("File",b);Y([{icon:"icons/new.svg",action:this.ja.bind(this),C:function(){return a.a.textContent="New file"}},{icon:"icons/open.svg",action:this.Sa.bind(this),C:function(){return a.a.textContent="Open file from Google Drive"}},{icon:"icons/save.svg",action:this.g.bind(this),C:function(){return a.a.textContent="Save file to google drive"}},{icon:"icons/download.svg",
action:this.download.bind(this),C:function(){return a.a.textContent="Download file"}},{icon:"icons/upload.svg",action:this.eb.bind(this),C:function(){return a.a.textContent="Upload file"}},{icon:"icons/exportCSV.svg",action:this.Qa.bind(this),C:function(){return a.a.textContent="Download snapshot as CSV"}},{icon:"icons/import.svg",action:this.Ra.bind(this),C:function(){return a.a.textContent="Import CSV snapshot"}}],c.body);c=X("Programme",b);Y([{icon:"icons/plus.svg",action:this.map.Za.bind(this.map),
C:function(){return a.a.textContent="New programme"}}],c.body);c=X("Comparison",b);Y([{icon:"icons/camera.svg",action:this.ab.bind(this),C:function(){return a.a.textContent="New snapshot"}},{icon:"icons/delete.svg",action:this.Oa.bind(this),C:function(){return a.a.textContent="Delete snapshot"}}],c.body);za(this.map);c.body.appendChild(this.map.fa);c=X("Print",b);Y([{icon:"icons/print.svg",action:this.ra.bind(this),C:function(){return a.a.textContent="Print"}}],c.body);cc(this,c.body);c=X("About",
b);Y([{icon:"icons/info.svg",action:function(){return alert('Milestone Map, Version: 1.3.0\u03b2\n\nFor help and support, please visit:\n\nhttps://andymac-2.github.io/milestoneMap/instructions\n\n\n\nCopyright 2018 Andrew Pritchard\n\nLicensed under the Apache License, Version 2.0 (the "License");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an "AS IS" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n')},
C:function(){return a.a.textContent="About"}},{icon:"icons/question.svg",action:function(){return window.open("https://andymac-2.github.io/milestoneMap/instructions")},C:function(){return a.a.textContent="Help"}}],c.body);this.map.qa=window.innerHeight-b.getBoundingClientRect().height-5;this.c.appendChild(this.map.K);this.map.h()};
var dc=[{height:1682,width:2378},{height:1189,width:1682},{height:841,width:1189},{height:594,width:841},{height:420,width:594},{height:297,width:420},{height:210,width:297},{width:1682,height:2378},{width:1189,height:1682},{width:841,height:1189},{width:594,height:841},{width:420,height:594},{width:297,height:420},{width:210,height:297}].map(function(a){return a.width>a.height?{height:a.height-70,width:a.width-70}:a}),sa=dc[5],ec="4A0 Landscape;2A0 Landscape;A0 Landscape;A1 Landscape;A2 Landscape;A3 Landscape;A4 Landscape;4A0 Portrait;2A0 Portrait;A0 Portrait;A1 Portrait;A2 Portrait;A3 Portrait;A4 Portrait".split(";");
function cc(a,b){Aa("Page Size:",function(b){a.map.B=dc[b.currentTarget.value]},ec,{"class":"pageSizeSelector"},b)}f=h.prototype;f.ab=function(){Ma(this.map);this.h()};f.Oa=function(){1>=this.map.b.length||(Tb(this.map.a),this.h())};
f.ja=function(){this.b.b=null;var a=Ga(),b=a-5184E6,c=new Date(b);c=c.setUTCFullYear(c.getUTCFullYear()+1).valueOf();this.map=new v({name:"New Map",start:b,end:c,programmes:[],projects:[],milestones:[],msAtReports:[],reports:[{name:"Baseline",date:a}],dependencies:[],currReport:0,cmpReport:0});this.h()};f.Sa=function(){var a=this;fc(this.b,function(b){try{a.restore(b),a.h()}catch(c){throw alert("Error: Invalid file."),c;}})};
f.eb=function(){var a=this;gc(this.c,function(b){try{a.restore(JSON.parse(b)),a.h()}catch(c){throw alert("Error: Invalid file."),c;}},".json")};
f.Ra=function(){var a=this;gc(this.c,function(b){try{var c=[],d=!1,e,k,m;for(m=k=e=0;e<b.length;e++){var l=b[e],n=b[e+1];c[m]=c[m]||[];c[m][k]=c[m][k]||"";'"'==l&&d&&'"'==n?(c[m][k]+=l,++e):'"'==l?d=!d:","!=l||d?"\r"!=l||"\n"!=n||d?"\n"!=l||d?"\r"!=l||d?c[m][k]+=l:(++m,k=0):(++m,k=0):(++m,k=0,++e):++k}0===c[c.length-1].length&&c.pop();Qa(a.map,c);a.h()}catch(p){throw alert(p.name+": "+p.message),p;}},".csv")};f.Qa=function(){var a=Ta(this.map);bc(this.map.name+".csv",a,"text/csv",this.c)};
f.ra=function(){var a=new v(va(this.map),this.map.B);try{Ba(a),this.parent.innerHTML=a.Y.innerHTML,window.print(),this.parent.innerHTML="",this.parent.appendChild(this.c)}catch(b){throw alert(b.name+": "+b.message),b;}};var Q=1,R=2;function Ub(a,b,c,d){return D("path",{"class":c,d:"M"+a.x+" "+a.y+" C"+(a.x+150)+" "+a.y+" "+(b.x-150)+" "+b.y+" "+b.x+" "+b.y},d)};function H(a,b){b.forEach(function(b){b.c.setAttribute("transform","translate(0, "+a+")");b.L=a;a+=b.height});return a}function hc(a){a=a.getCTM();return{x:a.e,y:a.f}}var ic=void 0;function Wb(a,b,c,d,e){d=D("g",d,e);return jc(d,a,b,c,e)}function jc(a,b,c,d,e){function k(){b(a);e.contains(a)&&e.addEventListener("click",m)}function m(){c(a);e.removeEventListener("click",m);e.contains(a)&&d.J.push({c:e,event:k})}k();return a}function Ab(a,b){kc.font=a;return kc.measureText(b).width}var kc=document.createElement("canvas").getContext("2d");function lc(a,b,c){c=D("g",{"class":"menu"},c);switch(a){case 0:var d=45*(b.length+1)/-2;break;case Q:d=-22.5;break;case R:d=-(45*(b.length+1))}for(a=0;a<b.length;a++){d+=45;var e=D("g",{transform:"translate("+d+", 0)","class":"menuEntry"},c);e.addEventListener("click",b[a].action);b[a].C&&e.addEventListener("mouseover",b[a].C);D("circle",{"class":"iconCircle",r:"14"},e);D("image",{x:"-8",y:"-8",height:"16",width:"16"},e).setAttributeNS("http://www.w3.org/1999/xlink","href",b[a].icon)}return c}
function zb(a,b,c,d,e){return Wb(function(a){return a.innerHTML=""},function(b){b.innerHTML="";lc(a,c,b)},b,d,e)}function X(a,b){b=w("span",{"class":"menuBarSegment"},b);w("div",{"class":"menuBarHeader"},b).textContent=a;a=w("div",{"class":"menuBarContent"},b);return{c:b,body:a}}function Y(a,b){b=w("span",{},b);b=D("svg",{width:45*a.length,height:40},b);lc(Q,a,b).setAttribute("transform","translate (0, 20)")}
function Aa(a,b,c,d,e){d=w("span",d,e);w("div",{"class":"dropdownSegmentHeading"},d).textContent=a;a=w("select",{"class":"dropdownSegmentDropdown"},d);a.addEventListener("change",b);w("option",{selected:"",disabled:"",hidden:""},a).textContent="Please choose:";for(b=0;b<c.length;b++)w("option",{value:b},a).textContent=c[b]};function kb(a,b){this.width=a;this.height=0;this.c=D("g",{},b);this.g=D("foreignObject",{width:this.width},this.c);this.a=w("div",{style:"width:"+this.width+"px;max-width:"+this.width+"px;"},this.g);this.a.addEventListener("input",this.b.bind(this))}
kb.prototype.b=function(){var a=this.a;document.contains(a)?a=a.offsetHeight:(ic||(ic=w("div",{style:"position:absolute;visibility:hidden;"},document.body)),a=a.cloneNode(!0),ic.appendChild(a),a=a.offsetHeight,ic.innerHTML="");a+=8;this.height!==a&&(this.height=a,this.g.setAttribute("height",this.height),this.g.setAttribute("y",-this.height),a=new CustomEvent("verticalResize",{detail:this}),this.c.dispatchEvent(a))};
function N(a,b,c,d){var e=this;this.s=b.s;this.H=b.H;this.parent=d;this.onchange=b.onchange||function(){};c.contenteditable="true";this.c=w("p",c,d);this.c.addEventListener("input",this.ma.bind(this,this.c));this.c.addEventListener("input",function(a){return e.onchange(a,e)});this.c.addEventListener("focus",this.bb.bind(this));this.restore(a);this.h()}f=N.prototype;f.restore=function(a){this.text=a?a:this.H};f.h=function(){jc(this.c,this.cb.bind(this),this.Ka.bind(this),this.s,this.parent)};
f.cb=function(){this.c.textContent=this.text||this.H;this.c.classList.remove("clickedActive");this.c.classList.add("notClickedActive")};f.Ka=function(){this.c.textContent=this.text;this.c.classList.add("clickedActive");this.c.classList.remove("notClickedActive")};f.bb=function(){var a=this.c,b=document.createRange();b.selectNodeContents(a);a=window.getSelection();a.removeAllRanges();a.addRange(b)};f.ma=function(a){this.restore(a.textContent)};function w(a,b,c){a=document.createElement(a);if(b)for(var d in b)a.setAttribute(d,b[d]);c&&c.appendChild(a);return a}function mc(a,b,c,d){a=document.createElementNS(a,b);if(c)for(var e in c)a.setAttribute(e,c[e]);d&&d.appendChild(a);return a}var D=mc.bind(null,"http://www.w3.org/2000/svg"),W=mc.bind(null,"http://www.w3.org/1999/xhtml");function Sb(a,b,c,d){var e=Q;this.H="Untitled";switch(e){case Q:this.a="start";break;case 0:this.a="middle";break;default:u(function(){return!1})}this.s=b;this.onchange=c;this.parent=d;this.G={transform:"translate(5, 20)","class":"reportName"};this.restore(a);this.h()}f=Sb.prototype;f.restore=function(a){this.text=a;this.text=""===this.text?this.H:this.text};f.h=function(){this.c=Wb(this.pa.bind(this),this.oa.bind(this),this.s,this.G,this.parent)};
f.oa=function(a){var b=this,c=a.getBoundingClientRect().height;a.innerHTML="";var d=10*c,e="middle"===this.a?d/-2:0,k=hc(a),m=-k.x;k=-k.y;a=D("foreignObject",{width:d,height:1.4*c,transform:"translate("+m+", "+k+")",x:e-m,y:0-c-k},a);a=w("input",{"class":"svgTextBox",type:"text",value:this.text},a);a.focus();a.select();a.addEventListener("change",this.na.bind(this,a));a.addEventListener("change",function(a){return b.onchange(a,b)})};
f.pa=function(a){a.innerHTML="";D("text",{"text-anchor":this.a},a).textContent=Xb(this.text,40)};f.na=function(a){this.restore(a.value)};function O(a,b){switch(a.Z){case Q:this.a="start";break;case R:this.a="end";break;default:u(function(){return!1})}this.s=a.s;this.onchange=a.onchange||function(){};this.parent=a.parent;this.G=a.G||{};this.min=a.min||null;this.max=a.max||null;this.restore(b);this.h()}O.prototype.restore=function(a){this.m=a};O.prototype.h=function(){this.c=Wb(this.g.bind(this),this.b.bind(this),this.s,this.G,this.parent)};
O.prototype.b=function(a){var b=this,c=a.getBoundingClientRect().height;a.innerHTML="";var d=10*c;a=D("foreignObject",{width:d,height:1.5*c,x:"start"===this.a?0:-d,y:0-c},a);c={"class":"svgDateBox",value:C(this.m),type:"date",required:""};this.min&&(c.min=C(this.min));this.max&&(c.max=C(this.max));var e=W("input",c,a);e.focus();e.select();e.addEventListener("blur",function(a){""!==e.value&&(b.m=Yb(e));b.onchange(a,b)})};
O.prototype.g=function(a){a.innerHTML="";D("text",{"text-anchor":this.a},a).textContent=C(this.m)};function ra(a){this.c=a;this.J=[];this.a=[];a.addEventListener("click",this.click.bind(this),!0)}ra.prototype.click=function(a){for(var b=0;b<this.J.length;b++)for(;this.J[b]&&(!this.c.contains(this.J[b].c)||!this.J[b].c.parentNode.contains(a.target));)this.J[b].event(),this.J[b]=this.J[this.J.length-1],this.J.pop();for(b=0;b<this.a.length;b++)this.a[b].c.parentNode.contains(a.target)||this.a[b].event()};function tb(a,b,c){c=c>b?b:c;return c<a?a:c}function nc(a,b){for(var c=0;c<a.length-1;c++)if(0<=b(a[c],a[c+1]))return!1;return!0}function U(a){return nc(a,function(a,c){return a.index-c.index})}function Eb(a,b,c){u(function(){return c<=a.length});u(function(){return 0<=c});for(var d=a.length;d>c;d--)a[d]=a[d-1],a[d].index=d;a[c]=b;b.index=c}function Fb(a,b){b.index=a.length;a.push(b)}
function T(a,b){u(function(){return a[b.index]===b});for(var c=b.index;c<a.length-1;c++)a[c]=a[c+1],a[c].index=c;a.pop()}function Jb(a,b,c){u(function(){return 0<=a.indexOf(b)});u(function(){return 0<=a.indexOf(c)});var d=a.indexOf(b),e=a.indexOf(c),k=a[d];a[d]=a[e];a[e]=k}function Ib(a,b,c){u(function(){return a[b].index===b});u(function(){return a[c].index===c});var d=a[b];a[b]=a[c];a[c]=d;a[b].index=b;a[c].index=c}function C(a){return(new Date(a)).toISOString().slice(0,10)}
function Yb(a){return(new Date(a.value+"T00:00:00.000Z")).valueOf()+1}function Ha(a){return a-a%864E5+1}function bc(a,b,c,d){var e=w("a",{style:"display:none;"},d);e.href="download"in e?URL.createObjectURL(new Blob([b],{type:c})):"data:application/octet-stream,"+encodeURIComponent(b);e.download=a;e.click();d.removeChild(e)}
function gc(a,b,c){var d={type:"file",style:"display:none;"};c&&(d.accept=c);var e=w("input",d,a),k=new FileReader;k.onload=function(){b(k.result);a.contains(e)&&a.removeChild(e)};e.addEventListener("change",function(){k.readAsText(e.files[0])});e.click()}function Xb(a,b){return a.length>b-3?a.slice(0,b-3)+"...":a}function $b(a){var b=window,c=100;c=c||100;var d;b.addEventListener("resize",function(){d&&window.clearTimeout(d);d=setTimeout(a,c)})};function oc(a){for(var b=[],c=0;c<arguments.length;++c)b[c]=arguments[c];return b.reduce(pc)}function pc(a,b){return function(c,d){for(var e=[],k=1;k<arguments.length;++k)e[k-1]=arguments[k];a.apply(null,[function(a){for(var d=[],e=0;e<arguments.length;++e)d[e]=arguments[e];return b.apply(null,[c].concat(d instanceof Array?d:oa(na(d))))}].concat(e instanceof Array?e:oa(na(e))))}}
function Zb(){var a=this;this.g=["https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"];this.a=!1;this.b=null;window.gapi.load("client:auth2:picker",function(){return qc(a)})}function qc(a){window.gapi.client.init({apiKey:"AIzaSyCYeIi5ThOCg1tPdy52ALudL_W-E_aipzo",clientId:"899992407737-pdogm033l5v7tb2j8n2g5n4hpo3r4ftd.apps.googleusercontent.com",discoveryDocs:a.g,scope:"https://www.googleapis.com/auth/drive.file"}).then(function(){a.a=!0})}
function Z(){return window.gapi.auth2.getAuthInstance().isSignedIn.get()}function rc(a,b,c,d){a.a&&(Z()?sc(a,b,c,d):oc(function(b){return tc(a,b)},function(b){return sc(a,b,c,d)})(b))}function ac(a,b,c,d){a.a&&(null===a.b?rc(a,b,c,d):Z()?uc(a,b,d):oc(function(b){return tc(a,b)},function(b){return uc(a,b,d)})(b))}function fc(a,b){if(a.a){var c=oc(function(b){return vc(a,b)},function(b,c){return wc(a,b,c)});Z()?c(b):oc(function(b){return tc(a,b)},function(a){return c(a)})(b)}}
function vc(a,b){u(function(){return!0===a.a});u(function(){return Z()});var c=window.google.picker.ViewId.DOCS;(new window.google.picker.PickerBuilder).addView(c).setOAuthToken(window.gapi.auth2.getAuthInstance().currentUser.get().getAuthResponse().access_token).setDeveloperKey("AIzaSyCYeIi5ThOCg1tPdy52ALudL_W-E_aipzo").setCallback(b).build().setVisible(!0)}
function tc(a,b){u(function(){return!0===a.a});b=b||function(){};window.gapi.auth2.getAuthInstance().signIn({scope:"https://www.googleapis.com/auth/drive.file"}).then(function(a){(a=a.getAuthResponse())&&!a.error&&b()}).catch(function(a){console.error(a)})}
function wc(a,b,c){u(function(){return!0===a.a});u(function(){return Z()});var d=window.google.picker.Response.DOCUMENTS,e=window.google.picker.Document.ID;if(c[window.google.picker.Response.ACTION]==window.google.picker.Action.PICKED){var k=c[d][0][e];window.gapi.client.drive.files.get({fileId:k,alt:"media"}).execute(function(c){a.b=k;b(c)})}}
function sc(a,b,c,d){u(function(){return!0===a.a});u(function(){return Z()});c="\r\n---------10897387501935781034\r\nContent-Type: application/json\r\n\r\n"+JSON.stringify({name:c+".json",mimeType:"application/json"})+"\r\n---------10897387501935781034\r\nContent-Type: application/json\r\n\r\n"+d+"\r\n---------10897387501935781034--";window.gapi.client.request({path:"/upload/drive/v3/files",method:"POST",params:{uploadType:"multipart"},headers:{"Content-Type":'multipart/related; boundary="-------10897387501935781034"'},
body:c}).execute(b)}function uc(a,b,c){u(function(){return!0===a.a});u(function(){return null!==a.b});u(function(){return Z()});console.log(a.b);window.gapi.client.request({path:"/upload/drive/v3/files/"+a.b,method:"PATCH",params:{uploadType:"media"},body:c}).execute(b)};}).call(this);
