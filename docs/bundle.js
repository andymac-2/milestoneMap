(function(){var g,aa="function"==typeof Object.create?Object.create:function(a){function b(){}b.prototype=a;return new b},ba;if("function"==typeof Object.setPrototypeOf)ba=Object.setPrototypeOf;else{var ca;a:{var da={La:!0},ea={};try{ea.__proto__=da;ca=ea.La;break a}catch(a){}ca=!1}ba=ca?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null}
var fa=ba,ha="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)},h="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=global?global:this;function ia(){ia=function(){};h.Symbol||(h.Symbol=ja)}var ja=function(){var a=0;return function(b){return"jscomp_symbol_"+(b||"")+a++}}();
function ka(){ia();var a=h.Symbol.iterator;a||(a=h.Symbol.iterator=h.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&ha(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return la(this)}});ka=function(){}}function la(a){var b=0;return ma(function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}})}function ma(a){ka();a={next:a};a[h.Symbol.iterator]=function(){return this};return a}function na(a){ka();var b=a[Symbol.iterator];return b?b.call(a):la(a)}
function oa(a){for(var b,c=[];!(b=a.next()).done;)c.push(b.value);return c}function pa(a,b){if(b){var c=h;a=a.split(".");for(var d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&ha(c,a,{configurable:!0,writable:!0,value:b})}}pa("Number.isFinite",function(a){return a?a:function(a){return"number"!==typeof a?!1:!isNaN(a)&&Infinity!==a&&-Infinity!==a}});
pa("Number.isInteger",function(a){return a?a:function(a){return Number.isFinite(a)?a===Math.floor(a):!1}});pa("Array.prototype.find",function(a){return a?a:function(a,c){a:{var b=this;b instanceof String&&(b=String(b));for(var e=b.length,f=0;f<e;f++){var l=b[f];if(a.call(c,l,f,b)){a=l;break a}}a=void 0}return a}});window.onload=function(){new k};function q(a){a=Error.call(this,"Assertion failed : "+a);this.message=a.message;"stack"in a&&(this.stack=a.stack);this.name="AssertionError"}var r=Error;q.prototype=aa(r.prototype);q.prototype.constructor=q;if(fa)fa(q,r);else for(var t in r)if("prototype"!=t)if(Object.defineProperties){var qa=Object.getOwnPropertyDescriptor(r,t);qa&&Object.defineProperty(q,t,qa)}else q[t]=r[t];q.a=r.prototype;function u(a){if(!a())throw new q(a.toString());};function v(a,b){var c=this;this.ea=w("span",{});this.J=w("div",{"class":"mMapContainer"});this.J.addEventListener("click",this.Pa.bind(this));this.X=w("span",{"class":"printablePages"});this.o=new ra(this.J);this.w=b||sa;this.U=0;this.ba=null;this.V=!1;ta(function(){return ua(c)});this.restore(a)}g=v.prototype;
g.restore=function(a){var b=this;u(function(){return Number.isInteger(a.start)});u(function(){return Number.isInteger(a.end)});u(function(){return"string"===typeof a.name});this.start=a.start;this.l=a.end;this.name=a.name;this.D=new va(this);this.v=a.programmes.map(function(a,d){return new wa(a,d,b)});this.j=a.projects.map(function(a,d){return new x(a,d,b)});this.u=a.milestones.map(function(a,d){return new y(a,d,b)});this.b=a.reports.map(function(a,d){return new z(a,d,b)});u(function(){return Number.isInteger(a.currReport)});
u(function(){return b.b[a.currReport]});u(function(){return Number.isInteger(a.cmpReport)});u(function(){return b.b[a.cmpReport]});this.a=this.b[a.currReport];this.g=this.b[a.cmpReport];this.i=a.msAtReports.map(function(a,d){return new A(a,d,b)});this.C=a.dependencies.map(function(a,d){return new B(a,d,b)})};
function xa(a){return{name:a.name,end:a.l,start:a.start,currReport:a.a.index,cmpReport:a.g.index,reports:a.b.map(function(a){return{date:a.s,name:a.name}}),programmes:a.v.map(function(a){return{name:a.name,comment:a.A}}),projects:a.j.map(function(a){return ya(a)}),milestones:a.u.map(function(a){return{name:a.name,project:a.a.index}}),msAtReports:a.i.map(function(a){return za(a)}),dependencies:a.C.map(function(a){return Aa(a)})}}
function Ba(a){var b=a.ea;b.innerHTML="";var c={"class":"reportSelector"},d=a.b.sort(function(a,b){return a.s-b.s}).map(function(a){return a.name+": "+C(a.s)});Ca("Snapshot 1 (Current)",a.Va.bind(a),d,c,b);Ca("Snapshot 2 (Baseline)",a.Ua.bind(a),d,c,b)}
g.h=function(){this.J.innerHTML="";this.pa=window.innerHeight-60-18;this.T=D("svg",{"class":"mMapFixed"},this.J);this.fa=w("div",{"class":"mMapScrollBox"},this.J);this.M=D("svg",{"class":"milestoneMap",height:5E3},this.fa);var a=D("g",{"class":"bg"},this.M);this.da=D("g",{"class":"dependencies"},this.M);var b=D("g",{"class":"fg"},this.M);this.width=Math.max(1023,this.M.getBoundingClientRect().width);this.O=new E(this,this.T,a);this.i.forEach(function(a){return a.h()});this.u.forEach(function(a){return a.h()});
this.j.forEach(function(a){return a.h()});this.T.appendChild(this.D.h());a.appendChild(this.D.g);this.v.forEach(function(a){return b.appendChild(a.h())});this.T.appendChild(this.a.G());b.appendChild(this.a.i);F(this)};g.N=5;
function Da(a){a.X.innerHTML="";a.width=a.w.width*v.prototype.N;a.height=a.w.height*v.prototype.N;a.i.forEach(function(a){return a.h()});a.u.forEach(function(a){return a.h()});a.j.forEach(function(a){return a.h()});a.v.forEach(function(a){return a.h()});var b=a.D.h(),c=0,d=0,e=0,f=[];do{var l=D("svg",{"class":"milestoneMapPage",viewbox:"0 0 "+a.w.width*v.prototype.N+" "+a.w.height*v.prototype.N},a.X);a.O=new E(a,l);var m=a.O.l,n=b.cloneNode(!0);n.setAttribute("transform","translate(0, "+m+")");l.appendChild(n);
m+=a.D.height;n=a.w.height*v.prototype.N-m;if(0>=n)throw Error("Page size not large enough for Business Milestones.");if(c>=a.v.length){l.appendChild(a.a.G().cloneNode(!0));break}var p=D("g",{"class":"dependencies"},l);f.push(p);p=!0;do{var P=a.v[c];P.K=m;var I=Ea(P,n,d,p,e);p=!1;l.appendChild(I.c);I.c.setAttribute("transform","translate(0, "+m+")");if(I.index===P.j.length)c++,d=0,m+=n-I.S,n=I.S;else{d=I.index;break}}while(c<a.v.length);m=a.a.G();l.appendChild(m.cloneNode(!0));e++}while(c<a.v.length);
a.C.forEach(function(a){if(a.B===a.g.a&&G(a.b)&&G(a.a)){var b=Fa(a.a),c=Fa(a.b);c.x-=7;var d=a.b.m.a.w,e=a.a.m.a.w;if(d===e){var l=D("g",{"class":"dependency"},f[d]);a.G(b,c,l)}else{var m=a.g.w.height*v.prototype.N;d>e?(l=c.y+m,m=b.y-m):(l=c.y-m,m=b.y+m);e=D("g",{"class":"dependency"},f[e]);d=D("g",{"class":"dependency"},f[d]);Ga(a,b,{x:c.x,y:l},e);Ga(a,{x:b.x,y:m},c,d)}}})}function Ha(a){a.C.forEach(function(b){b.h();a.da.appendChild(b.c)})}g.Pa=function(){this.V?this.V=!1:(this.U=0,this.ba=null)};
function ua(a){var b=document.activeElement;"INPUT"===b.tagName||"true"===b.getAttribute("contenteditable")?Ia(a.o,b,function(){return ua(a)}):a.h()}function F(a){var b=H(a.O.l,[a.D]);a.T.setAttribute("height",b);b=a.pa-b;250<b&&a.fa.setAttribute("style","max-height:"+b+"px;");var c=H(30,a.v);c=Math.max(c,b);a.M.setAttribute("height",c);a.a.G();Ha(a)}function J(a){a=.2*a.width;return 350>a?a:350}function K(a,b){return(b.valueOf()-a.start)/(a.l-a.start)*(a.width-J(a))+J(a)}
function Ja(){var a=new Date(Date.now());return Ka(a.valueOf()-6E4*a.getTimezoneOffset())}function La(a,b){return b>=a.start&&b<=a.l}function Ma(a,b){b=new A(b,a.i.length,a);a.i.push(b);return b}g.R=function(a){a=new B(a,this.C.length,this);this.C.push(a);this.da.appendChild(a.c);return a};function Na(a,b){b=new y(b,a.u.length,a);a.u.push(b);return b}function Oa(a,b){b=new x(b,a.j.length,a);a.j.push(b);return b}function Pa(a,b){b=new wa(b,a.v.length,a);a.v.push(b);return b}
function Qa(a){var b=new z({name:"New Report",date:Ja()},a.b.length,a);a.b.push(b);a.i.filter(function(b){return b.B===a.a}).forEach(function(c){c=za(c);c.report=b.index;Ma(a,c)});a.C.filter(function(b){return b.B===a.a}).forEach(function(c){c=Aa(c);c.report=b.index;a.R(c)});a.g=a.a;a.a=b}
function Ra(a){for(var b=1;b<a.length;b++){var c=a[b];if(6!==c.length&&5!==c.length)throw Error("CSV row "+(b+1)+" does not contain the correct number of columns");var d=c[4];if("complete"!==d&&"on-track"!==d&&"at-risk"!==d&&"late"!==d&&"previous"!==d)throw Error("Milestone health on row "+(b+1)+" is invalid.Must be one of 'complete', 'on-track', 'at-risk', 'late', or 'previous'");if(isNaN((new Date(c[3]+"T00:00:00.000Z")).valueOf()+1))throw Error("Invalid date format on row "+(b+1)+". The Date must be formatted as YYYY-MM-DD");
}}function Sa(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],l=b[4];b=b[5]||"";if("Business Milestones"!==c){var m=a.v.find(function(a){return a.name===c});m||(m=Pa(a,{name:c}));var n=m.j.find(function(a){return a.name===d});n||(n=Oa(a,{name:d,programme:m.index}))}else n=a.D;(m=n.u.find(function(a){return a.name===e}))||(m=Na(a,{name:e,project:n.index}));n=L(m);f={milestone:m.index,report:a.a.index,comment:b,status:Ta(l),date:(new Date(f+"T00:00:00.000Z")).valueOf()+1};n?n.restore(f):Ma(a,f)}
function Ua(a,b){Ra(b);a.i.filter(function(b){return b.B===a.a}).forEach(function(a){return Va(a)});for(var c=1;c<b.length;c++)Sa(a,b[c])}g.$a=function(){Pa(this,{name:"New Programme"});this.h()};var Wa="Programme Name;Project Name;Milestone Name;Date (YYYY-MM-DD);Health ('complete', 'on-track', 'at-risk', 'late', or 'previous);Comment".split(";").map(function(a){return JSON.stringify(a)}).join(",");
function Xa(a){a=a.u.filter(function(a){return L(a)}).map(function(a){return Ya(a)}).join("\n");return Wa+"\n"+a}g=v.prototype;g.ua=function(a,b){this.name=b.text};g.Ya=function(a,b){b.s<=this.l&&(this.start=b.s);this.h()};g.Xa=function(a,b){b.s>=this.start&&(this.l=b.s);this.h()};g.Va=function(a){a=a.currentTarget.value;0<=a&&a<this.b.length&&(this.a=this.b[a]);this.h()};g.Ua=function(a){a=a.currentTarget.value;0<=a&&a<this.b.length&&(this.g=this.b[a]);this.h()};function E(a,b,c){this.c=D("g",{"class":"dateHeader"},b);this.g=D("g",{},this.c);this.i=D("g",{},this.c);this.D=D("g",{"class":"dateHeader"},c);this.a=a;this.h()}function Za(a){a.setUTCHours(0,0,0,0);return a}function $a(a){a.setUTCMonth(0,1);a.setUTCHours(0,0,0,0);return a}function ab(a){a.setUTCDate(1);a.setUTCHours(0,0,0,0);return a}function bb(a){a.setUTCDate(a.getUTCDate()-(a.getUTCDay()-1)%7);return a}function cb(a){var b=a.getUTCFullYear();a.setUTCFullYear(b-b%10);$a(a);return a}
function db(a){a.setUTCDate(a.getUTCDate()+1);return a}function eb(a){a.setUTCDate(a.getUTCDate()+7);return a}function fb(a){a.setUTCMonth(a.getUTCMonth()+1);return a}function gb(a){a.setUTCFullYear(a.getUTCFullYear()+1);return a}function hb(a){a.setUTCFullYear(a.getUTCFullYear()+10);return a}function ib(a){return a.getUTCDate()}
function jb(a){var b=3-(a.getUTCDay()-1)%7,c=new Date(a.valueOf());Za(c);c.setUTCDate(a.getUTCDate()+b);return""+Math.ceil((c.valueOf()-(new Date(c.getUTCFullYear(),0,1)).valueOf())/6048E5)}function kb(a){return"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ")[a.getUTCMonth()]}function lb(a){return""+a.getUTCFullYear()}function mb(a){a=a.getUTCFullYear();return""+(a-a%10)+"'s"}
E.prototype.h=function(){this.g.innerHTML="";var a=D("g",{transform:"translate("+(nb+60)+" 0)"},this.i);this.b=new ob(this.a.width-2*nb-120,a);new M(this.a.name,{o:this.a.o,I:"Untitled",onchange:this.a.ua.bind(this.a)},{"class":"mMapTitle"},this.b.a);this.b.b();this.i.setAttribute("transform","translate(0 "+this.b.height+")");this.b.c.addEventListener("verticalResize",this.J.bind(this));this.i.setAttribute("transform","translate(0 "+this.b.height+")");this.g.setAttribute("transform","translate(0 "+
this.b.height+")");a=D("g",{},this.i);new N({o:this.a.o,onchange:this.a.Ya.bind(this.a),parent:a,max:this.a.l-1728E5,Y:O,H:{transform:"translate(10 -5)","class":"mMapEdgeDate"}},this.a.start);a=D("g",{},this.i);new N({o:this.a.o,onchange:this.a.Xa.bind(this.a),parent:a,min:this.a.start+1728E5,Y:Q,H:{transform:"translate("+(this.a.width-10)+" -5)","class":"mMapEdgeDate"}},this.a.l);pb(this.a.a,{transform:"translate("+(this.a.width-nb)+", -5)"},this.i);this.a.a!==this.a.g&&pb(this.a.g,{transform:"translate("+
nb+", -5)"},this.i);a=[];var b=this.a.l-this.a.start,c=b/this.a.width;189216E6<b&&a.push(qb);18144E6<b&&a.push(rb);1728E6<b&&8928E4>c&&a.push(sb);3024E4>c&&a.push(tb);432E4>c&&a.push(ub);b=20;for(c=0;c<a.length-2;c++)R(this,b,20,a[c],this.w.bind(this)),b+=20;1<a.length?(R(this,b,"100%",a[a.length-2],this.w.bind(this)),R(this,b,"100%",a[a.length-2],this.C.bind(this)),b+=20,R(this,b,20,a[a.length-1],this.M.bind(this))):(R(this,b,"100%",a[0],this.w.bind(this)),R(this,b,"100%",a[0],this.C.bind(this)));
this.O=this.l=b+20;this.l+=10+this.b.height;D("rect",{x:0,y:0,width:J(this.a),height:"100%","class":"whiteBackground"},this.g);D("rect",{x:0,y:0,width:J(this.a),height:"100%","class":"whiteBackground"},this.D)};E.prototype.C=function(a,b,c,d,e,f){D("rect",{"class":f,height:"100%",y:"0",x:a,width:b-a},this.D)};E.prototype.w=function(a,b,c,d,e,f){D("rect",{"class":f,height:d,y:c,x:a,width:b-a},this.g);D("text",{"class":"majorRowText",y:c+15,x:(a+b)/2,"text-anchor":"middle"},this.g).textContent=e};
E.prototype.M=function(a,b,c,d,e){D("line",{"class":"dateHeaderSeparator",x1:a,y1:c+3,x2:a,y2:c+d-3},this.g);D("text",{"class":"minorRowText",y:c+15,x:(a+b)/2,"text-anchor":"middle"},this.g).textContent=e};var ub=0,tb=1,sb=2,rb=3,qb=4;
function R(a,b,c,d,e){switch(d){case ub:var f=Za,l=db,m=ib;break;case tb:f=bb;l=eb;m=jb;break;case sb:f=ab;l=fb;m=kb;break;case rb:f=$a;l=gb;m=lb;break;case qb:f=cb,l=hb,m=mb}d=f(new Date(a.a.start));for(f=0;d.valueOf()<=a.a.l;){var n=m(d),p=K(a.a,d),P=K(a.a,l(d));e(p,P,b,c,n,0===f%2?"even":"odd");f++}}E.prototype.J=function(){this.i.setAttribute("transform","translate(0 "+this.b.height+")");this.g.setAttribute("transform","translate(0 "+this.b.height+")");this.l=this.O+10+this.b.height;F(this.a)};
var nb=250;function y(a,b,c){this.c=D("g",{"class":"milestone"});this.b=c;this.index=b;this.g=[];this.restore(a)}y.prototype.restore=function(a){var b=this;u(function(){return Number.isInteger(a.project)});u(function(){return b.b.j[a.project]||0>a.project});this.name=a.name;this.a&&this.a.W(this);0<=a.project?this.a=this.b.j[a.project]:this.a=this.b.D;this.a.ca(this)};
function Ya(a){var b=L(a),c=b?C(b.s):null;return[-1===a.a.index?a.a.name:a.a.a.name,a.a.name,a.name,c,vb(b),b.A].map(function(a){return JSON.stringify(a)}).join(",")}
y.prototype.h=function(){this.c.innerHTML="";var a=L(this),b=this.i&&this.i.B===this.b.g?this.i:this.i=wb(this,this.b.g);if(a&&b&&this.b.a!==this.b.g){var c=b.x,d=a.x;var e=xb(-45,45,.1*(c-d));var f=4*e;D("path",{"class":"thick evenDashed brightPink noFill",d:"M"+c+" 0 C"+(c-f)+" "+(0+e)+" "+(d+f)+" "+(0+e)+" "+d+" 0"},this.c)}b&&this.c.appendChild(b.c);a&&this.c.appendChild(a.c)};function yb(a,b){u(function(){return b instanceof A});a.g.push(b)}
function zb(a,b){b.B===a.b.a&&(a.l=null);b.B===a.b.g&&(a.i=null);a.g=a.g.filter(function(a){return a!==b})}function Ab(a){a.a.W(a);a.g.forEach(function(a){return Va(a)});S(a.b.u,a)}function wb(a,b){return a.g.find(function(a){return a.B===b})}function L(a){return a.l&&a.l.B===a.b.a?a.l:a.l=wb(a,a.b.a)};function x(a,b,c){this.c=D("g",{"class":"project"},c.v[a.programme].c);this.b=c;this.height=0;this.u=[];this.index=b;this.l=this.w=this.K=0;this.restore(a)}g=x.prototype;g.restore=function(a){var b=this;u(function(){return"string"===typeof a.name});u(function(){return!a.comment||"string"===typeof a.comment});u(function(){return Number.isInteger(a.programme)});u(function(){return b.b.v[a.programme]});this.name=a.name;this.A=a.comment||"";this.a&&Bb(this.a,this);this.a=this.b.v[a.programme];this.a.j.push(this)};
function ya(a){u(function(){return a.b.v[a.a.index]===a.a});return{name:a.name,programme:a.a.index,comment:a.A}}
g.h=function(){var a=this;this.c.innerHTML="";this.i=D("g",{},this.c);D("line",{x1:0,y1:0,x2:this.b.width,y2:0,"class":"projectLine"},this.i);var b=this.ga();this.u.forEach(function(b){return a.i.appendChild(b.c)});this.i.appendChild(b);b=D("g",{transform:"translate(20 0)"},this.i);this.g=new ob(J(this.b)-20,b);new M(this.name,{o:this.b.o,I:"Untitled",onchange:this.Ia.bind(this)},{"class":"projectHeader"},this.g.a);new M(this.A,{o:this.b.o,I:"...",onchange:this.Ha.bind(this)},{"class":"headingComment"},
this.g.a);this.g.b();this.g.c.addEventListener("verticalResize",this.Fa.bind(this));Cb(this);this.i.setAttribute("transform","translate(0 "+(this.height-20)+")");this.C=Db(O,this.b.o,[{icon:"icons/move-down.svg",action:this.Ja.bind(this)},{icon:"icons/move-up.svg",action:this.Ka.bind(this)},{icon:"icons/delete.svg",action:this.Ga.bind(this)},{icon:"icons/plus.svg",action:this.ha.bind(this)}],{transform:"translate(0 "+(-20-this.g.height)+")"},b);return this.c};
g.ga=function(){var a=[],b=[],c=this.u.map(function(a){return L(a)}).filter(function(a){return a&&G(a)});c.sort(function(a,b){return b.x-a.x});c.forEach(function(c){var d=c.x,e=Eb("small sans-serif",c.m.name+"MMM 00: ")+15;e=d+e;var m=Eb("small italic sans-serif",c.A);m=0===m?0:m+15;for(var n=d+m,p=0;p<a.length&&(a[p]&&!(n<=a[p])||a[p+1]&&!(e<=a[p+1]));p++);a[p+1]=d;0!==m&&(a[p]=d);b[p]||(b[p]=D("g",{transform:"translate(0, "+-p*Fb/2+")"}));b[p].appendChild(c.Z);c.P.innerHTML="";d=20-Fb/2*p-40-20;
D("line",{x1:"0",y1:d,x2:"0",y2:0},c.P);D("circle",{cx:"0",cy:d,r:"2"},c.P)});this.l=b.length*Fb/2;c=D("g",{transform:"translate(0 -20)"});for(var d=b.length-1;0<=d;d--)b[d]&&c.appendChild(b[d]);this.l+=40;return c};g.Fa=function(){var a=this.height;Cb(this);this.C&&this.C.setAttribute("transform","translate(0 "+(-20-this.g.height)+")");a!==this.height&&(this.i.setAttribute("transform","translate(0 "+(this.height-20)+")"),this.L())};function Cb(a){var b=a.g.height+15,c=a.l;a.height=b>c?b:c}
g.L=function(){var a=this.a;a.height=H(45,a.j);F(this.b)};g.ca=function(a){this.u.push(a)};g.W=function(a){this.u=this.u.filter(function(b){return b!==a})};g.Ia=function(a,b){this.name=b.text};g.Ha=function(a,b){this.A=b.text};function Gb(a){Bb(a.a,a);a.u.forEach(function(a){return Ab(a)});S(a.b.j,a)}
function Hb(a){u(function(){return 0===a.a.j.indexOf(a)});u(function(){return T(a.a.j)});var b=a.a.index;0>=b||(a.a.j.shift(),S(a.b.j,a),b--,a.a=a.b.v[b],u(function(){return T(a.a.j)}),b=a.a.j[a.a.j.length-1],a.a.j.push(a),b?Ib(a.b.j,a,b.index+1):Jb(a.b.j,a),u(function(){return T(a.b.j)}))}
function Kb(a){u(function(){return a.a.j.indexOf(a)===a.a.j.length-1});u(function(){return T(a.a.j)});var b=a.a.index;b>=a.b.v.length-1||(a.a.j.pop(),S(a.b.j,a),b++,a.a=a.b.v[b],u(function(){return T(a.a.j)}),b=a.a.j[0],a.a.j.unshift(a),b?Ib(a.b.j,a,b.index):Jb(a.b.j,a),u(function(){return T(a.b.j)}))}g.Ga=function(){Gb(this);this.L()};
g.ha=function(){var a=Na(this.b,{name:"New Milestone",project:this.index});Ma(this.b,{milestone:a.index,report:this.b.a.index,comment:"",status:Lb,date:Ja()}).h();a.h();this.h();this.L()};g.Ka=function(){var a=this;u(function(){return 0<=a.a.j.indexOf(a)});var b=this.a.j.indexOf(this);0===b?(b=this.a,Hb(this),b.h(),this.a.h(),F(this.b)):(b=this.a.j[b-1],Mb(this.b.j,b.index,this.index),Nb(this.a.j,this,b),this.L())};
g.Ja=function(){var a=this;u(function(){return 0<=a.a.j.indexOf(a)});var b=this.a.j.indexOf(this);b===this.a.j.length-1?(b=this.a,Kb(this),b.h(),this.a.h(),F(this.b)):(b=this.a.j[b+1],Mb(this.b.j,b.index,this.index),Nb(this.a.j,this,b),this.L())};function wa(a,b,c){this.c=D("g",{"class":"programme"});this.a=c;this.index=b;this.height=45;this.j=[];this.K=0;this.restore(a)}g=wa.prototype;g.restore=function(a){u(function(){return"string"===typeof a.name});u(function(){return!a.comment||"string"===typeof a.comment});this.name=a.name;this.A=a.comment||""};
g.h=function(){var a=this;this.c.innerHTML="";var b=D("g",{transform:"translate(0 40)"},this.c);Ob(this,b);Db(Q,this.a.o,[{icon:"icons/move-down.svg",action:this.Da.bind(this)},{icon:"icons/move-up.svg",action:this.Ea.bind(this)},{icon:"icons/delete.svg",action:this.Aa.bind(this)},{icon:"icons/plus.svg",action:this.ab.bind(this)}],{transform:"translate("+this.a.width+" -30)"},b);this.j.forEach(function(b){return a.c.appendChild(b.c)});this.height=H(45,this.j);return this.c};
function Ob(a,b){a.b=new ob(a.a.width-250,b);new M(a.name,{o:a.a.o,I:"Untitled",onchange:a.Ca.bind(a)},{"class":"programmeHeader"},a.b.a);new M(a.A,{o:a.a.o,I:"...",onchange:a.Ba.bind(a)},{"class":"headingComment"},a.b.a);a.b.b()}
function Ea(a,b,c,d,e){var f=c,l=D("g",{"class":"programme"}),m=D("g",{transform:"translate(0 40)"},l);Ob(a,m);m=45;for(var n=[];c<a.j.length&&m<b;c++){var p=a.j[c];p.w=e;p.c.setAttribute("transform","translate(0, "+m+")");p.K=m+a.K;n.push(p);m+=p.height}if(m<b)return n.forEach(function(a){return l.appendChild(a.c)}),{c:l,S:b-m,index:a.j.length};if(0===n.length&&d)throw Error("Not enough room on page for programme headers.");if(1===n.length&&d)throw Error("Project: '"+n[0].name+"' is larger than a single page, and cannot be printed");
if(1>=n.length)return{c:D("g",{}),S:0,index:f};n.pop();n.forEach(function(a){return l.appendChild(a.c)});return{c:l,S:0,index:c-1}}function Bb(a,b){a.j=a.j.filter(function(a){return a!==b})}g.Ca=function(a,b){this.name=b.text};g.Ba=function(a,b){this.A=b.text};function Pb(a){a.j.forEach(function(a){return Gb(a)});S(a.a.v,a)}g.ab=function(){Oa(this.a,{name:"New Project",programme:this.index}).h();this.h();F(this.a)};
g.Ea=function(){var a=this;u(function(){return 0<=a.a.v.indexOf(a)});var b=this.a.v.indexOf(this);0!==b&&(Mb(this.a.v,this.a.v[b-1].index,this.index),F(this.a))};g.Da=function(){var a=this;u(function(){return 0<=a.a.v.indexOf(a)});var b=this.a.v.indexOf(this);b!==this.a.v.length-1&&(Mb(this.a.v,this.a.v[b+1].index,this.index),F(this.a))};g.Aa=function(){Pb(this);this.a.h()};function A(a,b,c){this.c=D("g",{"class":"msAtReport"});this.i=D("g",{"class":"businessMsLine"});this.$=D("g",{"class":"businessMsLine"});this.Z=D("g",{"class":"milestoneInfo"});this.P=D("g",{"class":"milestonePointer"});this.b=[];this.g=[];this.index=b;this.a=c;this.restore(a)}var Lb=1;g=A.prototype;
g.restore=function(a){var b=this;u(function(){return Number.isInteger(a.milestone)});u(function(){return b.a.u[a.milestone]});u(function(){return Number.isInteger(a.report)});u(function(){return b.a.b[a.report]});u(function(){return"string"===typeof a.comment});u(function(){return Number.isInteger(a.date)});u(function(){return Number.isInteger(a.status)});u(function(){return 0<=a.status&&4>=a.status});this.m&&zb(this.m,this);this.m=this.a.u[a.milestone];yb(this.m,this);this.B=this.a.b[a.report];this.A=
a.comment;this.status=a.status;this.s=Ka(a.date)};function za(a){u(function(){return a.a.b[a.B.index]===a.B});u(function(){return a.a.u[a.m.index]===a.m});return{milestone:a.m.index,report:a.B.index,comment:a.A,status:a.status,date:a.s}}
g.h=function(){this.c.innerHTML="";this.P.innerHTML="";this.x=K(this.a,this.s);this.c.setAttribute("transform","translate("+this.x+" 0)");if(G(this)){this.Z.innerHTML="";if(U(this)){var a=D("g",{transform:"translate("+this.x+" 0)"},this.Z);new Qb({o:this.a.o,aa:this.Wa.bind(this),parent:a,H:{"class":"milestoneData"}},this.m.name,this.s,this.A);Db(O,this.a.o,[{icon:"icons/health.svg",action:this.Oa.bind(this)},{icon:"icons/delete.svg",action:this.za.bind(this)},{icon:"icons/arrow-right.svg",action:this.Na.bind(this)}],
{transform:"translate(0, -75)"},a)}this.c.appendChild(this.P);U(this)&&-1===this.m.a.index&&G(this)&&this.c.appendChild(this.i);a=D("g",{},this.c);this.l=D("path",{"class":vb(this),d:"M -7 0L 0 7L 7 0L 0 -7 Z"},a);this.l.addEventListener("click",this.Ra.bind(this))}};g.G=function(){this.i.innerHTML="";this.$.innerHTML="";D("line",{x1:0,y1:0,x2:0,y2:"100%"},this.i);D("line",{x1:this.x,y1:0,x2:this.x,y2:"100%"},this.$);return this.i};
function vb(a){if(U(a))switch(a.status){case 0:return"complete";case Lb:return"on-track";case 2:return"at-risk";case 3:return"late"}else if(a.B===a.a.g)return"previous";u(function(){return!1})}function Ta(a){switch(a){case "complete":return 0;case "on-track":return Lb;case "at-risk":return 2;case "late":return 3;case "previous":return 4}u(function(){return!1})}function G(a){return(U(a)||a.B===a.a.g)&&La(a.a,a.s)}function U(a){return a.a.a===a.B}
function Rb(a){var b=a.m.a;return{x:a.x,y:b.a.K+b.K+b.height-20}}function Fa(a){var b=a.m.a;return{x:a.x,y:b.K+b.height-20}}function Sb(a){a=a.m.a;a.h();a.L()}g.R=function(a){u(function(){return a instanceof B});this.b.push(a)};function Tb(a,b){a.b=a.b.filter(function(a){return a!==b})}function Ub(a,b){u(function(){return b instanceof B});a.g.push(b)}function Vb(a,b){a.g=a.g.filter(function(a){return a!==b})}
g.Ra=function(){1===this.a.U?-1!==this.m.a.index&&U(this)&&this.a.R({report:this.a.a.index,dependency:this.a.ba,dependent:this.m.index}).h():this.B!==this.a.g||L(this.m)||(Ma(this.a,{milestone:this.m.index,report:this.a.a.index,comment:this.A,status:this.status,date:this.s}).h(),this.m.h(),Sb(this))};function Va(a){zb(a.m,a);a.b.forEach(function(a){return a.i()});a.g.forEach(function(a){return a.i()});S(a.a.i,a)}
g.Wa=function(a){var b=this.a;this.s=xb(b.start,b.l,a.s);this.A=a.A;this.m.name=a.title;this.h();this.G();this.m.h();Sb(this)};g.Oa=function(){this.status=3<=this.status?0:this.status+1;this.l.setAttribute("class",vb(this))};g.za=function(){Va(this);0===this.m.g.length?Ab(this.m):this.m.h();Sb(this)};g.Na=function(){-1!==this.m.a.index&&(this.a.U=1,this.a.ba=this.m.index,this.a.V=!0)};function z(a,b,c){this.b=D("g",{"class":"reportLine"});this.i=D("g",{"class":"reportLine"});this.index=b;this.a=c;this.restore(a)}z.prototype.restore=function(a){this.s=a.date;this.name=a.name};
function pb(a,b,c){a.g=D("g",b,c);b=a===a.a.a?"Current:":"Baseline:";D("text",{"class":"reportHeader","text-anchor":"end"},a.g).textContent=b;b=D("g",{},a.g);new N({o:a.a.o,onchange:a.l.bind(a),parent:b,Y:Q,H:{transform:"translate(0, 20)","class":"reportDate"}},a.s);b=D("g",{},a.g);new Wb(a.name,a.a.o,a.w.bind(a),b)}
z.prototype.G=function(){this.b.innerHTML="";this.i.innerHTML="";if(!La(this.a,this.s))return this.b;var a=K(this.a,this.s);D("line",{x1:a,y1:this.a.O.b.height+20,x2:a,y2:"100%"},this.b);D("line",{x1:a,y1:0,x2:a,y2:"100%"},this.i);return this.b};function Xb(a){a.a.i.filter(function(b){return b.B===a}).forEach(function(a){return Va(a)});S(a.a.b,a);a.a.a=a.a.g}z.prototype.l=function(a,b){this.s=b.s;Ba(this.a);this.G()};z.prototype.w=function(a,b){this.name=b.text;Ba(this.a)};function B(a,b,c){this.c=D("g",{"class":"dependency"});this.c.addEventListener("dblclick",this.i.bind(this));this.index=b;this.g=c;this.restore(a)}
B.prototype.restore=function(a){var b=this;u(function(){return Number.isInteger(a.report)});u(function(){return b.g.b[a.report]});u(function(){return Number.isInteger(a.dependent)});u(function(){return b.g.u[a.dependent]});u(function(){return Number.isInteger(a.dependency)});u(function(){return b.g.u[a.dependency]});this.B=this.g.b[a.report];this.b&&Tb(this.b,this);this.b=wb(this.g.u[a.dependent],this.B);u(function(){return b.b});this.b.R(this);this.a&&Vb(this.a,this);this.a=wb(this.g.u[a.dependency],
this.B);u(function(){return b.a});Ub(this.a,this)};function Aa(a){u(function(){return a.g.i[a.a.index]===a.a});u(function(){return a.g.i[a.b.index]===a.b});u(function(){return a.g.u[a.a.m.index]===a.a.m});u(function(){return a.g.u[a.b.m.index]===a.b.m});return{dependent:a.b.m.index,dependency:a.a.m.index,report:a.B.index}}B.prototype.h=function(){this.c.innerHTML="";this.B===this.g.a&&G(this.b)&&G(this.a)&&this.G(Rb(this.a),Rb(this.b),this.c)};
B.prototype.G=function(a,b,c){if(this.a.s<=this.b.s)var d="dependencyLineOK",e="dependencyArrowOK";else d="dependencyLineLate",e="dependencyArrowLate";b.x-=7;Yb(a,b,d,c);Yb(a,b,"vthick transparentLine",c);D("path",{"class":e,d:"M -4 -4 L -4 4 L 0 0 Z",transform:"translate("+b.x+", "+b.y+")"},c)};var Zb=0;
function Ga(a,b,c,d){a.G(b,c,d);c=Yb(b,c,"transparentLine",d);Zb++;b="dependency"+Zb;c.setAttribute("id",b);c=D("text",{"class":"dependencyText"},d);D("textPath",{"xlink:href":"#"+b},c).textContent="\u00a0\u00a0\u00a0\u00a0"+a.b.m.name;d=D("text",{"text-anchor":"end","class":"dependencyText"},d);D("textPath",{"xlink:href":"#"+b,startOffset:"100%"},d).textContent=a.a.m.name+"\u00a0\u00a0\u00a0\u00a0"}B.prototype.i=function(){Vb(this.a,this);Tb(this.b,this);S(this.g.C,this);this.c.parentNode.removeChild(this.c)};function va(a){this.u=[];this.index=-1;this.name="Business Milestones";this.c=D("g",{"class":"businessMs"});this.g=D("g",{"class":"businessMs"});this.b=a;this.height=40;this.l=0}g=va.prototype;
g.h=function(){var a=this;this.c.innerHTML="";this.g.innerHTML="";var b=this.ja();this.height=this.l;var c=D("g",{transform:"translate(0 "+(this.height-20)+")"},this.c);D("line",{x1:0,y1:0,x2:this.b.width,y2:0,"class":"projectLine"},c);this.u.filter(function(a){return L(a)}).forEach(function(b){var d=L(b);u(function(){return d});d.G();c.appendChild(b.c);a.g.appendChild(d.$)});c.appendChild(b);b=D("g",{"class":"businessMsHeader",transform:"translate(0, -10)"},c);D("text",{},b).textContent="Business Milestones";
Db(O,this.b.o,[{icon:"icons/plus.svg",action:this.ka.bind(this)}],{transform:"translate(180, -7)"},b);return this.c};g.ja=x.prototype.ga;g.L=function(){F(this.b)};g.ca=function(a){this.u.push(a)};g.W=function(a){this.u=this.u.filter(function(b){return b!==a})};g.ka=x.prototype.ha;function Qb(a,b,c,d){this.o=a.o;this.aa=a.aa||function(){};this.parent=a.parent;this.H=a.H||{};this.a=!1;this.restore(b,c,d);this.h()}var Fb=35;g=Qb.prototype;g.restore=function(a,b,c){this.title=a;this.title=""===this.title?"Untitled":this.title;this.s=b;this.A=c;this.A=""===this.A?"":this.A};g.h=function(){this.c=$b(this.ya.bind(this),this.xa.bind(this),this.o,this.H,this.parent)};
g.xa=function(a){a.innerHTML="";a=D("foreignObject",{width:315,height:45,x:5,y:-55},a);var b=V("input",{"class":"svgDateBox",value:C(this.s),type:"date",required:""},a);b.addEventListener("change",this.wa.bind(this,b));b=V("input",{"class":"svgTextBox",value:this.title,type:"text",placeholder:"Milestone Name"},a);b.addEventListener("change",this.Za.bind(this,b));a=V("input",{"class":"svgCommentBox",value:this.A,type:"text",placeholder:"Milestone Comment"},a);a.addEventListener("change",this.va.bind(this,
a))};g.ya=function(a){this.a&&(this.aa(this),this.a=!1);a.innerHTML="";var b=new Date(this.s);b=kb(b)+" "+ib(b)+": ";D("text",{"text-anchor":"start",transform:"translate(5, -15)"},a).textContent=ac(b+this.title,100);D("text",{"class":"msComment",transform:"translate(5, 0)"},a).textContent=ac(this.A,100)};g.Za=function(a){this.restore(a.value,this.s,this.A);this.a=!0};g.va=function(a){this.restore(this.title,this.s,a.value);this.a=!0};g.wa=function(a){this.s=bc(a);this.a=!0};function k(){var a=document.getElementById("app");a.innerHTML="";this.c=V("div",{"class":"milestoneMapContainer"},a);this.parent=a;this.b=new cc;this.ia()}k.prototype.restore=function(a){this.map=new v(a)};
k.prototype.h=function(){var a=this;this.c.innerHTML="";this.a=V("div",{"class":"console"},this.c);var b=V("div",{"class":"menubar"},this.c),c=W("File",b);X([{icon:"icons/new.svg",action:this.ia.bind(this),F:function(){return a.a.textContent="New file"}},{icon:"icons/open.svg",action:this.qa.bind(this),F:function(){return a.a.textContent="Open file from Google Drive"}},{icon:"icons/save.svg",action:this.sa.bind(this),F:function(){return a.a.textContent="Save file"}},{icon:"icons/save-as.svg",action:this.ta.bind(this),
F:function(){return a.a.textContent="Save file as"}},{icon:"icons/exportCSV.svg",action:this.Sa.bind(this),F:function(){return a.a.textContent="Export snapshot as CSV"}},{icon:"icons/import.svg",action:this.Ta.bind(this),F:function(){return a.a.textContent="Import CSV snapshot"}}],c.body);c=W("Programme",b);X([{icon:"icons/plus.svg",action:this.map.$a.bind(this.map),F:function(){return a.a.textContent="New programme"}}],c.body);c=W("Comparison",b);X([{icon:"icons/camera.svg",action:this.bb.bind(this),
F:function(){return a.a.textContent="New snapshot"}},{icon:"icons/delete.svg",action:this.Qa.bind(this),F:function(){return a.a.textContent="Delete snapshot"}}],c.body);Ba(this.map);c.body.appendChild(this.map.ea);c=W("Print",b);X([{icon:"icons/print.svg",action:this.ra.bind(this),F:function(){return a.a.textContent="Print"}}],c.body);dc(this,c.body);b=W("About",b);X([{icon:"icons/info.svg",action:function(){return alert('Milestone Map, Version: 1.4.1\u03b2\n\nFor help and support, please visit:\n\nhttps://andymac-2.github.io/milestoneMap/instructions\n\nCopyright 2018 Andrew Pritchard\n\nLicensed under the Apache License, Version 2.0 (the "License");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an "AS IS" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n')},
F:function(){return a.a.textContent="About"}},{icon:"icons/question.svg",action:function(){return window.open("https://andymac-2.github.io/milestoneMap/instructions")},F:function(){return a.a.textContent="Help"}}],b.body);w("div",{"class":"menuBarPlaceholder"},this.c);this.c.appendChild(this.map.J);this.map.h()};
var ec=[{height:1682,width:2378},{height:1189,width:1682},{height:841,width:1189},{height:594,width:841},{height:420,width:594},{height:297,width:420},{height:210,width:297},{width:1682,height:2378},{width:1189,height:1682},{width:841,height:1189},{width:594,height:841},{width:420,height:594},{width:297,height:420},{width:210,height:297}].map(function(a){return a.width>a.height?{height:a.height-70,width:a.width-70}:a}),sa=ec[5],fc="4A0 Landscape;2A0 Landscape;A0 Landscape;A1 Landscape;A2 Landscape;A3 Landscape;A4 Landscape;4A0 Portrait;2A0 Portrait;A0 Portrait;A1 Portrait;A2 Portrait;A3 Portrait;A4 Portrait".split(";");
function dc(a,b){Ca("Page Size:",function(b){a.map.w=ec[b.currentTarget.value]},fc,{"class":"pageSizeSelector"},b)}g=k.prototype;g.bb=function(){Qa(this.map);this.h()};g.Qa=function(){1>=this.map.b.length||(Xb(this.map.a),this.h())};
g.ia=function(){gc(this.b);var a=Ja(),b=a-5184E6,c=new Date(b);c=c.setUTCFullYear(c.getUTCFullYear()+1).valueOf();this.map=new v({name:"New Map",start:b,end:c,programmes:[],projects:[],milestones:[],msAtReports:[],reports:[{name:"Baseline",date:a}],dependencies:[],currReport:0,cmpReport:0});this.h()};
g.sa=function(){function a(a){c.a.textContent="Error saving file";console.error(a)}function b(a){return c.a.textContent="Saved as: "+a}var c=this,d=JSON.stringify(xa(this.map),null,"\t");this.a.textContent="Saving...";hc(this.b)?ic(this.b,b,a,d):jc(this.b,b,a,this.map.name+".json",d)};
g.ta=function(){var a=this,b=JSON.stringify(xa(this.map),null,"\t");this.a.textContent="Saving...";jc(this.b,function(b){return a.a.textContent="Saved as: "+b},function(b){a.a.textContent="Error saving file";console.error(b)},this.map.name+".json",b)};g.qa=function(){var a=this;kc(this.b,function(b){try{a.restore(b),a.h()}catch(c){throw alert("Error: Invalid file."),c;}},function(b){a.a.textContent="Error opening file";console.error(b)})};
g.Ta=function(){var a=this;lc(this.c,function(b){try{var c=[],d=!1,e,f,l;for(l=f=e=0;e<b.length;e++){var m=b[e],n=b[e+1];c[l]=c[l]||[];c[l][f]=c[l][f]||"";'"'==m&&d&&'"'==n?(c[l][f]+=m,++e):'"'==m?d=!d:","!=m||d?"\r"!=m||"\n"!=n||d?"\n"!=m||d?"\r"!=m||d?c[l][f]+=m:(++l,f=0):(++l,f=0):(++l,f=0,++e):++f}0===c[c.length-1].length&&c.pop();Ua(a.map,c);a.h()}catch(p){throw alert(p.name+": "+p.message),p;}},".csv")};g.Sa=function(){var a=Xa(this.map);mc(this.map.name+".csv",a,"text/csv",this.c)};
g.ra=function(){var a=new v(xa(this.map),this.map.w);try{Da(a),this.parent.innerHTML=a.X.innerHTML,window.print(),this.parent.innerHTML="",this.parent.appendChild(this.c)}catch(b){throw alert(b.name+": "+b.message),b;}};var O=1,Q=2;function Yb(a,b,c,d){return D("path",{"class":c,d:"M"+a.x+" "+a.y+" C"+(a.x+150)+" "+a.y+" "+(b.x-150)+" "+b.y+" "+b.x+" "+b.y},d)};function H(a,b){b.forEach(function(b){b.c.setAttribute("transform","translate(0, "+a+")");b.K=a;a+=b.height});return a}function nc(a){a=a.getCTM();return{x:a.e,y:a.f}}var oc=void 0;function $b(a,b,c,d,e){d=D("g",d,e);return pc(d,a,b,c,e)}function pc(a,b,c,d,e){function f(){b(a);e.contains(a)&&e.addEventListener("click",l)}function l(){c(a);e.removeEventListener("click",l);e.contains(a)&&Ia(d,e,f)}f();return a}function Eb(a,b){qc.font=a;return qc.measureText(b).width}var qc=document.createElement("canvas").getContext("2d");function rc(a,b,c){c=D("g",{"class":"menu"},c);switch(a){case 0:var d=45*(b.length+1)/-2;break;case O:d=-22.5;break;case Q:d=-(45*(b.length+1))}for(a=0;a<b.length;a++){d+=45;var e=D("g",{transform:"translate("+d+", 0)","class":"menuEntry"},c);e.addEventListener("click",b[a].action);b[a].F&&e.addEventListener("mouseover",b[a].F);D("circle",{"class":"iconCircle",r:"14"},e);D("image",{x:"-8",y:"-8",height:"16",width:"16"},e).setAttributeNS("http://www.w3.org/1999/xlink","href",b[a].icon)}return c}
function Db(a,b,c,d,e){return $b(function(a){return a.innerHTML=""},function(b){b.innerHTML="";rc(a,c,b)},b,d,e)}function W(a,b){b=w("span",{"class":"menuBarSegment"},b);w("div",{"class":"menuBarHeader"},b).textContent=a;a=w("div",{"class":"menuBarContent"},b);return{c:b,body:a}}function X(a,b){b=w("span",{},b);b=D("svg",{width:45*a.length,height:40},b);rc(O,a,b).setAttribute("transform","translate (0, 20)")}
function Ca(a,b,c,d,e){d=w("span",d,e);w("div",{"class":"dropdownSegmentHeading"},d).textContent=a;a=w("select",{"class":"dropdownSegmentDropdown"},d);a.addEventListener("change",b);w("option",{selected:"",disabled:"",hidden:""},a).textContent="Please choose:";for(b=0;b<c.length;b++)w("option",{value:b},a).textContent=c[b]};function ob(a,b){this.width=a;this.height=0;this.c=D("g",{},b);this.g=D("foreignObject",{width:this.width},this.c);this.a=w("div",{style:"width:"+this.width+"px;max-width:"+this.width+"px;"},this.g);this.a.addEventListener("input",this.b.bind(this))}
ob.prototype.b=function(){var a=this.a;document.contains(a)?a=a.offsetHeight:(oc||(oc=w("div",{style:"position:absolute;visibility:hidden;"},document.body)),a=a.cloneNode(!0),oc.appendChild(a),a=a.offsetHeight,oc.innerHTML="");a+=8;this.height!==a&&(this.height=a,this.g.setAttribute("height",this.height),this.g.setAttribute("y",-this.height),a=new CustomEvent("verticalResize",{detail:this}),this.c.dispatchEvent(a))};
function M(a,b,c,d){var e=this;this.o=b.o;this.I=b.I;this.parent=d;this.onchange=b.onchange||function(){};c.contenteditable="true";this.c=w("p",c,d);this.c.addEventListener("input",this.la.bind(this,this.c));this.c.addEventListener("input",function(a){return e.onchange(a,e)});this.c.addEventListener("focus",this.cb.bind(this));this.restore(a);this.h()}g=M.prototype;g.restore=function(a){this.text=a?a:this.I};g.h=function(){pc(this.c,this.eb.bind(this),this.Ma.bind(this),this.o,this.parent)};
g.eb=function(){this.c.textContent=this.text||this.I;this.c.classList.remove("clickedActive");this.c.classList.add("notClickedActive")};g.Ma=function(){this.c.textContent=this.text;this.c.classList.add("clickedActive");this.c.classList.remove("notClickedActive")};g.cb=function(){var a=this.c,b=document.createRange();b.selectNodeContents(a);a=window.getSelection();a.removeAllRanges();a.addRange(b)};g.la=function(a){this.restore(a.textContent)};function w(a,b,c){a=document.createElement(a);if(b)for(var d in b)a.setAttribute(d,b[d]);c&&c.appendChild(a);return a}function sc(a,b,c,d){a=document.createElementNS(a,b);if(c)for(var e in c)a.setAttribute(e,c[e]);d&&d.appendChild(a);return a}var D=sc.bind(null,"http://www.w3.org/2000/svg"),V=sc.bind(null,"http://www.w3.org/1999/xhtml");function Wb(a,b,c,d){var e=O;this.I="Untitled";switch(e){case O:this.a="start";break;case 0:this.a="middle";break;default:u(function(){return!1})}this.o=b;this.onchange=c;this.parent=d;this.H={transform:"translate(5, 20)","class":"reportName"};this.restore(a);this.h()}g=Wb.prototype;g.restore=function(a){this.text=a;this.text=""===this.text?this.I:this.text};g.h=function(){this.c=$b(this.oa.bind(this),this.na.bind(this),this.o,this.H,this.parent)};
g.na=function(a){var b=this,c=a.getBoundingClientRect().height;a.innerHTML="";var d=10*c,e="middle"===this.a?d/-2:0,f=nc(a),l=-f.x;f=-f.y;a=D("foreignObject",{width:d,height:1.4*c,transform:"translate("+l+", "+f+")",x:e-l,y:0-c-f},a);a=w("input",{"class":"svgTextBox",type:"text",value:this.text},a);a.focus();a.select();a.addEventListener("change",this.ma.bind(this,a));a.addEventListener("change",function(a){return b.onchange(a,b)})};
g.oa=function(a){a.innerHTML="";D("text",{"text-anchor":this.a},a).textContent=ac(this.text,40)};g.ma=function(a){this.restore(a.value)};function N(a,b){switch(a.Y){case O:this.a="start";break;case Q:this.a="end";break;default:u(function(){return!1})}this.o=a.o;this.onchange=a.onchange||function(){};this.parent=a.parent;this.H=a.H||{};this.min=a.min||null;this.max=a.max||null;this.restore(b);this.h()}N.prototype.restore=function(a){this.s=a};N.prototype.h=function(){this.c=$b(this.g.bind(this),this.b.bind(this),this.o,this.H,this.parent)};
N.prototype.b=function(a){var b=this,c=a.getBoundingClientRect().height;a.innerHTML="";var d=10*c;a=D("foreignObject",{width:d,height:1.5*c,x:"start"===this.a?0:-d,y:0-c},a);c={"class":"svgDateBox",value:C(this.s),type:"date",required:""};this.min&&(c.min=C(this.min));this.max&&(c.max=C(this.max));var e=V("input",c,a);e.focus();e.select();e.addEventListener("blur",function(a){""!==e.value&&(b.s=bc(e));b.onchange(a,b)})};
N.prototype.g=function(a){a.innerHTML="";D("text",{"text-anchor":this.a},a).textContent=C(this.s)};function ra(a){this.c=a;this.a=[];this.b=[];a.addEventListener("click",this.click.bind(this),!0)}function Ia(a,b,c){a.a.push({c:b,event:c})}ra.prototype.click=function(a){for(var b=0;b<this.a.length;b++)for(;this.a[b]&&(!this.c.contains(this.a[b].c)||!this.a[b].c.parentNode.contains(a.target));)this.a[b].event(),this.a[b]=this.a[this.a.length-1],this.a.pop();for(b=0;b<this.b.length;b++)this.b[b].c.parentNode.contains(a.target)||this.b[b].event()};function xb(a,b,c){c=c>b?b:c;return c<a?a:c}function tc(a,b){for(var c=0;c<a.length-1;c++)if(0<=b(a[c],a[c+1]))return!1;return!0}function T(a){return tc(a,function(a,c){return a.index-c.index})}function Ib(a,b,c){u(function(){return c<=a.length});u(function(){return 0<=c});for(var d=a.length;d>c;d--)a[d]=a[d-1],a[d].index=d;a[c]=b;b.index=c}function Jb(a,b){b.index=a.length;a.push(b)}
function S(a,b){u(function(){return a[b.index]===b});for(var c=b.index;c<a.length-1;c++)a[c]=a[c+1],a[c].index=c;a.pop()}function Nb(a,b,c){u(function(){return 0<=a.indexOf(b)});u(function(){return 0<=a.indexOf(c)});var d=a.indexOf(b),e=a.indexOf(c),f=a[d];a[d]=a[e];a[e]=f}function Mb(a,b,c){u(function(){return a[b].index===b});u(function(){return a[c].index===c});var d=a[b];a[b]=a[c];a[c]=d;a[b].index=b;a[c].index=c}function C(a){return(new Date(a)).toISOString().slice(0,10)}
function bc(a){return(new Date(a.value+"T00:00:00.000Z")).valueOf()+1}function Ka(a){return a-a%864E5+1}function mc(a,b,c,d){var e=w("a",{style:"display:none;"},d);e.href="download"in e?URL.createObjectURL(new Blob([b],{type:c})):"data:application/octet-stream,"+encodeURIComponent(b);e.download=a;e.click();d.removeChild(e)}
function lc(a,b,c){var d={type:"file",style:"display:none;"};c&&(d.accept=c);var e=w("input",d,a),f=new FileReader;f.onload=function(){b(f.result);a.contains(e)&&a.removeChild(e)};e.addEventListener("change",function(){f.readAsText(e.files[0])});e.click()}function ac(a,b){return a.length>b-3?a.slice(0,b-3)+"...":a}function ta(a){var b=window,c=200;c=c||100;var d;b.addEventListener("resize",function(){d&&window.clearTimeout(d);d=setTimeout(a,c)})};function Y(a){for(var b=[],c=0;c<arguments.length;++c)b[c]=arguments[c];return b.reduceRight(function(a,b){return uc(b,a)})}function uc(a,b){return function(c,d){for(var e=[],f=1;f<arguments.length;++f)e[f-1]=arguments[f];a.apply(null,[function(a){for(var d=[],e=0;e<arguments.length;++e)d[e]=arguments[e];return b.apply(null,[c].concat(d instanceof Array?d:oa(na(d))))}].concat(e instanceof Array?e:oa(na(e))))}}function cc(){this.g=new vc;this.i=new wc;this.b=new xc;this.a=null}
function hc(a){return a.a&&a.a.l()}function gc(a){a.a&&(a.a.D(),a.a=null)}
function kc(a,b,c){gc(a);var d=V("div",{"class":"modal"},document.body),e=V("div",{"class":"fileDialog"},d);V("div",{},e).textContent="Open File:";V("hr",{},e);var f=V("button",{"class":"downloadDialogButton"},e);f.textContent="Open from Microsoft Onedrive";f.addEventListener("click",function(){a.a=a.i;document.body.removeChild(d);yc(a.a,b,c)});f=V("button",{"class":"downloadDialogButton"},e);f.textContent="Open from Google Drive";f.addEventListener("click",function(){a.a=a.g;document.body.removeChild(d);
zc(a.a,b,c)});f=V("button",{"class":"downloadDialogButton"},e);f.textContent="Upload File";f.addEventListener("click",function(){a.a=a.b;document.body.removeChild(d);Ac(b,c)});f=V("button",{"class":"downloadDialogButton"},e);f.textContent="Cancel";f.addEventListener("click",function(){document.body.removeChild(d);c()})}
function jc(a,b,c,d,e){var f=V("div",{"class":"modal"},document.body),l=V("dialog",{"class":"fileDialog"},f);V("div",{},l).textContent="Save File As:";V("hr",{},l);var m=V("input",{type:"text",value:d},l);V("hr",{},l);d=V("button",{"class":"downloadDialogButton"},l);d.textContent="Save to Microsoft Onedrive";d.addEventListener("click",function(){a.a=a.i;document.body.removeChild(f);Bc(a.a,b,c,m.value,e)});d=V("button",{"class":"downloadDialogButton"},l);d.textContent="Save to Google Drive";d.addEventListener("click",
function(){a.a=a.g;document.body.removeChild(f);Cc(a.a,b,c,m.value,e)});d=V("button",{"class":"downloadDialogButton"},l);d.textContent="Download File";d.addEventListener("click",function(){a.a=a.b;document.body.removeChild(f);var d=a.a;d.a=m.value;d.w(b,c,e)});d=V("button",{"class":"downloadDialogButton"},l);d.textContent="Cancel";d.addEventListener("click",function(){document.body.removeChild(f);c()})}function ic(a,b,c,d){u(function(){return null!==a.a});a.a.w(b,c,d)}
function vc(){var a=this;this.g=["https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"];this.a=!1;this.b=null;window.gapi.load("client:auth2:picker",function(){return Dc(a)})}vc.prototype.l=function(){return null!==this.b};vc.prototype.D=function(){this.b=null};function Cc(a,b,c,d,e){a.a?Z(a)?Ec(a,b,c,d,e):Y(function(b){return Fc(a,b,c)},function(b){return Ec(a,b,c,d,e)})(b):c()}
vc.prototype.w=function(a,b,c){var d=this;u(function(){return d.l()});this.a?Z(this)?Gc(this,a,b,c):Y(function(a){return Fc(d,a,b)},function(a){return Gc(d,a,b,c)})(a):b()};function zc(a,b,c){if(a.a){var d=Y(function(b){return Hc(a,b)},function(b,d){return Ic(a,b,c,d)});Z(a)?d(b):Y(function(b){return Fc(a,b,c)},function(a){return d(a)})(b)}}
function Dc(a){window.gapi.client.init({apiKey:"AIzaSyCYeIi5ThOCg1tPdy52ALudL_W-E_aipzo",clientId:"899992407737-pdogm033l5v7tb2j8n2g5n4hpo3r4ftd.apps.googleusercontent.com",discoveryDocs:a.g,scope:"https://www.googleapis.com/auth/drive.file"}).then(function(){a.a=!0})}function Z(a){return a.a&&window.gapi.auth2.getAuthInstance().isSignedIn.get()}function Jc(a){u(function(){return Z(a)});return window.gapi.auth2.getAuthInstance().currentUser.get().getAuthResponse().access_token}
function Hc(a,b){u(function(){return!0===a.a});u(function(){return Z(a)});var c=window.google.picker.ViewId.DOCS;(new window.google.picker.PickerBuilder).addView(c).setOAuthToken(Jc(a)).setDeveloperKey("AIzaSyCYeIi5ThOCg1tPdy52ALudL_W-E_aipzo").setCallback(b).build().setVisible(!0)}
function Fc(a,b,c){u(function(){return!0===a.a});b=b||function(){};window.gapi.auth2.getAuthInstance().signIn({scope:"https://www.googleapis.com/auth/drive.file"}).then(function(a){(a=a.getAuthResponse())&&!a.error?b():c()}).catch(function(){c()})}
function Ic(a,b,c,d){u(function(){return!0===a.a});u(function(){return Z(a)});var e=window.google.picker.Response.ACTION,f=window.google.picker.Response.DOCUMENTS,l=window.google.picker.Action.CANCEL,m=window.google.picker.Document.ID;d[e]==window.google.picker.Action.PICKED?window.gapi.client.drive.files.get({fileId:d[f][0][m],alt:"media"}).execute(function(a){b(a)}):d[e]==l&&c(d)}
function Ec(a,b,c,d,e){u(function(){return!0===a.a});u(function(){return Z(a)});d="\r\n---------1089738750193135781034\r\nContent-Type: application/json\r\n\r\n"+JSON.stringify({name:d+".json",mimeType:"application/json"})+"\r\n---------1089738750193135781034\r\nContent-Type: application/json\r\n\r\n"+e+"\r\n---------1089738750193135781034--";window.gapi.client.request({path:"/upload/drive/v3/files",method:"POST",params:{uploadType:"multipart"},headers:{"Content-Type":'multipart/related; boundary="-------1089738750193135781034"'},
body:d}).execute(function(a){void 0===a.name?c():b(a.name)})}function Gc(a,b,c,d){u(function(){return!0===a.a});u(function(){return null!==a.b});u(function(){return Z(a)});console.log(a.b);window.gapi.client.request({path:"/upload/drive/v3/files/"+a.b,method:"PATCH",params:{uploadType:"media"},body:d}).execute(function(a){void 0===a.name?c():b(a.name)})}function wc(){this.C=this.g=this.i=this.b=this.a=null}wc.prototype.l=function(){return null!==this.b};
wc.prototype.D=function(){this.i=this.b=this.a=null};
function yc(a,b,c){Y(function(a){window.OneDrive.open({clientId:"3f9462f2-10c5-4686-a3ba-8eb21ea94ab9",action:"download",multiSelect:!1,advanced:{queryParameters:"select=id,name,parentReference"},success:a,cancel:c,error:c})},function(b,e){a.g=e.accessToken;a.C=e.apiEndpoint;if(!e||!e.value||0>=e.value.length)return c(e);e=e.value[0];a.a=e.name;a.b=e.parentReference.id;a.i=e.parentReference.driveId;fetch(e["@microsoft.graph.downloadUrl"]).then(b,c)},function(a,b){b.json().then(a,c)})(b)}
function Bc(a,b,c,d,e){Y(function(a){window.OneDrive.save({clientId:"3f9462f2-10c5-4686-a3ba-8eb21ea94ab9",action:"query",advanced:{},success:a,cancel:c,error:c})},function(b,l){a.g=l.accessToken;a.C=l.apiEndpoint;if(!l||!l.value||0>=l.value.length)return c(l);var f=l.value[0];l=l.apiEndpoint+"drives/"+f.parentReference.driveId+"/items/"+f.id+":/"+encodeURI(d)+":/content";fetch(l,{method:"PUT",headers:{Authorization:"Bearer "+a.g,"Content-Type":"application/json"},body:e}).then(function(c){a.a=d;
a.b=f.id;a.i=f.parentReference.driveId;b(c)},c)},function(b,d){if(!1===d.ok)return c(d);b(a.a)})(b)}
wc.prototype.w=function(a,b,c){var d=this;u(function(){return null!==d.g});u(function(){return null!==d.a});u(function(){return null!==d.i});u(function(){return null!==d.b});u(function(){return null!==d.C});var e=this.C+"drives/"+this.i+"/items/"+this.b+":/"+encodeURI(this.a||"Untitled.json")+":/content";fetch(e,{method:"PUT",headers:{Authorization:"Bearer "+this.g,"Content-Type":"application/json"},body:c}).then(function(c){if(!1===c.ok)return b(c);a(d.a)},b)};function xc(){this.a=null}
xc.prototype.l=function(){return null!==this.a};xc.prototype.D=function(){this.a=null};function Ac(a,b){lc(document.body,function(c){try{a(JSON.parse(c))}catch(d){b(d)}},".json")}xc.prototype.w=function(a,b,c){var d=this;u(function(){return null!==d.a});mc(this.a,c,"application/json",document.body);a(this.a)};}).call(this);
